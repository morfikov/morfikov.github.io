<!DOCTYPE html>
<html class="no-js" lang="pl-PL">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Automatyczny restart połączenia LTE na routerze WiFi z OpenWRT | Morfitronik</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://morfikov.github.io/post/automatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt/">
  <meta property="og:site_name" content="Morfitronik">
  <meta property="og:title" content="Automatyczny restart połączenia LTE na routerze WiFi z OpenWRT">
  <meta property="og:description" content="Od już dłuższego czasu (będzie parę lat) korzystam z internetu LTE zamiast tradycyjnego połączenia przewodowego. Głównie ze względu na fakt, że w mojej okolicy nie ma praktycznie żadnych szanujących się ISP, z którymi warto by wejść w interakcję i podpisać z nimi jakąś sensową umowę. Poza tym, dla osób mojego pokroju, które cenią sobie mobilność, internet stacjonarny i tak jest mało praktyczny. Dlatego w moim domowym routerze mam wgrany firmware OpenWRT umożliwiający zainstalowanie na tym urządzeniu odpowiedniego oprogramowania obsługującego modemy LTE podłączane przez port USB. Połączenie sieciowe ze światem zwykle działa prawidłowo ale z jakiegoś powodu jest ono zrywane. Zwykle taka sytuacja ma miejsce w środku nocy (czasami parokrotnie), zwłaszcza gdy przekroczę limit danych i do końca okresu rozliczeniowego muszę przemęczyć się z lejkiem 1 mbit/s. Gdy ten lejek jest aplikowany, to zwykle odpalam sobie torrent&#39;a, tak by pobrać najnowsze obrazy ISO tej czy innej dystrybucji linux&#39;a. Niemniej jednak, jak mi net rozłączą, to nie załączy się on ponownie sam z siebie. Modem Huawei E3372s-153 w wersji NON-HiLink zdaje się pracować poprawnie, bo świeci się na nim dioda sugerująca, że połączenie z internetem jest nawiązane. Dlatego też postanowiłem w końcu ten problem rozwiązać raz na zawsze i mieć przy tym nieco spokojniejszy sen.">
  <meta property="og:locale" content="pl_PL">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2021-11-30T20:25:00+01:00">
    <meta property="article:modified_time" content="2023-01-11T13:30:00+01:00">
    <meta property="article:tag" content="Router">
    <meta property="article:tag" content="Modem">
    <meta property="article:tag" content="Lte">
    <meta property="article:tag" content="Huawei">
    <meta property="article:tag" content="E3372">
    <meta property="article:tag" content="Kernel">

		
  <meta itemprop="name" content="Automatyczny restart połączenia LTE na routerze WiFi z OpenWRT">
  <meta itemprop="description" content="Od już dłuższego czasu (będzie parę lat) korzystam z internetu LTE zamiast tradycyjnego połączenia przewodowego. Głównie ze względu na fakt, że w mojej okolicy nie ma praktycznie żadnych szanujących się ISP, z którymi warto by wejść w interakcję i podpisać z nimi jakąś sensową umowę. Poza tym, dla osób mojego pokroju, które cenią sobie mobilność, internet stacjonarny i tak jest mało praktyczny. Dlatego w moim domowym routerze mam wgrany firmware OpenWRT umożliwiający zainstalowanie na tym urządzeniu odpowiedniego oprogramowania obsługującego modemy LTE podłączane przez port USB. Połączenie sieciowe ze światem zwykle działa prawidłowo ale z jakiegoś powodu jest ono zrywane. Zwykle taka sytuacja ma miejsce w środku nocy (czasami parokrotnie), zwłaszcza gdy przekroczę limit danych i do końca okresu rozliczeniowego muszę przemęczyć się z lejkiem 1 mbit/s. Gdy ten lejek jest aplikowany, to zwykle odpalam sobie torrent&#39;a, tak by pobrać najnowsze obrazy ISO tej czy innej dystrybucji linux&#39;a. Niemniej jednak, jak mi net rozłączą, to nie załączy się on ponownie sam z siebie. Modem Huawei E3372s-153 w wersji NON-HiLink zdaje się pracować poprawnie, bo świeci się na nim dioda sugerująca, że połączenie z internetem jest nawiązane. Dlatego też postanowiłem w końcu ten problem rozwiązać raz na zawsze i mieć przy tym nieco spokojniejszy sen.">
  <meta itemprop="datePublished" content="2021-11-30T20:25:00+01:00">
  <meta itemprop="dateModified" content="2023-01-11T13:30:00+01:00">
  <meta itemprop="wordCount" content="2033">
  <meta itemprop="keywords" content="Router,Modem,Lte,Huawei,E3372,Kernel,Usb">
		
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Automatyczny restart połączenia LTE na routerze WiFi z OpenWRT">
  <meta name="twitter:description" content="Od już dłuższego czasu (będzie parę lat) korzystam z internetu LTE zamiast tradycyjnego połączenia przewodowego. Głównie ze względu na fakt, że w mojej okolicy nie ma praktycznie żadnych szanujących się ISP, z którymi warto by wejść w interakcję i podpisać z nimi jakąś sensową umowę. Poza tym, dla osób mojego pokroju, które cenią sobie mobilność, internet stacjonarny i tak jest mało praktyczny. Dlatego w moim domowym routerze mam wgrany firmware OpenWRT umożliwiający zainstalowanie na tym urządzeniu odpowiedniego oprogramowania obsługującego modemy LTE podłączane przez port USB. Połączenie sieciowe ze światem zwykle działa prawidłowo ale z jakiegoś powodu jest ono zrywane. Zwykle taka sytuacja ma miejsce w środku nocy (czasami parokrotnie), zwłaszcza gdy przekroczę limit danych i do końca okresu rozliczeniowego muszę przemęczyć się z lejkiem 1 mbit/s. Gdy ten lejek jest aplikowany, to zwykle odpalam sobie torrent&#39;a, tak by pobrać najnowsze obrazy ISO tej czy innej dystrybucji linux&#39;a. Niemniej jednak, jak mi net rozłączą, to nie załączy się on ponownie sam z siebie. Modem Huawei E3372s-153 w wersji NON-HiLink zdaje się pracować poprawnie, bo świeci się na nim dioda sugerująca, że połączenie z internetem jest nawiązane. Dlatego też postanowiłem w końcu ten problem rozwiązać raz na zawsze i mieć przy tym nieco spokojniejszy sen.">

	<link rel="stylesheet" href="https://morfikov.github.io/css/bundle.css">
	<link rel="stylesheet" href="https://morfikov.github.io/css/custom.css">
	<link rel="icon" href="https://morfikov.github.io/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="https://morfikov.github.io/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="https://morfikov.github.io/manifest.json">
  


</head>
<body class="body kind-page">
	<header class="header">
	<a class="logo" href="https://morfikov.github.io/">Morfitronik</a>
	
<nav class="main-nav main-nav--right" role="navigation">
	<button id="toggle" class="main-nav__btn" aria-label="Menu toggle" aria-expanded="false" tabindex="0">
		<div class="main-nav__btn-box" tabindex="-1">
			<svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18">
				<path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/>
				<path class="icon-menu__x" d="M11.55 9L18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55 0 9 6.45 15.45 0 18 2.55 11.55 9z"/>
			</svg>
		</div>
	</button>
	<ul id="menu" class="main-nav__list">
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/categories/">
					
					<span class="main-nav__text">Kategorie</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/tags/">
					
					<span class="main-nav__text">Tagi</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/info-kontakt/">
					
					<span class="main-nav__text">Info/Kontakt</span>
					
				</a>
			</li>
	</ul>
</nav>
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/">Home</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">Automatyczny restart połączenia LTE na routerze WiFi z OpenWRT</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2021-11-30T20:25:00&#43;01:00">Opublikowano: 30/11/2021</time>
	<time class="entry__meta-lastmod meta-lastmod" datetime="2023-01-11T13:30:00&#43;01:00">Zaktualizowano: 11/01/2023</time>

<div class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Kategorie:
		<a class="meta-categories__link" href="https://morfikov.github.io/categories/openwrt/" rel="category">OpenWRT</a>
	</span>
</div>
	</div>
				<h1 class="entry__title">Automatyczny restart połączenia LTE na routerze WiFi z OpenWRT</h1>
<details class="entry__toc toc" >
	<summary class="toc__title">Spis treści</summary>
	<nav id="TableOfContents">
  <ol>
    <li><a href="#problemy-z-modemem-lte-przy-restarcie-interfejsu-wan">Problemy z modemem LTE przy restarcie interfejsu WAN</a></li>
    <li><a href="#restart-modemu-lte-bez-wyciągania-go-z-portu-usb">Restart modemu LTE bez wyciągania go z portu USB</a>
      <ol>
        <li><a href="#skrypt-watchdoga-wersja-z-plikiem-authorized">Skrypt watchdog'a (wersja z plikiem authorized)</a></li>
        <li><a href="#skrypt-watchdoga-wersja-z-plikami-bindunbind">Skrypt watchdog'a (wersja z plikami bind/unbind)</a></li>
      </ol>
    </li>
    <li><a href="#praca-dla-cron">Praca dla cron</a></li>
    <li><a href="#test-internetowego-watchdoga">Test internetowego watchdog'a</a></li>
    <li><a href="#podsumowanie">Podsumowanie</a></li>
  </ol>
</nav>
</details>
				<div class="entry__content"><p>Od już dłuższego czasu (będzie parę lat) korzystam z internetu LTE zamiast tradycyjnego połączenia
przewodowego. Głównie ze względu na fakt, że w mojej okolicy nie ma praktycznie żadnych szanujących
się ISP, z którymi warto by wejść w interakcję i podpisać z nimi jakąś sensową umowę. Poza tym, dla
osób mojego pokroju, które cenią sobie mobilność, internet stacjonarny i tak jest mało praktyczny.
Dlatego w moim domowym routerze mam wgrany firmware OpenWRT umożliwiający zainstalowanie na tym
urządzeniu odpowiedniego oprogramowania obsługującego modemy LTE podłączane przez port USB.
Połączenie sieciowe ze światem zwykle działa prawidłowo ale z jakiegoś powodu jest ono zrywane.
Zwykle taka sytuacja ma miejsce w środku nocy (czasami parokrotnie), zwłaszcza gdy przekroczę limit
danych i do końca okresu rozliczeniowego muszę przemęczyć się z lejkiem 1 mbit/s. Gdy ten lejek
jest aplikowany, to zwykle odpalam sobie torrent'a, tak by pobrać najnowsze obrazy ISO tej czy
innej dystrybucji linux'a. Niemniej jednak, jak mi net rozłączą, to nie załączy się on ponownie sam
z siebie. Modem Huawei E3372s-153 w wersji NON-HiLink zdaje się pracować poprawnie, bo świeci się
na nim dioda sugerująca, że połączenie z internetem jest nawiązane. Dlatego też postanowiłem w
końcu ten problem rozwiązać raz na zawsze i mieć przy tym nieco spokojniejszy sen.</p>
<h2 id="problemy-z-modemem-lte-przy-restarcie-interfejsu-wan">Problemy z modemem LTE przy restarcie interfejsu WAN</h2>
<p><a href="https://eko.one.pl/?p=openwrt-3g#automatycznyrestartpoczenia">Na necie można spotkać wiele rozwiązań</a>, które umożliwiają monitorowanie połączenia sieciowego
pod kątem jego aktywności czy sprawności. Zwykle jednak te sposoby radzenia sobie z zanikiem
internetu dotyczą przewodowych połączeń, gdzie zresetowaniu podlega interfejs WAN w przypadku
wykrycia utraty odpowiedzi na zapytania <code>ping</code> . Nie byłoby w zasadzie żadnego problemu, gdyby to
rozwiązanie przedstawione w powyżej podlinkowanym artykule działało ale rzecz w tym, że nie działa.</p>
<p>Ja u siebie na OpenWRT mam skonfigurowany interfejs LTE obok interfejsu WAN i te dwa interfejsy
mogą działać niezależnie, w zależności od tego czy chcę wykorzystywać router do połączenia
przewodowego lub LTE. Generalnie to ten interfejs jest konfigurowany w poniższy sposób:</p>
<pre><code>uci set network.lte=interface
uci set network.lte.proto='ncm'
uci set network.lte.device='/dev/cdc-wdm0'
uci set network.lte.service='preferlte'
uci set network.lte.pdptype='IP'
uci set network.lte.apn='internet'
uci set network.lte.pincode='internet'
uci set network.lte.ipv6='auto'
uci set network.lte.peerdns='0'
uci add_list network.lte.dns='127.0.0.1'

uci del firewall.@zone[1].network
uci set firewall.@zone[1].network='wan wan6 lte'

uci commit
</code></pre>
<p>Niestety w przypadku mojego modemu Huawei E3372s-153 w wersji NON-HiLink przy próbie zresetowania
połączenia za sprawą polecenia <code>ifup lte</code> , w logu systemowym routera można zaobserwować poniższe
komunikaty:</p>
<pre><code>...
netifd: lte_4 (10284): udhcpc: received SIGTERM
netifd: lte_4 (10284): udhcpc: unicasting a release of 10.73.3.94 to 10.73.3.93
netifd: lte_4 (10284): udhcpc: sending release
netifd: lte_4 (10284): udhcpc: entering released state
netifd: lte (11278): Stopping network lte
netifd: lte_4 (10284): Command failed: Permission denied
netifd: Interface 'lte_4' is now down
netifd: Network alias '' link is down
netifd: Interface 'lte_4' has link connectivity loss
netifd: Interface 'lte_4' is disabled
</code></pre>
<p>Czyli interfejs został rozłączony poprawnie ale dalej w logu mamy coś takiego:</p>
<pre><code>netifd: lte (11278): sending -&gt; AT^NDISDUP=1,0
netifd: lte (11278): Command failed: Permission denied
netifd: Interface 'lte' is now down
netifd: Interface 'lte' is setting up now
netifd: lte (11340): Failed to get modem information
netifd: lte (11449): Stopping network lte
netifd: lte (11449): Failed to get modem information
netifd: Interface 'lte' is now down
netifd: Interface 'lte' is setting up now
netifd: lte (11508): Failed to get modem information
netifd: lte (11585): Stopping network lte
netifd: lte (11585): Failed to get modem information
...
</code></pre>
<p>I tak w nieskończoność, czego efektem jest brak możliwości skonfigurowania modemu LTE do pracy, co
oczywiście przekłada się na brak internetu.</p>
<p>Jedyną opcją by wybrnąć z tej sytuacji jest fizyczne odłączenie modemu LTE od portu USB routera i
podłączenie go ponownie. Można też naturalnie zrestartować router ale czas jego gotowości do pracy
zawsze będzie sporo dłuższy niż samo skonfigurowanie modemu LTE po podpięciu go do portu USB.</p>
<h2 id="restart-modemu-lte-bez-wyciągania-go-z-portu-usb">Restart modemu LTE bez wyciągania go z portu USB</h2>
<p>Pojawiło się zatem zapytanie na temat tego w jaki sposób rozłączyć modem LTE bez wyciągania go z
portu USB? Okazało się, że nie jest to jakoś specjalnie trudne i można do tego celu skorzystać z
<a href="https://www.kernel.org/doc/Documentation/usb/authorization.txt">mechanizmu autoryzacji urządzeń USB</a>, który jest wbudowany bezpośrednio w kernel linux'a. To
jest dokładnie ten sam mechanizm, który jest <a href="https://morfikov.github.io/post/jak-przy-pomocy-usbguard-zabezpieczyc-porty-usb-przed-zlosliwymi-urzadzeniami/">wykorzystywany np. przez usbguard</a>. Można także
wykorzystać do tego celu mechanizm manualnego przypisania sterowników do
urządzeń ( <code>bind</code>/<code>unbind</code> ). Postanowiłem zatem przerobić nieco skrypt watchdog'a, który był
podany na stronie <code>eko.one.pl</code> .</p>
<h3 id="skrypt-watchdoga-wersja-z-plikiem-authorized">Skrypt watchdog'a (wersja z plikiem authorized)</h3>
<p>Poniżej znajduje się wersja skryptu watchdog'a wykorzystująca mechanizm autoryzacji urządzeń USB:</p>
<pre><code>#!/bin/sh

if ! ping -q -c 1 -W 15 8.8.8.8 &gt; /dev/null
then
    logger &quot;*************************************************&quot;
    logger &quot;**** Brak internetu. Restartuje modem LTE... ****&quot;
    logger &quot;*************************************************&quot;

    echo 0 &gt; /sys/bus/usb/devices/usb3/authorized
    sleep 5
    echo 1 &gt; /sys/bus/usb/devices/usb3/authorized
fi
</code></pre>
<p>Gdy wykorzystujemy mechanizm autoryzacji urządzeń USB, to skrypt prześle wartość <code>0</code> do pliku
<code>authorized</code> hub'a <code>usb3</code> (bo to tutaj został wpięty modem LTE). Można by odszukać ścieżkę do
samego modemu LTE ale ta może ulec zmianie po rozłączeniu modemu, co skomplikowałoby nam nieco
życie. Z racji, że odłączymy cały hub, to wszystkie urządzenia podłączone do <code>usb3</code> zostaną
zresetowane.</p>
<p>Warto też zaznaczyć, że mój router ma 2 fizyczne porty USB ale hub'ów dostępnych w systemie jest 4,
z czego 2 wewnętrzne. Akurat w przypadku mojego routera jest tak, że każdy port USB jest wpięty do
innego hub'a ale <a href="https://morfikov.github.io/post/struktura-plikow-urzadzen-usb-w-katalogu-sys/">nie jest to regułą</a>. Jeśli mamy problem z ustaleniem, który hub jest od
którego portu USB, to trzeba metodą prób i błędów przesłać wartość <code>0</code> do każdego z nich i w końcu
ten prawidłowy ujawni się rozłączając modem LTE.</p>
<p>W skrypcie watchdog'a mamy jeszcze przesłanie wartości <code>1</code> do pliku <code>authorized</code> , co efektywnie
włączy modem mniej więcej w taki sposób gdybyśmy go fizycznie podłączyli do portu USB.</p>
<p>Przesłanie wartości <code>0</code> i <code>1</code> trzeba też nieco opóźnić, bo inaczej mogą pojawić się problemy z
ponownym włączeniem modemu LTE.</p>
<p>W poleceniu <code>ping</code> zostały użyte poniższe flagi:</p>
<ul>
<li><code>-q</code>      -- odpowiada za ciche wyjście, tj. nic poza podsumowaniem nie zostanie wydrukowane w
terminalu.</li>
<li><code>-c 1</code>    -- odpowiada za przesłanie do serwera tylko jednego pakietu.</li>
<li><code>-W 15</code>   -- odpowiada za czas oczekiwania na odpowiedź od serwera, który w tym przypadku został
ustawiony na 15 sekund.</li>
<li><code>8.8.8.8</code> -- to adres IP, na który mają zostać posłane zapytania. Można także skorzystać z
domeny, choć wiarygodniejsze jest podanie tutaj adresu IP.</li>
</ul>
<p>Zatem jeśli to powyższe polecenie <code>ping</code> nie otrzyma odpowiedzi od serwera w ciągu 15 sekund, to
zostaną zainicjowane instrukcje zawarte dalej w skrypcie watchdog'a.</p>
<h3 id="skrypt-watchdoga-wersja-z-plikami-bindunbind">Skrypt watchdog'a (wersja z plikami bind/unbind)</h3>
<p>Poniżej znajduje się wersja skryptu watchdog'a wykorzystująca mechanizm manualnego przypisywania
sterowników do urządzeń:</p>
<pre><code>#!/bin/sh

if ! ping -q -c 1 -W 15 8.8.8.8 &gt; /dev/null
then
    logger &quot;*************************************************&quot;
    logger &quot;**** Brak internetu. Restartuje modem LTE... ****&quot;
    logger &quot;*************************************************&quot;

    echo &quot;usb1&quot; &gt; /sys/bus/usb/drivers/usb/unbind
    sleep 1
    echo &quot;usb1&quot; &gt; /sys/bus/usb/drivers/usb/bind

fi
</code></pre>
<p>W tym przypadku, do plików <code>unbind</code> i <code>bind</code> zostaje przesłany numerek urządzenia USB, które
zostanie rozłączone i ponownie podłączone. Reszta skryptu się nie zmienia.</p>
<h2 id="praca-dla-cron">Praca dla cron</h2>
<p>By całość nam jeszcze zadziałała i modem się faktycznie zresetował, gdy połączenie z internetem
zaniknie, musimy stworzyć zadanie dla cron'a, które będzie cyklicznie wykonywane. Tworzymy zatem
plik <code>/etc/crontabs/root</code> (jeśli nie istnieje) i dodajemy do niego poniższą zawartość:</p>
<pre><code>*/2 * * * * /etc/skrypty/watchdog
</code></pre>
<p>Ta powyższa linijka ma za zadanie wykonywać skrypt watchdog'a co dwie minuty. W przypadku braku
internetu, modem LTE powinien zostać zresetowany, a połączenie z siecią odzyskane.</p>
<h2 id="test-internetowego-watchdoga">Test internetowego watchdog'a</h2>
<p>Gdy już wszystko mamy na swoim miejscu, symulujemy brak internetu, np. przez wysłanie zapytania
<code>ping</code> pod adres IP, który wiemy, że nie odpowie, np. jakiś lokalny (do ustawienia w skrypcie
watchdog'a). Odpalamy terminal i wpisujemy <code>logread -f</code> , po czym obserwujemy co tam system nam
wypisze.</p>
<p>Najpierw pojawia się poniższy komunikat:</p>
<pre><code>root: *************************************************
root: **** Brak internetu. Restartuje modem LTE... ****
root: *************************************************
</code></pre>
<p>Zatem wiemy, że skrypt został wykonany. Później mamy zaś takie oto wiadomości:</p>
<pre><code>kernel: [90294.008064] usb 3-1: USB disconnect, device number 12
kernel: [90294.008506] option1 ttyUSB0: GSM modem (1-port) converter now disconnected from ttyUSB0
kernel: [90294.012306] option 3-1:1.0: device disconnected
kernel: [90294.020559] option1 ttyUSB1: GSM modem (1-port) converter now disconnected from ttyUSB1
kernel: [90294.024582] option 3-1:1.1: device disconnected
kernel: [90294.033280] huawei_cdc_ncm 3-1:1.2 wwan0: unregister 'huawei_cdc_ncm' usb-xhci-hcd.1.auto-1, Huawei CDC NCM device
netifd: Network device 'wwan0' link is down
netifd: Network alias 'wwan0' link is down
netifd: Interface 'lte_4' has link connectivity loss
netifd: lte_4 (26465): udhcpc: SIOCGIFINDEX: No such device
netifd: lte_4 (26465): udhcpc: received SIGTERM
netifd: lte_4 (26465): udhcpc: unicasting a release of 10.70.8.81 to 10.70.8.82
netifd: lte_4 (26465): udhcpc: sending release
netifd: lte_4 (26465): udhcpc: can't bind to interface wwan0: No such device
netifd: lte_4 (26465): udhcpc: bindtodevice: No such device
netifd: lte_4 (26465): udhcpc: entering released state
netifd: lte_4 (26465): Command failed: Permission denied
netifd: Interface 'lte_4' is now down
netifd: Interface 'lte_4' is disabled
netifd: lte (27037): Control device not valid
netifd: Interface 'lte' is now down
</code></pre>
<p>Widać wyraźnie, że urządzenie USB zostało rozłączone i to mniej więcej w taki sam sposób, gdybyśmy
je fizycznie wyciągnęli z portu USB. Znika nam też z systemu interfejs LTE ( <code>wwan0</code> ) i nie będzie
go nawet na liście w wyjściu polecenia <code>ip</code> .</p>
<p>Po chwili pojawiają się w logu poniższe komunikaty:</p>
<pre><code>kernel: [90299.492540] hub 3-0:1.0: USB hub found
kernel: [90299.492644] hub 3-0:1.0: 1 port detected
kernel: [90299.495628] usb usb3: authorized to connect
kernel: [90299.675996] usb 3-1: new high-speed USB device number 13 using xhci-hcd
kernel: [90299.961386] option 3-1:1.0: GSM modem (1-port) converter detected
kernel: [90299.961563] usb 3-1: GSM modem (1-port) converter now attached to ttyUSB0
kernel: [90299.966896] option 3-1:1.1: GSM modem (1-port) converter detected
kernel: [90299.973418] usb 3-1: GSM modem (1-port) converter now attached to ttyUSB1
kernel: [90300.151756] huawei_cdc_ncm 3-1:1.2: MAC-Address: 00:1e:10:1f:00:00
kernel: [90300.151784] huawei_cdc_ncm 3-1:1.2: setting rx_max = 16384
kernel: [90300.162721] huawei_cdc_ncm 3-1:1.2: NDP will be placed at end of frame for this device.
kernel: [90300.162874] huawei_cdc_ncm 3-1:1.2: cdc-wdm0: USB WDM device
kernel: [90300.170843] huawei_cdc_ncm 3-1:1.2 wwan0: register 'huawei_cdc_ncm' at usb-xhci-hcd.1.auto-1, Huawei CDC NCM device, 00:1e:10:1f:00:00
kernel: [90300.176571] usb-storage 3-1:1.3: USB Mass Storage device detected
kernel: [90300.188928] scsi host0: usb-storage 3-1:1.3
kernel: [90301.222184] scsi 0:0:0:0: Direct-Access     HUAWEI   TF CARD Storage  2.31 PQ: 0 ANSI: 2
kernel: [90301.224138] sd 0:0:0:0: Power-on or device reset occurred
kernel: [90301.232048] sd 0:0:0:0: [sda] Attached SCSI removable disk
</code></pre>
<p>Zatem modem LTE został ponownie wykryty. Pojawił się także fizyczny interfejs sieciowy <code>wwan0</code> .</p>
<p>Po chwili modem zostaje przygotowany do pracy:</p>
<pre><code>netifd: Interface 'lte' is setting up now
netifd: lte (28012): sending -&gt; AT
netifd: lte (28012): sending -&gt; ATZ
netifd: lte (28012): sending -&gt; ATQ0
netifd: lte (28012): sending -&gt; ATV1
netifd: lte (28012): sending -&gt; ATE1
netifd: lte (28012): sending -&gt; ATS0=0
netifd: lte (28012): sending -&gt; AT+CGDCONT=1,&quot;IP&quot;,&quot;internet&quot;
netifd: lte (28012): SIM ready
netifd: lte (28012): PIN set successfully
netifd: lte (28012): Configuring modem
netifd: lte (28012): Starting network lte
netifd: lte (28012): Connecting modem
netifd: lte (28012): sending -&gt; AT^NDISDUP=1,1,&quot;internet&quot;
netifd: lte (28012): Setting up wwan0
netifd: Interface 'lte' is now up
</code></pre>
<p>Następnie interfejs LTE, pod który podlega fizyczny interfejs <code>wwan0</code> , zostaje skonfigurowany:</p>
<pre><code>netifd: Network device 'wwan0' link is up
netifd: Network alias 'wwan0' link is up
netifd: Interface 'lte_4' is enabled
netifd: Interface 'lte_4' has link connectivity
netifd: Interface 'lte_4' is setting up now
netifd: lte_4 (28300): udhcpc: started, v1.33.1
firewall: Reloading firewall due to ifup of lte (wwan0)
netifd: lte_4 (28300): udhcpc: sending discover
netifd: lte_4 (28300): udhcpc: sending select for 10.70.8.81
netifd: lte_4 (28300): udhcpc: lease of 10.70.8.81 obtained, lease time 518400
netifd: Interface 'lte_4' is now up
firewall: Reloading firewall due to ifup of lte_4 (wwan0)
</code></pre>
<p>I jak widzimy adresacja IP na interfejsie LTE ( <code>wwan0</code> ) zostaje uzyskana od serwera DHCP mojego
ISP, czego efektem jest przywrócenie połączenia sieciowego do pełnej sprawności.</p>
<h2 id="podsumowanie">Podsumowanie</h2>
<p>W taki oto dość prosty sposób, kawałek skryptu oraz odpowiednie wykorzystanie mechanizmu
autoryzacji podłączanych do portów USB urządzeń (ewentualnie też mechanizmu manualnego
przypisywania sterowników do urządzeń) umożliwiły nam zaimplementowanie watchdog'a na
routerze z wgranym firmware OpenWRT. Ilekroć tylko połączenie LTE nam zaniknie z jakiegoś powodu,
nasz watchdog zresetuje modem LTE i przywróci je do pełnej sprawności. Nie musimy już się obawiać,
że w środku nocy internet nam po cichu zdechnie, a obrazy ISO różnych dystrybucji linux'a nie
pobiorą się nam przez torrent'a. No i oczywiście też nasz komputer nie będzie pracował całą noc na
marne. Z moich obserwacji wynika też, że watchdog oparty o mechanizm przypisywania sterowników do
urządzeń działa nieco lepiej niż ten, w którym wykorzystywana jest autoryzacja urządzeń USB.</p></div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/router/">Router</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/modem/">Modem</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/lte/">Lte</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/huawei/">Huawei</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/e3372/">E3372</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/kernel/">Kernel</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/usb/">Usb</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Podziel się na Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmorfikov.github.io%2fpost%2fautomatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fautomatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt%2f&amp;text=Automatyczny%20restart%20po%c5%82%c4%85czenia%20LTE%20na%20routerze%20WiFi%20z%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Reddit" href="https://www.reddit.com/submit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fautomatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt%2f&amp;title=Automatyczny%20restart%20po%c5%82%c4%85czenia%20LTE%20na%20routerze%20WiFi%20z%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Reddit', 'width=832,height=624,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Reddit" role="img" width="32" height="32" viewBox="0 0 512 512"><path fill-rule="evenodd" d="M375 146a32 32 0 1 0-29-46l-65-13c-5-1-9 2-10 6l-22 97c-45 1-85 15-113 36a42 42 0 1 0-45 69l-1 12c0 65 74 117 166 117s166-52 166-117l-1-11a42 42 0 1 0-44-69c-28-21-67-35-111-37l19-86 58 13a32 32 0 0 0 32 29zM190 353c2-1 4 0 5 1 15 11 38 18 61 18s46-6 61-18a7 7 0 0 1 8 10c-18 14-44 21-69 21-25-1-51-7-69-21a6 6 0 0 1 3-11zm23-44a31 31 0 1 1-44-44 31 31 0 0 1 44 44zm130 0a31 31 0 1 0-44-44 31 31 0 0 0 44 44z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Telegram" href="https://t.me/share/url?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fautomatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt%2f&amp;title=Automatyczny%20restart%20po%c5%82%c4%85czenia%20LTE%20na%20routerze%20WiFi%20z%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Telegram', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmorfikov.github.io%2fpost%2fautomatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt%2f&title=Automatyczny%20restart%20po%c5%82%c4%85czenia%20LTE%20na%20routerze%20WiFi%20z%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na VK" href="https://vk.com/share.php?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fautomatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na VK', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="VK" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M274 363c5-1 14-3 14-15 0 0-1-30 13-34s32 29 51 42c14 9 25 8 25 8l51-1s26-2 14-23c-1-2-9-15-39-42-31-30-26-25 11-76 23-31 33-50 30-57-4-7-20-6-20-6h-57c-6 0-9 1-12 6 0 0-9 25-21 45-25 43-35 45-40 42-9-5-7-24-7-37 0-45 7-61-13-65-13-2-59-4-73 3-7 4-11 11-8 12 3 0 12 1 17 7 8 13 9 75-2 81-15 11-53-62-62-86-2-6-5-7-12-9H79c-6 0-15 1-11 13 27 56 83 193 184 192z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pocket" href="https://getpocket.com/edit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fautomatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt%2f&amp;title=Automatyczny%20restart%20po%c5%82%c4%85czenia%20LTE%20na%20routerze%20WiFi%20z%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=480,height=320,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pocket" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M388.8 88.9H123.2A47.4 47.4 0 0 0 76 136.5v131.9c0 2.4.2 4.8.5 7.2a101.8 101.8 0 0 0-.5 10.6c0 75.6 80.6 137 180 137s180-61.4 180-137c0-3.6-.2-7.1-.5-10.6.3-2.4.5-4.8.5-7.2v-132A47.4 47.4 0 0 0 388.8 89zm-22.4 132.6l-93 93c-4.7 4.6-11 7-17.1 7a23.8 23.8 0 0 1-17.7-7l-93-93a24 24 0 0 1 33.8-33.8l76.6 76.5 76.6-76.5a24 24 0 0 1 33.8 33.8z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pinterest" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fautomatyczny-restart-polaczenia-lte-na-routerze-wifi-z-openwrt%2f&description=Automatyczny%20restart%20po%c5%82%c4%85czenia%20LTE%20na%20routerze%20WiFi%20z%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=800,height=720,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pinterest" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="m265 65c-104 0-157 75-157 138 0 37 14 71 45 83 5 2 10 0 12-5l3-18c2-6 1-7-2-12-9-11-15-24-15-43 0-56 41-106 108-106 60 0 92 37 92 85 0 64-28 116-70 116-23 0-40-18-34-42 6-27 19-57 19-77 0-18-9-34-30-34-24 0-42 25-42 58 0 20 7 34 7 34l-29 120a249 249 0 0 0 2 86l3-1c2-3 31-37 40-72l16-61c7 15 29 28 53 28 71 0 119-64 119-151 0-66-56-126-140-126z"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="Mikhail Morfikov avatar" src="https://morfikov.github.io/img/avatar.png" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				Mikhail Morfikov
			</div>
			<div class="author__bio">Po ponad 10 latach spędzonych z różnej maści linux&#39;ami (Debian/Ubuntu, OpenWRT, Android) mogę śmiało powiedzieć, że nie ma rzeczy niemożliwych i problemów, których nie da się rozwiązać. Jedną umiejętność, którą ludzki umysł musi posiąść, by wybrnąć nawet z tej najbardziej nieprzyjemniej sytuacji, to zdolność logicznego rozumowania.</div>
		</div>
	</div>
</div>

	



<div class="related block">
	<h3 class="related__title">Powiązane</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/jak-wymusic-pasmo-czestotliwosc-lte-pod-lede-openwrt/">Jak wymusić pasmo/częstotliwość LTE pod OpenWRT</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/monitor-polaczenia-3glte-w-openwrt-3ginfo/">Monitor połączenia 3G/LTE W OpenWRT (3ginfo)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/konfiguracja-polaczenia-aero2-na-openwrt/">Konfiguracja połączenia Aero2 na OpenWRT</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/modem-lte-pod-openwrt/">Modem LTE pod OpenWRT (Huawei E3372s-153)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/jak-przy-pomocy-usbguard-zabezpieczyc-porty-usb-przed-zlosliwymi-urzadzeniami/">Jak przy pomocy USBguard zabezpieczyć porty USB przed złośliwymi urządzeniami</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/stale-nazwy-urzadzen-openwrt-hotplug-udev/">Stałe nazwy urządzeń w OpenWRT (hotplug, udev)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/obsluga-sms-kodow-ussd-w-openwrt/">Obsługa SMS i kodów USSD w OpenWRT</a></li>
		
	</ul>
</div>

	<div id="comments">
		<script src="https://utteranc.es/client.js"
        repo="morfikov/morfitronik-comments"
        issue-term="og:title"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>

	</div>

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:morfitronik@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://t.me/morfikov">
			<svg class="social__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/morfikov">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/morfikov">
			<svg class="social__icon" aria-label="Gitlab" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M450 282l-22-67-43-133c-2-7-12-7-14 0l-43.3 133H184.3L141 82c-2-7-12-7-14 0L84 215l-22 67c-2 6 0 13 6 16l188 137 188-137c6-3 8-10 6-16z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/users/3015317">
			<svg class="social__icon" aria-label="Stack Overflow" role="img" width="32" height="32" viewBox="0 0 512 512"><g stroke-width="30"><path fill="none" d="M125 297v105h241V297"/><path d="M170 341h150m-144-68l148 31M199 204l136 64m-95-129l115 97M293 89l90 120"/></g></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://mastodon.social/@morfik">
			<svg class="social__icon" aria-label="Mastodon" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M416 197c0-74-49-96-49-96-42-22-172-24-222 0 0 0-49 22-49 96v59c2 72 14 145 81 162 33 9 89 18 140-6l-2-27s-27 7-58 7c-74 2-67-39-70-52 0 0 51 17 137 6 42-6 80-32 85-56 8-38 7-93 7-93zm-58 96h-35v-88c0-18-8-27-23-27-18 0-27 11-27 33v47h-34v-47c0-22-9-33-27-33-15 0-23 9-23 27v88h-35v-91c0-18 5-60 52-60 39 0 50 37 50 37s10-37 50-37c45 0 52 42 52 60v91z"/></svg>
		</a>
</div>
	<div class="footer__copyright">© 2025 Mikhail Morfikov.
	<span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span>
	<span class="footer__copyright-cc">
		<div class="license-icons">
			<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" title="Creative Commons Attribution 4.0 International license">
<i class="icon-cc"></i><i class="icon-cc-by"></i><i class="icon-cc-nc"></i><i class="icon-cc-sa"></i>
</a>
		</div>
		Except where otherwise noted, content on this site is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International license</a>.
	</span>
	</div>
</footer>

<script src="https://morfikov.github.io/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="https://morfikov.github.io/js/custom.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 40,
  textColor: '#c3c3c3'
})</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
const images = Array.from(document.querySelectorAll(".entry__content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    scrollOffset: 40,  
    container: null,  
    template: null,  
    background: 'rgba(0, 0, 0, 0.8)'
  });
});
</script>
</body>
</html>
