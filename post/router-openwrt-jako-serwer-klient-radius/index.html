<!DOCTYPE html>
<html class="no-js" lang="pl-PL">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Router OpenWRT jako serwer i klient RADIUS | Morfitronik</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://morfikov.github.io/post/router-openwrt-jako-serwer-klient-radius/">
  <meta property="og:site_name" content="Morfitronik">
  <meta property="og:title" content="Router OpenWRT jako serwer i klient RADIUS">
  <meta property="og:description" content="Ten poniższy artykuł ma na celu pokazanie w jaki sposób stworzyć infrastrukturę WiFi w oparciu o oprogramowanie freeradius (serwer RADIUS), które zostanie zainstalowane na przykładowym routerze TP-Link Archer C7 v2. Router ma wgrany firmware OpenWRT Chaos Calmer w wersji 15.05.1 (r49294). Zostanie tutaj opisane dokładnie jak wdrożyć protokół WPA2 Enterprise z obsługą trzech metod uwierzytelniania: EAP-TLS, EAP-TTLS oraz PEAP (v0) .">
  <meta property="og:locale" content="pl_PL">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2016-06-15T07:17:07+00:00">
    <meta property="article:modified_time" content="2016-06-15T07:17:07+00:00">
    <meta property="article:tag" content="Wifi">
    <meta property="article:tag" content="Chaos-Calmer">
    <meta property="article:tag" content="Sieć">
    <meta property="article:tag" content="Router">
    <meta property="article:tag" content="Radius">

		
  <meta itemprop="name" content="Router OpenWRT jako serwer i klient RADIUS">
  <meta itemprop="description" content="Ten poniższy artykuł ma na celu pokazanie w jaki sposób stworzyć infrastrukturę WiFi w oparciu o oprogramowanie freeradius (serwer RADIUS), które zostanie zainstalowane na przykładowym routerze TP-Link Archer C7 v2. Router ma wgrany firmware OpenWRT Chaos Calmer w wersji 15.05.1 (r49294). Zostanie tutaj opisane dokładnie jak wdrożyć protokół WPA2 Enterprise z obsługą trzech metod uwierzytelniania: EAP-TLS, EAP-TTLS oraz PEAP (v0) .">
  <meta itemprop="datePublished" content="2016-06-15T07:17:07+00:00">
  <meta itemprop="dateModified" content="2016-06-15T07:17:07+00:00">
  <meta itemprop="wordCount" content="1659">
  <meta itemprop="keywords" content="Wifi,Chaos-Calmer,Sieć,Router,Radius">
		
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Router OpenWRT jako serwer i klient RADIUS">
  <meta name="twitter:description" content="Ten poniższy artykuł ma na celu pokazanie w jaki sposób stworzyć infrastrukturę WiFi w oparciu o oprogramowanie freeradius (serwer RADIUS), które zostanie zainstalowane na przykładowym routerze TP-Link Archer C7 v2. Router ma wgrany firmware OpenWRT Chaos Calmer w wersji 15.05.1 (r49294). Zostanie tutaj opisane dokładnie jak wdrożyć protokół WPA2 Enterprise z obsługą trzech metod uwierzytelniania: EAP-TLS, EAP-TTLS oraz PEAP (v0) .">

	<link rel="stylesheet" href="https://morfikov.github.io/css/bundle.css">
	<link rel="stylesheet" href="https://morfikov.github.io/css/custom.css">
	<link rel="icon" href="https://morfikov.github.io/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="https://morfikov.github.io/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="https://morfikov.github.io/manifest.json">
		
  


</head>
<body class="body kind-page">
	<header class="header">
	<a class="logo" href="https://morfikov.github.io/">Morfitronik</a>
	
<nav class="main-nav main-nav--right" role="navigation">
	<button id="toggle" class="main-nav__btn" aria-label="Menu toggle" aria-expanded="false" tabindex="0">
		<div class="main-nav__btn-box" tabindex="-1">
			<svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18">
				<path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/>
				<path class="icon-menu__x" d="M11.55 9L18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55 0 9 6.45 15.45 0 18 2.55 11.55 9z"/>
			</svg>
		</div>
	</button>
	<ul id="menu" class="main-nav__list">
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/categories/">
					
					<span class="main-nav__text">Kategorie</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/tags/">
					
					<span class="main-nav__text">Tagi</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/info-kontakt/">
					
					<span class="main-nav__text">Info/Kontakt</span>
					
				</a>
			</li>
	</ul>
</nav>
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/">Home</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">Router OpenWRT jako serwer i klient RADIUS</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2016-06-15T07:17:07Z">Opublikowano: 15/06/2016</time>

<div class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Kategorie:
		<a class="meta-categories__link" href="https://morfikov.github.io/categories/openwrt/" rel="category">OpenWRT</a>
	</span>
</div>
	</div>
				<h1 class="entry__title">Router OpenWRT jako serwer i klient RADIUS</h1>
<details class="entry__toc toc" >
	<summary class="toc__title">Spis treści</summary>
	<nav id="TableOfContents">
  <ol>
    <li><a href="#instalacja-pakietów-na-potrzeby-radiusa">Instalacja pakietów na potrzeby RADIUS'a</a></li>
    <li><a href="#certyfikaty">Certyfikaty</a></li>
    <li><a href="#konfiguracja-demona-radiusd">Konfiguracja demona radiusd</a></li>
    <li><a href="#konfiguracja-klienta-radiusa">Konfiguracja klienta RADIUS'a</a></li>
    <li><a href="#klienci-sieci-wifi">Klienci sieci WiFi</a></li>
    <li><a href="#konfiguracja-uwierzytelniania-eap-eap-tls-eap-ttls-peap">Konfiguracja uwierzytelniania EAP (EAP-TLS, EAP-TTLS, PEAP)</a></li>
    <li><a href="#test-serwera-radius">Test serwera RADIUS</a></li>
    <li><a href="#test-podłączania-klientów-do-sieci-wifi">Test podłączania klientów do sieci WiFi</a></li>
  </ol>
</nav>
</details>
				<div class="entry__content"><p>Ten poniższy artykuł ma na celu pokazanie w jaki sposób stworzyć infrastrukturę WiFi w oparciu o
oprogramowanie <code>freeradius</code> (serwer RADIUS), które zostanie zainstalowane na przykładowym routerze
<a href="http://www.tp-link.com.pl/products/details/Archer-C7.html">TP-Link Archer C7 v2</a>. Router ma wgrany
firmware OpenWRT Chaos Calmer w wersji 15.05.1 (r49294). Zostanie tutaj opisane dokładnie jak
wdrożyć protokół WPA2 Enterprise z obsługą trzech metod uwierzytelniania: EAP-TLS, EAP-TTLS oraz
PEAP (v0) .</p>
<h2 id="instalacja-pakietów-na-potrzeby-radiusa">Instalacja pakietów na potrzeby RADIUS'a</h2>
<p>Jakiś czas temu opisywałem wdrożenie <a href="https://morfikov.github.io/post/wpa2-enterprise-serwer-freeradius/">WPA2 Enterprise w oparciu o oprogramowanie
freeradius</a>, z tym, że na debianie.
Tamten mechanizm był podobny do tego, który zamierzam przedstawić w tym artykule. W podlinkowanym
wyżej wpisie był robiony użytek z dwóch maszyn. Jedna z nich robiła za serwer RADIUS'a, druga zaś
za klienta. W tym przypadku zarówno klientem jak i serwerem RADIUS'a będzie nasz router. Logujemy
się zatem na to urządzenie i przechodzimy do instalacji potrzebnych nam pakietów. Na te poniższe
rzeczy potrzebne jest około 1,5 MiB na flash'u routera. Trzeba jednak przy tym zaznaczyć, że nie są
to wszystkie moduły, które możemy zainstalować oraz, że z części z nich możemy zrezygnować.</p>
<pre><code># opkg update
# opkg install freeradius2 \
freeradius2-mod-eap \
freeradius2-mod-eap-mschapv2 \
freeradius2-mod-eap-peap \
freeradius2-mod-eap-tls \
freeradius2-mod-eap-ttls \
freeradius2-mod-files \
freeradius2-mod-mschap \
freeradius2-mod-radutmp \
freeradius2-mod-realm \
freeradius2-mod-exec \
freeradius2-mod-pap \
freeradius2-mod-chap \
freeradius2-mod-sql \
freeradius2-mod-logintime
</code></pre>
<p>Musimy także wymienić nieco oprogramowania. Mowa o domyślnie zainstalowanym pakiecie <code>wpad-mini</code> ,
który nie zawiera obsługi WPA2 Enterprise. Jeśli chcemy mieć obsługę tego protokołu, to musimy
doinstalować pakiet <code>wpad</code> uprzednio usuwając wspomniany wyżej pakiet <code>wpad-mini</code> (potrzeba około
0,5 MiB na flash):</p>
<pre><code># opkg remove wpad-mini
# opkg install wpad
</code></pre>
<h2 id="certyfikaty">Certyfikaty</h2>
<p>Serwer RADIUS, który zamierzamy skonfigurować, wymaga do prawidłowej pracy kilku certyfikatów. Te
certyfikaty musimy sobie stworzyć. Nie będę tutaj opisywał procesu generowania certyfikatów, a to z
tego względu, że zostało to zrobione w osobnych artykułach. Odradzam tworzenie samych certyfikatów
bezpośrednio na routerze, bo to jest proces bardzo zasobożerny i dużo lepiej do tego celu jest
wykorzystać jakąś standardową dystrybucję linux'a. Niemniej jednak, jeśli nie mamy jeszcze
wymaganych certyfikatów, to możemy je sobie stworzyć przy pomocy takich narzędzi jak, np.
<a href="https://morfikov.github.io/post/generowanie-certyfikatow-przy-pomocy-easy-rsa/">easy-rsa</a>. Oczywiście to
tylko jeden ze sposobów generowania certyfikatów. Jeśli nie chce nam się korzystać z narzędzi
specjalnie przeznaczonych do tego typu celów, to zawsze możemy takie <a href="https://morfikov.github.io/post/generowanie-certyfikatow/">certyfikaty wygenerować sobie
ręcznie</a>.</p>
<p>Zakładam, że mamy już potrzebne pliki. Musimy je wgrać na router. Potrzebny nam będzie klucz
serwera, certyfikat serwera oraz certyfikat CA. Dodatkowo, będziemy potrzebować plik <code>dh</code> (parametry
potrzebne do wymiany kluczy w protokole Diffie-Hellman'a). Tworzymy zatem na routerze katalog
<code>/etc/freeradius2/certs/</code> i wrzucamy do niego wszystkie wyżej wymienione pliki przy pomocy <code>scp</code>
:</p>
<pre><code># scp /etc/CA_RADIUS/keys/{radius.key,radius.crt,ca.crt,dh2048.pem} root@192.168.1.1:/etc/freeradius2/certs
</code></pre>
<h2 id="konfiguracja-demona-radiusd">Konfiguracja demona radiusd</h2>
<p>Na sam początek edytujemy plik <code>/etc/freeradius2/radiusd.conf</code> . Musimy w nim dostosować odpowiednie
parametry dotyczące interfejsu, adresu i portów na jakich serwer RADIUS będzie operował:</p>
<pre><code>...
listen {
    type = auth
    ipaddr = 127.0.0.1
    port = 0
    interface = lo
...
listen {
    type = acct
    ipaddr = 127.0.0.1
    port = 0
    interface = lo
...
</code></pre>
<p>Port <code>0</code> w tym wypadku oznacza port domyślny. Wartość tego portu jest odczytywana z pliku
<code>/etc/services</code> . Standardowo są to <code>1812</code> (auth) i <code>1813</code> (acct).</p>
<h2 id="konfiguracja-klienta-radiusa">Konfiguracja klienta RADIUS'a</h2>
<p>W tym przypadku router będzie robił zarówno za klient jak i za serwer RADIUS'a. Musimy zatem
odpowiednio zmienić plik <code>/etc/freeradius2/clients.conf</code> . To w tym pliku określamy hosty, które
mogą przesyłać zapytania do serwera RADIUS. Domyślna jego konfiguracja już wskazuje na adres
<code>127.0.0.1</code> . Jedyne co musimy zrobić, to określić parametr <code>secret</code> :</p>
<pre><code>...
client localhost {
    ipaddr = 127.0.0.1
    secret = 1846445a84caa742f082efed78e786d9f
    require_message_authenticator = yes
    nastype = other
}
...
</code></pre>
<p>Musimy także odpowiednio przepisać plik <code>/etc/config/wireless</code> , gdzie ustawiamy te poniższe opcje:</p>
<pre><code>config wifi-iface
    option device     'radio0'
    option network    'lan'
    option mode       'ap'
    option ssid       'Ever_Vigilant'
    option encryption 'wpa2+aes'
    option key        '1846445a84caa742f082efed78e786d9f'
    option server     '127.0.0.1'
    option port       '1812'
    option disabled   '0'
    option hidden     '0'
</code></pre>
<p>Jeśli ktoś jest ciekaw użyty wyżej opcji, to zapraszam do zapoznania się z artykułem, który został
poświęcony <a href="https://morfikov.github.io/post/siec-bezprzewodowa-wifi-w-openwrt-wlan/">konfiguracji sieci WiFi na routerze z
OpenWRT</a>. To na co musimy zwrócić
uwagę, to opcja <code>key</code> , której wartość wskazuje na sekret określony wyżej w pliku
<code>/etc/freeradius2/clients.conf</code> . Te dwie wartości muszą do siebie pasować. Uzupełniamy też opcje
<code>server</code> oraz <code>port</code> . Dodatkowo, jeśli korzystaliśmy wcześniej z sieci opartej o protokół WPA2-PSK,
to przydałoby się ją wyłączyć (za pomocą <code>disabled</code> ) zostawiając w powyższym pliku tylko jeden
aktywny blok z konfiguracją sieci WiFi.</p>
<h2 id="klienci-sieci-wifi">Klienci sieci WiFi</h2>
<p>Jeśli chodzi zaś o konta użytkowników, którzy będą mieli prawo łączyć się do naszej sieci WiFi, to
definiujemy ich w pliku <code>/etc/freeradius2/users</code> . Poniżej są zawarte przykładowe wpisy dla kont dla
konfiguracji EAP-TTLS i PEAP:</p>
<pre><code>&quot;anonymous&quot;       Auth-type := EAP

&quot;morfik&quot;          Cleartext-Password := &quot;e6a664c54f6427&quot;
                  Reply-Message = &quot;Witaj, %{User-Name}&quot;
</code></pre>
<p>Niżej zaś jest konfiguracja dla kont EAP-TLS:</p>
<pre><code>&quot;morfik_laptop&quot;   Auth-type := EAP
                  Reply-Message = &quot;Witaj, Morfiku!&quot;
</code></pre>
<p>Musimy także dopisać jedną dodatkową regułę, która będzie definiować domyślną akcję. To właśnie ta
akcja zostanie podjęta jeśli żądanie nie zostanie dopasowane do jednego z tych powyżej określonych
kont. Dodajemy zatem ten poniższy wpis:</p>
<pre><code>DEFAULT           Auth-type := Reject
                  Reply-Message := &quot;SPADAJ NA DRZEWO!&quot;
</code></pre>
<h2 id="konfiguracja-uwierzytelniania-eap-eap-tls-eap-ttls-peap">Konfiguracja uwierzytelniania EAP (EAP-TLS, EAP-TTLS, PEAP)</h2>
<p><a href="http://www.networkworld.com/article/2223672/access-control/which-eap-types-do-you-need-for-which-identity-projects.html">Jest wiele metod uwierzytelniania
EAP</a>
i nas interesować będą trzy z nich EAP-TLS, EAP-TTLS i PEAP. Metoda <code>EAP-TLS</code>, w odróżnieniu od
EAP-TTLS i PEAP, wymaga wzajemnej weryfikacji certyfikatów na linii serwer-klient. Z kolei
<code>EAP-TTLS</code> i <code>PEAP</code> zbytnio się nie różnią między sobą, no może za wyjątkiem wsparcia, bo ten drugi
jest rozwijany przez MS. Obie te metody wykorzystują szyfrowany tunel TLS, który jest również
podstawą dla uwierzytelniania przy metodzie EAP-TLS i by korzystać z EAP-TTLS lub PEAP, trzeba po
części skonfigurować uwierzytelnianie EAP-TLS. Same certyfikaty klienckie w przypadku EAP-TTLS i
PEAP są nieobowiązkowe i gdy nie korzystamy z nich, uwierzytelnianie klienta odbywa się przy pomocy
loginu i hasła, co znacznie upraszcza wdrożenie protokołu WPA2 Enterprise. Jeśli chodzi o samą
konfigurację klientów, to windowsy standardowo nie działają z metodą EAP-TTLS i muszą używać PEAP,
co trzeba wziąć pod uwagę, przy konfiguracji serwera RADIUS.</p>
<p>W związku z powyższym, ustawimy domyślny protokół EAP na PEAP, zakładając, że najwięcej klientów
będzie właśnie go używać. Konfiguracja uwierzytelniania EAP jest trzymana w pliku
<code>/etc/freeradius2/eap.conf</code> . Edytujmy go zatem i ustawmy odpowiednie ścieżki do certyfikatów. W
zależności od tego czy wybieraliśmy opcje szyfrowania plików certyfikatów przy ich tworzeniu, to
będziemy musieli także określić hasło do certyfikatów. W tym przypadku, wszystkie certyfikaty są
bez haseł, zatem pole od hasła w konfiguracji freeradius'a pozostawiamy puste:</p>
<pre><code>tls {
...
    private_key_password =
    private_key_file = ${certdir}/radius.key
    certificate_file = ${certdir}/radius.crt
    CA_file = ${cadir}/ca.crt
    dh_file = ${certdir}/dh2048.pem
...
</code></pre>
<p>Mając skonfigurowany tunel TLS, możemy skonfigurować także protokół EAP-TTLS:</p>
<pre><code>...
ttls {
    default_eap_type = md5
    copy_request_to_tunnel = yes
    use_tunneled_reply = yes
}
...
</code></pre>
<p>Podobnie postępujemy w przypadku protokołu PEAP:</p>
<pre><code>..
peap {
   default_eap_type = mschapv2
   copy_request_to_tunnel = yes
   use_tunneled_reply = yes
}
...
</code></pre>
<h2 id="test-serwera-radius">Test serwera RADIUS</h2>
<p>Przydałoby się wstępnie przetestować serwer RADIUS'a odpalając go w trybie <code>debug</code> przy pomocy tego
poniższego polecenia:</p>
<pre><code># radiusd -XXX
</code></pre>
<p>W terminalu powinna pokazać nam się cała masa wiadomości. Na końcu zaś powinniśmy zobaczyć wpisy
podobne do tych poniżej:</p>
<pre><code>Debug: Listening on authentication interface lo address 127.0.0.1 port 1812
Debug: Listening on accounting interface lo address 127.0.0.1 port 1813
Info: Ready to process requests.
</code></pre>
<p>Jeśli z jakiegoś powodu dostaniemy błąd <code>radiusd: can't resolve symbol 'EC_KEY_new_by_curve_name'</code> ,
to musimy sprawdzić jaką wersję OpenSSL mamy zainstalowaną na routerze oraz w oparciu o jaką wersję
był kompilowany pakiet <code>freeradius2</code> . Poniżej przykład:</p>
<pre><code># opkg list-installed | grep openssl
libopenssl - 1.0.2g-1

# radiusd -XXX
...
Debug:   ssl: OpenSSL 1.0.2g  1 Mar 2016
</code></pre>
<p>Jeśli numerki w obu przypadkach się nie pokrywają, to jest wielce prawdopodobne, że nie uda nam się
odpalić serwera RADIUS. Jeśli mimo posiadania tych samych wersji nadal dostajemy w/w błąd, to być
może pakiet <code>libopenssl</code> pochodzi z innego źródła niż pakiet <code>freeradius</code> . W tym przypadku
wszystko jest w należytym porządku.</p>
<h2 id="test-podłączania-klientów-do-sieci-wifi">Test podłączania klientów do sieci WiFi</h2>
<p>Serwer RADIUS'a stoi już na routerze i teraz trzeba zaprzęgnąć do pracy jakąś maszynę kliencką w
celu przetestowania połączenia. Jako, że mamy skonfigurowaną obsługę trzech metod
uwierzytelniających, to potrzebne nam są odpowiednie profile dla klientów sieci WiFi, by ci mogli
się bez problemu podłączyć. Poniżej są 3 zwrotki dla linux'owego narzędzia <code>wpasupplicant</code>
zajmującego się konfiguracją połączeń bezprzewodowych.</p>
<p>Konfiguracja dla EAP-TLS</p>
<pre><code>network={
    id_str=&quot;home_wifi_static&quot;
    priority=10
    ssid=&quot;Winter_Is_Coming&quot;
    bssid=E8:94:F6:68:79:EF
    proto=RSN
    key_mgmt=WPA-EAP
    eap=TLS
    pairwise=CCMP
    group=CCMP
    auth_alg=OPEN
    identity=&quot;morfik_laptop&quot;
    ca_cert=&quot;/etc/CA_RADIUS/keys/ca.crt&quot;
    client_cert=&quot;/etc/CA_RADIUS/keys/morfik_laptop.crt&quot;
    private_key=&quot;/etc/CA_RADIUS/keys/morfik_laptop.key&quot;
#   private_key=&quot;/etc/CA_RADIUS/keys/morfik_laptop.p12&quot;
#   private_key_passwd=&quot;jakies-haslo-client&quot;
    scan_ssid=0
    disabled=0
}
</code></pre>
<p>Konfiguracja dla EAP-TTLS</p>
<pre><code>network={
    id_str=&quot;home_wifi_static&quot;
    priority=10
    ssid=&quot;Winter_Is_Coming&quot;
    bssid=E8:94:F6:68:79:EF
    proto=RSN
    key_mgmt=WPA-EAP
    eap=TTLS
    pairwise=CCMP
    group=CCMP
    auth_alg=OPEN
    phase1=&quot;peaplabel=1&quot;
    phase2=&quot;auth=MD5&quot;
    anonymous_identity=&quot;anonymous&quot;
    identity=&quot;morfik&quot;
    password=&quot;e6a664c54f6427&quot;
    ca_cert=&quot;/etc/CA_RADIUS/keys/ca.crt&quot;
    scan_ssid=0
    disabled=0
}
</code></pre>
<p>Konfiguracja dla PEAP:</p>
<pre><code>network={
    id_str=&quot;home_wifi_static&quot;
    priority=15
    ssid=&quot;Winter_Is_Coming&quot;
    bssid=E8:94:F6:68:79:EF
    proto=RSN
    key_mgmt=WPA-EAP
    eap=PEAP
    pairwise=CCMP
    group=CCMP
    auth_alg=OPEN
    phase2=&quot;auth=MSCHAPV2&quot;
    anonymous_identity=&quot;anonymous&quot;
    identity=&quot;morfik&quot;
    password=&quot;e6a664c54f6427&quot;
    ca_cert=&quot;/etc/CA_RADIUS/keys/ca.crt&quot;
    scan_ssid=0
    disabled=0
}
</code></pre>
<p>Interesują nas głównie linijki zawierające <code>ca_cert</code> , <code>client_cert</code> , <code>private_key</code> ,
<code>private_key_passwd</code> . Z tym, że w zależności od konfiguracji, nie wszystkie bloki posiadają każdy z
tych parametrów. Jeśli nie szyfrujemy kluczy, parametr <code>private_key_passwd</code> może zostać
wykomentowany. W przypadku protokołów EAP-TTLS oraz PEAP mamy możliwość sprecyzowania parametru
<code>anonymous_identity</code> . Zwykle przyjmuje on wartość <code>anonymous</code> . Jest to nic innego jak zewnętrzna
tożsamość używana do zestawiania tunelu TLS. W przypadku gdybyśmy nie podali w konfiguracji tego
parametru, zostanie użyta realna tożsamość, czyli ta, która służy do logowania się do sieci WiFi.</p>
<p>Powyższe ustawienia dla protokołów EAP-TTLS i PEAP dają gwarancję, że nie da się podsłuchać realnych
tożsamości używanych przy logowaniu się do sieci. Atakujący węsząc w sieci zobaczy jedynie login
<code>anonymous</code> , z którym nic nie da się zrobić.</p>
<p>Jeśli chodzi jeszcze o protokoły EAP-TTLS oraz PEAP nie trzeba definiować parametru <code>ca_cert</code> w
konfiguracji narzędzia <code>wpasupplicant</code>. W przypadku, gdy tego nie zrobimy, to nie zweryfikujemy tym
samym certyfikatu serwera RADIUS. Jeśli mamy podaną ścieżkę do certyfikatu serwera w konfiguracji,
to w przypadku niezgodności certyfikatu serwera, zostaniemy o tym fakcie poinformowani. Jeśli nie
przeprowadzimy weryfikacji certyfikatu serwera (brak parametru <code>ca_cert</code> ), to zostaniemy podłączeni
do sieci jak gdyby nigdy nic. Jeśli ktoś w takiej sytuacji spróbuje postawić AP/NAS, na którym
będzie miał taką samą sieć jak nasza (ten sam BSSID i ESSID), to istnieje spore prawdopodobieństwo,
że podłączymy się do infrastruktury tego kogoś i wszystkie dane logowania do naszego konta w naszej
sieci WiFi podamy mu jak na tacy.</p></div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/wifi/">Wifi</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/chaos-calmer/">Chaos-Calmer</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/router/">Router</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/radius/">Radius</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Podziel się na Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmorfikov.github.io%2fpost%2frouter-openwrt-jako-serwer-klient-radius%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2frouter-openwrt-jako-serwer-klient-radius%2f&amp;text=Router%20OpenWRT%20jako%20serwer%20i%20klient%20RADIUS" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Reddit" href="https://www.reddit.com/submit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2frouter-openwrt-jako-serwer-klient-radius%2f&amp;title=Router%20OpenWRT%20jako%20serwer%20i%20klient%20RADIUS" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Reddit', 'width=832,height=624,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Reddit" role="img" width="32" height="32" viewBox="0 0 512 512"><path fill-rule="evenodd" d="M375 146a32 32 0 1 0-29-46l-65-13c-5-1-9 2-10 6l-22 97c-45 1-85 15-113 36a42 42 0 1 0-45 69l-1 12c0 65 74 117 166 117s166-52 166-117l-1-11a42 42 0 1 0-44-69c-28-21-67-35-111-37l19-86 58 13a32 32 0 0 0 32 29zM190 353c2-1 4 0 5 1 15 11 38 18 61 18s46-6 61-18a7 7 0 0 1 8 10c-18 14-44 21-69 21-25-1-51-7-69-21a6 6 0 0 1 3-11zm23-44a31 31 0 1 1-44-44 31 31 0 0 1 44 44zm130 0a31 31 0 1 0-44-44 31 31 0 0 0 44 44z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Telegram" href="https://t.me/share/url?url=https%3a%2f%2fmorfikov.github.io%2fpost%2frouter-openwrt-jako-serwer-klient-radius%2f&amp;title=Router%20OpenWRT%20jako%20serwer%20i%20klient%20RADIUS" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Telegram', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmorfikov.github.io%2fpost%2frouter-openwrt-jako-serwer-klient-radius%2f&title=Router%20OpenWRT%20jako%20serwer%20i%20klient%20RADIUS" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na VK" href="https://vk.com/share.php?url=https%3a%2f%2fmorfikov.github.io%2fpost%2frouter-openwrt-jako-serwer-klient-radius%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na VK', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="VK" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M274 363c5-1 14-3 14-15 0 0-1-30 13-34s32 29 51 42c14 9 25 8 25 8l51-1s26-2 14-23c-1-2-9-15-39-42-31-30-26-25 11-76 23-31 33-50 30-57-4-7-20-6-20-6h-57c-6 0-9 1-12 6 0 0-9 25-21 45-25 43-35 45-40 42-9-5-7-24-7-37 0-45 7-61-13-65-13-2-59-4-73 3-7 4-11 11-8 12 3 0 12 1 17 7 8 13 9 75-2 81-15 11-53-62-62-86-2-6-5-7-12-9H79c-6 0-15 1-11 13 27 56 83 193 184 192z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pocket" href="https://getpocket.com/edit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2frouter-openwrt-jako-serwer-klient-radius%2f&amp;title=Router%20OpenWRT%20jako%20serwer%20i%20klient%20RADIUS" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=480,height=320,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pocket" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M388.8 88.9H123.2A47.4 47.4 0 0 0 76 136.5v131.9c0 2.4.2 4.8.5 7.2a101.8 101.8 0 0 0-.5 10.6c0 75.6 80.6 137 180 137s180-61.4 180-137c0-3.6-.2-7.1-.5-10.6.3-2.4.5-4.8.5-7.2v-132A47.4 47.4 0 0 0 388.8 89zm-22.4 132.6l-93 93c-4.7 4.6-11 7-17.1 7a23.8 23.8 0 0 1-17.7-7l-93-93a24 24 0 0 1 33.8-33.8l76.6 76.5 76.6-76.5a24 24 0 0 1 33.8 33.8z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pinterest" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2frouter-openwrt-jako-serwer-klient-radius%2f&description=Router%20OpenWRT%20jako%20serwer%20i%20klient%20RADIUS" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=800,height=720,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pinterest" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="m265 65c-104 0-157 75-157 138 0 37 14 71 45 83 5 2 10 0 12-5l3-18c2-6 1-7-2-12-9-11-15-24-15-43 0-56 41-106 108-106 60 0 92 37 92 85 0 64-28 116-70 116-23 0-40-18-34-42 6-27 19-57 19-77 0-18-9-34-30-34-24 0-42 25-42 58 0 20 7 34 7 34l-29 120a249 249 0 0 0 2 86l3-1c2-3 31-37 40-72l16-61c7 15 29 28 53 28 71 0 119-64 119-151 0-66-56-126-140-126z"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="Mikhail Morfikov avatar" src="https://morfikov.github.io/img/avatar.png" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				Mikhail Morfikov
			</div>
			<div class="author__bio">Po ponad 10 latach spędzonych z różnej maści linux&#39;ami (Debian/Ubuntu, OpenWRT, Android) mogę śmiało powiedzieć, że nie ma rzeczy niemożliwych i problemów, których nie da się rozwiązać. Jedną umiejętność, którą ludzki umysł musi posiąść, by wybrnąć nawet z tej najbardziej nieprzyjemniej sytuacji, to zdolność logicznego rozumowania.</div>
		</div>
	</div>
</div>
	



<div class="related block">
	<h3 class="related__title">Powiązane</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/siec-bezprzewodowa-wifi-w-openwrt-wlan/">Sieć bezprzewodowa WiFi w OpenWRT (WLAN)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/losowy-adres-mac-dla-wan-w-openwrt/">Losowy adres MAC dla WAN w OpenWRT</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/failover-load-balancing-openwrt-mwan3/">Failover i load balancing w OpenWRT (mwan3)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/wake-lan-z-etherwake-pod-openwrt/">Wake On LAN z etherwake pod OpenWRT</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/nat-reflection-oraz-nat-loopback-w-openwrt/">NAT Reflection oraz NAT Loopback w OpenWRT</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/wps-czyli-wifi-protected-setup-w-openwrt/">WPS, czyli WiFi Protected Setup w OpenWRT</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/konfiguracja-interfejsow-sieciowych-w-openwrt/">Konfiguracja interfejsów sieciowych w OpenWRT</a></li>
		
	</ul>
</div>

	<div id="comments">
		<script src="https://utteranc.es/client.js"
        repo="morfikov/morfitronik-comments"
        issue-term="og:title"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>

	</div>

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:morfitronik@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://t.me/morfikov">
			<svg class="social__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/morfikov">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/morfikov">
			<svg class="social__icon" aria-label="Gitlab" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M450 282l-22-67-43-133c-2-7-12-7-14 0l-43.3 133H184.3L141 82c-2-7-12-7-14 0L84 215l-22 67c-2 6 0 13 6 16l188 137 188-137c6-3 8-10 6-16z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/users/3015317">
			<svg class="social__icon" aria-label="Stack Overflow" role="img" width="32" height="32" viewBox="0 0 512 512"><g stroke-width="30"><path fill="none" d="M125 297v105h241V297"/><path d="M170 341h150m-144-68l148 31M199 204l136 64m-95-129l115 97M293 89l90 120"/></g></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://mastodon.social/@morfik">
			<svg class="social__icon" aria-label="Mastodon" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M416 197c0-74-49-96-49-96-42-22-172-24-222 0 0 0-49 22-49 96v59c2 72 14 145 81 162 33 9 89 18 140-6l-2-27s-27 7-58 7c-74 2-67-39-70-52 0 0 51 17 137 6 42-6 80-32 85-56 8-38 7-93 7-93zm-58 96h-35v-88c0-18-8-27-23-27-18 0-27 11-27 33v47h-34v-47c0-22-9-33-27-33-15 0-23 9-23 27v88h-35v-91c0-18 5-60 52-60 39 0 50 37 50 37s10-37 50-37c45 0 52 42 52 60v91z"/></svg>
		</a>
</div>
	<div class="footer__copyright">© 2024 Mikhail Morfikov.
	<span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span>
	<span class="footer__copyright-cc">
		<div class="license-icons">
			<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" title="Creative Commons Attribution 4.0 International license">
<i class="icon-cc"></i><i class="icon-cc-by"></i><i class="icon-cc-nc"></i><i class="icon-cc-sa"></i>
</a>
		</div>
		Except where otherwise noted, content on this site is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International license</a>.
	</span>
	</div>
</footer>

<script src="https://morfikov.github.io/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="https://morfikov.github.io/js/custom.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 40,
  textColor: '#c3c3c3'
})</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
const images = Array.from(document.querySelectorAll(".entry__content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    scrollOffset: 40,  
    container: null,  
    template: null,  
    background: 'rgba(0, 0, 0, 0.8)'
  });
});
</script>
</body>
</html>
