<!DOCTYPE html>
<html class="no-js" lang="pl-PL">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>DHCP i DNS, czyli konfiguracja sieci w OpenWRT | Morfitronik</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="DHCP i DNS, czyli konfiguracja sieci w OpenWRT" />
<meta property="og:description" content="Rutery WiFi są w stanie zorganizować przewodową i/lub bezprzewodową sieć w naszych domach. By taka
sieć działała bez zarzutu, potrzebna jest odpowiednia adresacja wszystkich komputerów wewnątrz niej.
W obecnych czasach już praktycznie nie stosuje się statycznej konfiguracji, bo to zadanie zostało
zrzucone na barki serwera DHCP. W OpenWRT do tego celu oddelegowane jest oprogramowanie
dnsmasq. Zapewnia ono nie tylko wspomniany wyżej serwer DHCP ale także serwer cache&#39;ujący
zapytania DNS. Ten drugi z kolei jest niezastąpiony w przypadku przekazywania zapytań o nazwy domen
do upstream&#39;owego serwera DNS, który zajmuje się rozwiązywaniem tych nazw na odpowiadające im adresy
IP. Bez dnsmasq ogarnięcie naszej sieci przerodziłoby się w istne piekło. Dlatego też w tym
artykule przybliżymy sobie nieco konfigurację tego narzędzia." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://morfikov.github.io/post/dhcp-dns-czyli-konfiguracja-sieci-w-openwrt/" />
<meta property="article:published_time" content="2016-05-02T16:21:20+02:00" />
<meta property="article:modified_time" content="2016-05-02T16:21:20+02:00" />

		<meta itemprop="name" content="DHCP i DNS, czyli konfiguracja sieci w OpenWRT">
<meta itemprop="description" content="Rutery WiFi są w stanie zorganizować przewodową i/lub bezprzewodową sieć w naszych domach. By taka
sieć działała bez zarzutu, potrzebna jest odpowiednia adresacja wszystkich komputerów wewnątrz niej.
W obecnych czasach już praktycznie nie stosuje się statycznej konfiguracji, bo to zadanie zostało
zrzucone na barki serwera DHCP. W OpenWRT do tego celu oddelegowane jest oprogramowanie
dnsmasq. Zapewnia ono nie tylko wspomniany wyżej serwer DHCP ale także serwer cache&#39;ujący
zapytania DNS. Ten drugi z kolei jest niezastąpiony w przypadku przekazywania zapytań o nazwy domen
do upstream&#39;owego serwera DNS, który zajmuje się rozwiązywaniem tych nazw na odpowiadające im adresy
IP. Bez dnsmasq ogarnięcie naszej sieci przerodziłoby się w istne piekło. Dlatego też w tym
artykule przybliżymy sobie nieco konfigurację tego narzędzia.">
<meta itemprop="datePublished" content="2016-05-02T16:21:20+02:00" />
<meta itemprop="dateModified" content="2016-05-02T16:21:20+02:00" />
<meta itemprop="wordCount" content="1490">



<meta itemprop="keywords" content="dns,chaos-calmer,router,dhcp,dnsmasq,cache,resolver," />

		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="DHCP i DNS, czyli konfiguracja sieci w OpenWRT"/>
<meta name="twitter:description" content="Rutery WiFi są w stanie zorganizować przewodową i/lub bezprzewodową sieć w naszych domach. By taka
sieć działała bez zarzutu, potrzebna jest odpowiednia adresacja wszystkich komputerów wewnątrz niej.
W obecnych czasach już praktycznie nie stosuje się statycznej konfiguracji, bo to zadanie zostało
zrzucone na barki serwera DHCP. W OpenWRT do tego celu oddelegowane jest oprogramowanie
dnsmasq. Zapewnia ono nie tylko wspomniany wyżej serwer DHCP ale także serwer cache&#39;ujący
zapytania DNS. Ten drugi z kolei jest niezastąpiony w przypadku przekazywania zapytań o nazwy domen
do upstream&#39;owego serwera DNS, który zajmuje się rozwiązywaniem tych nazw na odpowiadające im adresy
IP. Bez dnsmasq ogarnięcie naszej sieci przerodziłoby się w istne piekło. Dlatego też w tym
artykule przybliżymy sobie nieco konfigurację tego narzędzia."/>

	<link rel="stylesheet" href="https://morfikov.github.io/css/bundle.css">
	<link rel="stylesheet" href="https://morfikov.github.io/css/custom.css">
	<link rel="icon" href="https://morfikov.github.io/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="https://morfikov.github.io/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="https://morfikov.github.io/manifest.json">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-119125303-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
	<header class="header">
	<a class="logo" href="https://morfikov.github.io/">Morfitronik</a>
	
<nav class="main-nav main-nav--right" role="navigation">
	<button id="toggle" class="main-nav__btn" aria-label="Menu toggle" aria-expanded="false" tabindex="0">
		<div class="main-nav__btn-box" tabindex="-1">
			<svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18">
				<path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/>
				<path class="icon-menu__x" d="M11.55 9L18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55 0 9 6.45 15.45 0 18 2.55 11.55 9z"/>
			</svg>
		</div>
	</button>
	<ul id="menu" class="main-nav__list">
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/categories/">
					
					<span class="main-nav__text">Kategorie</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/tags/">
					
					<span class="main-nav__text">Tagi</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/info-kontakt/">
					
					<span class="main-nav__text">Info/Kontakt</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/wsparcie/">
					
					<span class="main-nav__text">Wsparcie</span>
					
				</a>
			</li>
	</ul>
</nav>
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/">Home</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">DHCP i DNS, czyli konfiguracja sieci w OpenWRT</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2016-05-02T16:21:20&#43;02:00">Opublikowano: 02/05/2016</time>

<span class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Kategorie:
		<a class="meta-categories__link" href="https://morfikov.github.io/categories/openwrt/" rel="category">OpenWRT</a>
	</span>
</span>
	</div>
				<h1 class="entry__title">DHCP i DNS, czyli konfiguracja sieci w OpenWRT</h1>
<details class="entry__toc toc" >
	<summary class="toc__title">Spis treści</summary>
	<nav id="TableOfContents">
  <ol>
    <li><a href="#jak-konfigurować-dnsmasq-w-openwrt">Jak konfigurować dnsmasq w OpenWRT</a></li>
    <li><a href="#serwer-dns">Serwer DNS</a></li>
    <li><a href="#serwer-dhcp">Serwer DHCP</a></li>
    <li><a href="#statyczne-lease-dhcp">Statyczne lease DHCP</a></li>
    <li><a href="#opcje-dla-klientów-dhcp">Opcje dla klientów DHCP</a></li>
  </ol>
</nav>
</details>
				<div class="entry__content"><p>Rutery WiFi są w stanie zorganizować przewodową i/lub bezprzewodową sieć w naszych domach. By taka
sieć działała bez zarzutu, potrzebna jest odpowiednia adresacja wszystkich komputerów wewnątrz niej.
W obecnych czasach już praktycznie nie stosuje się statycznej konfiguracji, bo to zadanie zostało
zrzucone na barki serwera DHCP. W OpenWRT do tego celu oddelegowane jest <a href="http://www.thekelleys.org.uk/dnsmasq/doc.html">oprogramowanie
dnsmasq</a>. Zapewnia ono nie tylko wspomniany wyżej serwer DHCP ale także serwer cache'ujący
zapytania DNS. Ten drugi z kolei jest niezastąpiony w przypadku przekazywania zapytań o nazwy domen
do upstream'owego serwera DNS, który zajmuje się rozwiązywaniem tych nazw na odpowiadające im adresy
IP. Bez <code>dnsmasq</code> ogarnięcie naszej sieci przerodziłoby się w istne piekło. Dlatego też w tym
artykule przybliżymy sobie nieco konfigurację tego narzędzia.</p>
<h2 id="jak-konfigurować-dnsmasq-w-openwrt">Jak konfigurować dnsmasq w OpenWRT</h2>
<p>W przypadku OpenWRT, <code>dnsmasq</code> można konfigurować na dwa sposoby. Pierwszym z nich jest konfiguracja
przez plik <code>/etc/config/dhcp</code> . I jest to standardowe podejście. Przy starcie routera, po
przetworzeniu skryptu <code>/etc/init.d/dnsmasq</code> jest generowany plik <code>/var/etc/dnsmasq.conf</code> . Niemniej
jednak, tak utworzona konfiguracja nie zawiera wszystkich opcji możliwych do określenia w
<code>dnsmasq</code> . Z tego właśnie powodu developerzy OpenWRT zostawili furtkę bezpieczeństwa, dzięki której
możemy korzystać z dodatkowego pliku konfiguracyjnego <code>/etc/dnsmasq.conf</code> . I to jest właśnie drugi
ze sposobów konfiguracji. Wszystkie niestandardowe opcje są umieszczane właśnie w tym pliku. Zatem
jeśli jakieś opcje nie są uwzględniane przez natywny mechanizm OpenWRT, to zawsze możemy go obejść
przez plik <code>/etc/dnsmasq.conf</code> i to tam dodać stosowne wpisy.</p>
<p>O samej konfiguracji narzędzia <code>dnsmasq</code> wspominałem już wielokrotnie na tym blogu w kontekście
różnych aspektów pracy zarówno systemów z rodziny linux jak i OpenWRT. Niemniej jednak, tutaj
postaram się zebrać wszystkie te bardziej użyteczne opcje, tak by były w jednym miejscu. Warto też
wspomnieć, że cała masa parametrów jest opisana na <a href="https://wiki.openwrt.org/doc/uci/dhcp">wiki OpenWRT</a>. Przejdźmy zatem do edycji
pliku <code>/etc/config/dhcp</code> .</p>
<h2 id="serwer-dns">Serwer DNS</h2>
<p>Poniższe dwie opcje są w stanie odfiltrować zapytania, na które nie potrafią odpowiedzieć publiczne
serwery DNS. Pierwsza z nich, tj. <code>domainneeded</code> , nie forwarduje nazw bez kropek (bez części
domeny). Zaś <code>boguspriv</code> nie zezwala na przekazywanie adresów z prywatnej przestrzeni adresowej.</p>
<pre><code>option domainneeded '1'
option boguspriv '1'
</code></pre>
<p>Opcja <code>local</code> sprawia, że wszystkie zapytania we wskazanej domenie będą rozwiązywane lokalnie, tj.
w oparciu o plik <code>/etc/hosts</code> lub lease wydawane za sprawą protokołu DHCP. Opcja <code>domain</code> ustawia
domenę dla routera. W efekcie wszystkie hosty, które otrzymują konfiguracje od serwera DHCP, będą
skonfigurowane na tę domenę. Dodatkowo, nazwa określona tutaj jest wykorzystywana w opcji
<code>expandhosts</code> , która z kolei odpowiada za dodanie części domenowej do nazwy hostów, które jej nie
posiadają.</p>
<pre><code>option local '/lan/'
option domain 'lan'
option expandhosts '1'
</code></pre>
<p>Opcja <code>nohosts</code> określa czy wpisy znajdujące się w pliku <code>/etc/hosts</code> mają być brane pod uwagę przy
rozwiązywaniu nazw hostów.</p>
<pre><code>option nohosts '0'
</code></pre>
<p>Opcja <code>rebind_protection</code> zapobiega przekierowaniu w oparciu od DNS, tj. wpisujemy jedną domenę, a
jest nam zwracana inna, tzw <a href="https://en.wikipedia.org/wiki/DNS_rebinding">DNS rebinding</a>. Za pomocą opcji <code>rebind_localhost</code> z tego
mechanizmu jest wyłączony blok 127.0.0.0/8. A to ze względu na fakt, że szereg lokalnych usług
wymaga tego typu operacji do poprawnego działania. Jeśli jednak są domeny, które życzylibyśmy sobie
również wyłączyć spod mechanizmu DNS rebinding, to możemy je sprecyzować w <code>list rebind_domain</code> .</p>
<pre><code>option rebind_protection '1'
option rebind_localhost '1'
list rebind_domain 'free.aero2.net.pl'
</code></pre>
<p>W przypadku nieudanego rozwiązania nazwy na adres IP, takie zapytanie może być buforowane i zajmować
miejsce w pamięci. Za pomocą opcji <code>nonegcache</code> możemy wyłączyć lub włączyć dodawanie takich adresów
do pamięci cache.</p>
<pre><code>option nonegcache '1'
</code></pre>
<p>Zapytania DNS zajmują trochę czasu i w przypadku, gdy odwiedzamy jedną stronę kilka razy, to za
każdym razem trzeba rozwiązać jej nazwę na adres IP. Przynajmniej takie jest domyślne zachowanie w
systemach z rodziny linux, bo te nie posiadają cache DNS. Co prawda, realizacja takiego żądania nie
trwa długo ale zawsze jest to parę milisekund. W tym celu stworzono mechanizm, który buforuje
zapytania DNS. Gdy odwiedzamy ponownie ten sam adres, odpowiedź na żądanie pochodzi od <code>dnsmasq</code> i
jest zwracana niemal natychmiast. Oczywiście, o ile taki wpis figuruje w cache i jest ważny. Rozmiar
takiego cache (ilość wpisów) można dostosować sobie przy pomocy opcji <code>cachesize</code> .</p>
<pre><code>option cachesize '10000'
</code></pre>
<p>Kolejne dwie opcje, tj. <code>min-cache-ttl</code> oraz <code>max-cache-ttl</code> , nie mogą zostać określone w pliku
<code>/etc/config/dhcp</code> i trzeba je umieścić w pliku <code>/etc/dnsmasq.conf</code> . Odpowiadają one za <a href="https://en.wikipedia.org/wiki/Time_to_live#DNS_records">czas
ważności rekordu DNS w cache</a>. Po upłynięciu tego czasu trzeba będzie ponownie odpytać
upstream'owy serwer DNS, by rozwiązać nazwę.</p>
<pre><code>min-cache-ttl=3600
max-cache-ttl=7200
</code></pre>
<p>Opcja <code>dnsforwardmax</code> odpowiada za ilość jednoczesnych zapytań, które mogą być obsługiwane przez
serwer DNS.</p>
<pre><code>option dnsforwardmax '1000'
</code></pre>
<p>Przy pomocy opcji <code>logqueries</code> zapytania DNS można logować w celu późniejszego debug'owa.</p>
<pre><code>option logqueries '1'
</code></pre>
<p>Za pomocą opcji <code>resolvfile</code> możemy określić nazwę pliku, w którym to będą znajdować się wpisy z
adresami upstream'owych serwerów DNS. Standardowo taki plik jest generowany automatycznie przy
starcie routera i umieszczany w katalogu <code>/tmp/</code> .</p>
<pre><code>option resolvfile '/tmp/resolv.conf.auto'
</code></pre>
<p>W OpenWRT plik <code>/etc/resolv.conf</code> jest podlinkowany do <code>/tmp/resolv.conf</code> . Znajduje się w nim
lokalny adres serwera DNS (routera), do którego to wędrują wszelkie zapytania o domeny z sieci
lokalnej. Opcja <code>noresolv</code> sprawi, że <code>dnsmasq</code> nie będzie używał DNS'ów pobranych z lease DHCP od
ISP. Trzeba jednak pamiętać, że by nazwy domen były rozwiązywane, to musimy określić jakiś serwer
DNS. Za to odpowiadają wpisy z <code>list server</code> . Natomiast ostatni wpis poniżej sprawi, że wszelkie
zapytania o domeny (i subdomeny) <code>google.com</code> będą rozwiązywane przez góglowski serwer DNS.</p>
<pre><code>option noresolv '1'
list server '208.67.222.222'
list server '208.67.220.220'
list server '/google.com/8.8.8.8'
</code></pre>
<p>Jeśli chcemy określić statyczny wpis DNS dla jakiegoś adresu IP, to możemy to zrobić albo przez
wspomniany wyżej plik <code>/etc/hosts</code> , albo definiując wpis w konfiguracji <code>dnsmasq</code> . Jeśli
zdecydujemy się na tę drugą opcję, to w pliku <code>/etc/config/dhcp</code> musimy zdefiniować blok <code>config domain</code> . Ten blok ma poniższą postać:</p>
<pre><code>config domain
    option name 'bdi.free.aero2.net.pl'
    option ip '10.2.37.78'
</code></pre>
<h2 id="serwer-dhcp">Serwer DHCP</h2>
<p>Opcje dotyczące modułu DNS w <code>dnsmasq</code> mamy z głowy. Teraz przyszła pora, by rozprawić się z opcjami
dotyczącymi serwera DHCP. Przede wszystkim, jeśli mamy w sieci tylko jeden router i żadna inna
maszyna nie świadczy usługi DHCP, to serwer obecny w routerze jest typu <code>authoritative</code> . W
warunkach domowych jest to prawdziwa sytuacja praktycznie w 100%. Dlatego też by przyśpieszyć
przydzielanie lease w konfiguracji OpenWRT dla <code>dnsmasq</code> mamy ustawioną poniższą opcję.</p>
<pre><code>option authoritative '1'
</code></pre>
<p>Trzeba także określić zakres adresów IP przydzielanych lokalnym maszynom przez serwer DHCP na
routerze. Przy czym, interesuje nas jedynie interfejs <code>lan</code> . Dlatego też interfejs <code>wan</code> poniżej ma
ustawioną flagę <code>ignore</code> . W ten sposób wskazujemy <code>dnsmasq</code> , by uruchamiał serwer DHCP tylko na
określonych interfejsach sieciowych.</p>
<pre><code>config dhcp 'lan'
    option interface 'lan'
    option start '100'
    option limit '150'
    option leasetime '12h'
    option dhcpv6 'server'
    option ra 'server'

config dhcp 'wan'
    option interface 'wan'
    option ignore '1'
</code></pre>
<p>Standardowa sieć w OpenWRT to 192.168.1.0/24 (192.168.1.1-192.168.1.254). Wyżej w bloku <code>config dhcp 'lan'</code> mamy szereg opcji, które mówią serwerowi DHCP jak ma się zachowywać. Według opcji <code>start</code> ,
pierwszy adres IP otrzymany via DHCP będzie miał numer <code>192.168.1.100</code> . Z kolei opcja <code>limit</code> ,
określa ile adresów może być do dyspozycji serwera. W tym wypadku <code>150</code> , czyli pula adresów
przydzielana przez serwer DHCP to 192.168.1.100-192.168.1.249. Możemy także określić ważność lease
DHCP. Jako, że są to komputery w sieci domowej, możemy ten parametr ustawić na 24-48 godzin. Po
upływie połowy określonego czasu, lease traci ważność. W takim wypadku host ponownie odpytuje
serwer DHCP i poprosi o konfigurację sieci. Opcje <code>dhcpv6</code> oraz <code>ra</code> odpowiadają za konfigurację
protokołu IPv6.</p>
<p>Niżej mamy parametr określający maksymalną ilość lease DHCP. Dobrze jest ten parametr skontrastować
z pulą adresów, którą dysponuje serwer DHCP (widoczną powyżej).</p>
<pre><code>option dhcpleasemax '150'
</code></pre>
<h2 id="statyczne-lease-dhcp">Statyczne lease DHCP</h2>
<p>Przy pomocy <code>dnsmasq</code> jesteśmy także w stanie definiować statyczne lease DHCP. Możemy to zrobić z
grubsza na dwa sposoby. Pierwszy z nich polega na skorzystaniu z opcji <code>readethers</code> w pliku
<code>/etc/config/dhcp</code> . Za jej sprawą przeszukiwany jest plik <code>/etc/ethers</code> , gdzie znajduje się baza
adresów MAC wraz z przypisanymi im adresami IP.</p>
<pre><code>option readethers '1'
</code></pre>
<p>Sam plik <code>/etc/ethers</code> wygląda następująco:</p>
<pre><code>3c:4a:92:00:4c:5b      192.168.1.150
00:11:22:33:44:55      192.168.1.200
</code></pre>
<p>Statyczne lease DHCP możemy także zdefiniować bezpośrednio w konfiguracji <code>dnsmasq</code> przez dodawanie
bloków podobnych do tego poniżej:</p>
<pre><code>config host
    option ip       '192.168.1.166'
    option mac      '00:16:e6:34:c4:e0'
    option name     'the-hound'
</code></pre>
<p>Taki zapis sprawi, że hostowi identyfikującemu się adresem MAC <code>00:16:e6:34:c4:e0</code> zostanie
przypisany adres IP <code>192.168.1.166</code> i nazwa <code>the-hound</code> .</p>
<h2 id="opcje-dla-klientów-dhcp">Opcje dla klientów DHCP</h2>
<p>W pliku <code>/etc/confg/dhcp</code> możemy także zdefiniować opcje, które będą przesyłane z lease DHCP do
hostów w sieci lokalnej. Pełna lista wszystkich dostępnych parametrów <a href="https://www.iana.org/assignments/bootp-dhcp-parameters/bootp-dhcp-parameters.xml">znajduje się tutaj</a>.
Poniżej przykład:</p>
<pre><code>config dhcp 'lan'
    ...
    list 'dhcp_option' '3,192.168.1.1'
    list 'dhcp_option' '6,8.8.8.8,8.8.4.4'
</code></pre>
<p>Mamy tutaj dwie opcje, z których pierwsza posiada numer <code>3</code> , druga zaś <code>6</code> . Zgodnie z powyższym
linkiem są to opcje <code>router</code> oraz <code>serwer DNS</code> . Za pomocą pierwszej opcji jesteśmy w stanie ustawić
adres bramy sieciowej na hostach. Oczywiście w przypadku, gdy maszyna z serwerem DHCP nie jest
jednocześnie bramą sieciową. Natomiast jeśli chodzi o drugą opcję, to określa ona adresy serwerów
DNS, które powinny zostać ustawione na hostach pobierających lease DHCP. Standardowo router
uzupełnia to pole wpisując swój własny adres, po czym wszystkie zapytania DNS skierowane do niego
są forward'owane zwykle do serwerów DNS naszego ISP.</p></div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/dns/">dns</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/chaos-calmer/">chaos-calmer</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/router/">router</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/dhcp/">dhcp</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/dnsmasq/">dnsmasq</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/cache/">cache</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/resolver/">resolver</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Podziel się na Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmorfikov.github.io%2fpost%2fdhcp-dns-czyli-konfiguracja-sieci-w-openwrt%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fdhcp-dns-czyli-konfiguracja-sieci-w-openwrt%2f&amp;text=DHCP%20i%20DNS%2c%20czyli%20konfiguracja%20sieci%20w%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Reddit" href="https://www.reddit.com/submit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fdhcp-dns-czyli-konfiguracja-sieci-w-openwrt%2f&amp;title=DHCP%20i%20DNS%2c%20czyli%20konfiguracja%20sieci%20w%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Reddit', 'width=832,height=624,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Reddit" role="img" width="32" height="32" viewBox="0 0 512 512"><path fill-rule="evenodd" d="M375 146a32 32 0 1 0-29-46l-65-13c-5-1-9 2-10 6l-22 97c-45 1-85 15-113 36a42 42 0 1 0-45 69l-1 12c0 65 74 117 166 117s166-52 166-117l-1-11a42 42 0 1 0-44-69c-28-21-67-35-111-37l19-86 58 13a32 32 0 0 0 32 29zM190 353c2-1 4 0 5 1 15 11 38 18 61 18s46-6 61-18a7 7 0 0 1 8 10c-18 14-44 21-69 21-25-1-51-7-69-21a6 6 0 0 1 3-11zm23-44a31 31 0 1 1-44-44 31 31 0 0 1 44 44zm130 0a31 31 0 1 0-44-44 31 31 0 0 0 44 44z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Telegram" href="https://t.me/share/url?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fdhcp-dns-czyli-konfiguracja-sieci-w-openwrt%2f&amp;title=DHCP%20i%20DNS%2c%20czyli%20konfiguracja%20sieci%20w%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Telegram', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmorfikov.github.io%2fpost%2fdhcp-dns-czyli-konfiguracja-sieci-w-openwrt%2f&title=DHCP%20i%20DNS%2c%20czyli%20konfiguracja%20sieci%20w%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na VK" href="https://vk.com/share.php?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fdhcp-dns-czyli-konfiguracja-sieci-w-openwrt%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na VK', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="VK" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M274 363c5-1 14-3 14-15 0 0-1-30 13-34s32 29 51 42c14 9 25 8 25 8l51-1s26-2 14-23c-1-2-9-15-39-42-31-30-26-25 11-76 23-31 33-50 30-57-4-7-20-6-20-6h-57c-6 0-9 1-12 6 0 0-9 25-21 45-25 43-35 45-40 42-9-5-7-24-7-37 0-45 7-61-13-65-13-2-59-4-73 3-7 4-11 11-8 12 3 0 12 1 17 7 8 13 9 75-2 81-15 11-53-62-62-86-2-6-5-7-12-9H79c-6 0-15 1-11 13 27 56 83 193 184 192z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pocket" href="https://getpocket.com/edit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fdhcp-dns-czyli-konfiguracja-sieci-w-openwrt%2f&amp;title=DHCP%20i%20DNS%2c%20czyli%20konfiguracja%20sieci%20w%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=480,height=320,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pocket" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M388.8 88.9H123.2A47.4 47.4 0 0 0 76 136.5v131.9c0 2.4.2 4.8.5 7.2a101.8 101.8 0 0 0-.5 10.6c0 75.6 80.6 137 180 137s180-61.4 180-137c0-3.6-.2-7.1-.5-10.6.3-2.4.5-4.8.5-7.2v-132A47.4 47.4 0 0 0 388.8 89zm-22.4 132.6l-93 93c-4.7 4.6-11 7-17.1 7a23.8 23.8 0 0 1-17.7-7l-93-93a24 24 0 0 1 33.8-33.8l76.6 76.5 76.6-76.5a24 24 0 0 1 33.8 33.8z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pinterest" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fdhcp-dns-czyli-konfiguracja-sieci-w-openwrt%2f&description=DHCP%20i%20DNS%2c%20czyli%20konfiguracja%20sieci%20w%20OpenWRT" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=800,height=720,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pinterest" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="m265 65c-104 0-157 75-157 138 0 37 14 71 45 83 5 2 10 0 12-5l3-18c2-6 1-7-2-12-9-11-15-24-15-43 0-56 41-106 108-106 60 0 92 37 92 85 0 64-28 116-70 116-23 0-40-18-34-42 6-27 19-57 19-77 0-18-9-34-30-34-24 0-42 25-42 58 0 20 7 34 7 34l-29 120a249 249 0 0 0 2 86l3-1c2-3 31-37 40-72l16-61c7 15 29 28 53 28 71 0 119-64 119-151 0-66-56-126-140-126z"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="Mikhail Morfikov avatar" src="https://morfikov.github.io/img/avatar.png" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				Mikhail Morfikov
			</div>
			<div class="author__bio">Po ponad 10 latach spędzonych z różnej maści linux&#39;ami (Debian/Ubuntu, OpenWRT, Android) mogę śmiało powiedzieć, że nie ma rzeczy niemożliwych i problemów, których nie da się rozwiązać. Jedną umiejętność, którą ludzki umysł musi posiąść, by wybrnąć nawet z tej najbardziej nieprzyjemniej sytuacji, to zdolność logicznego rozumowania.</div>
		</div>
	</div>
</div>
	



<div class="related block">
	<h3 class="related__title">Powiązane</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/konfiguracja-dnscrypt-proxy-w-openwrt/">Konfiguracja dnscrypt-proxy w OpenWRT</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/cache-dns-buforowania-zapytan/">Cache DNS, czyli włączenie buforowania zapytań</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/aero2-w-polaczeniu-z-dnsmasq-dnscrypt-proxy/">Aero2 w połączeniu z dnsmasq i dnscrypt-proxy</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/konfiguracja-przyciskow-w-openwrt/">Konfiguracja przycisków w OpenWRT</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/konfiguracja-diod-w-routerze-pod-openwrt-led/">Konfiguracja diod w routerze pod OpenWRT (LED)</a></li>
		
	</ul>
</div>

	
<section class="comments block">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "morfitronik" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:morfitronik@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/mikhailmorfikov">
			<svg class="social__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://t.me/morfikov">
			<svg class="social__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/morfikov">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/morfikov">
			<svg class="social__icon" aria-label="Gitlab" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M450 282l-22-67-43-133c-2-7-12-7-14 0l-43.3 133H184.3L141 82c-2-7-12-7-14 0L84 215l-22 67c-2 6 0 13 6 16l188 137 188-137c6-3 8-10 6-16z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/users/3015317">
			<svg class="social__icon" aria-label="Stack Overflow" role="img" width="32" height="32" viewBox="0 0 512 512"><g stroke-width="30"><path fill="none" d="M125 297v105h241V297"/><path d="M170 341h150m-144-68l148 31M199 204l136 64m-95-129l115 97M293 89l90 120"/></g></svg>
		</a>
</div>
	<div class="footer__copyright">© 2021 Mikhail Morfikov.
	<span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span>
	<span class="footer__copyright-cc">
		Except where otherwise noted, content on this site is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International license</a>.
		<img alt="Licencja Creative Commons" style="border-width:0" src="https://licensebuttons.net/l/by-nc-sa/4.0/80x15.png" />
	</span>
	</div>
</footer>

<script src="https://morfikov.github.io/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="https://morfikov.github.io/js/custom.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 40,
  textColor: '#c3c3c3'
})</script>
</body>
</html>
