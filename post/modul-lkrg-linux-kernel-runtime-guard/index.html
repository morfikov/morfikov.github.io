<!DOCTYPE html>
<html class="no-js" lang="pl-PL">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Moduł LKRG (Linux Kernel Runtime Guard) | Morfitronik</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Moduł LKRG (Linux Kernel Runtime Guard)" />
<meta property="og:description" content="Jakiś czas temu opisywałem moduł TPE (Trusted Path Execution) dla kernela linux, który jest w
stanie dość znacznie poprawić bezpieczeństwo naszego systemu. Ostatnio jednak natknąłem się na
moduł LKRG (Linux Kernel Runtime Guard), którego to zadaniem jest stać na straży samego jądra
operacyjnego i chronić je w czasie rzeczywistym przed różnego rodzaju zagrożeniami poprzez
wykrywanie eksploitów wykorzystujących luki w jego mechanizmach bezpieczeństwa. Jako, że ja
bardzo lubię zbroić swojego Debiana, to postanowiłem się przyjrzeć nieco bliżej temu całemu LKRG i
sprawdzić jego użyteczność. Trzeba jednak wiedzieć, że LKRG jest dostarczany w formie osobnego
modułu zamiast łaty na kernel, przez co trzeba będzie także postarać się o automatyzację pewnych
rzeczy, m.in. procesu budowania modułu przy aktualizacji kernela via DKMS." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://morfikov.github.io/post/modul-lkrg-linux-kernel-runtime-guard/" />
<meta property="article:published_time" content="2020-06-09T20:56:00+00:00" />
<meta property="article:modified_time" content="2020-06-26T20:56:00+02:00" />

		<meta itemprop="name" content="Moduł LKRG (Linux Kernel Runtime Guard)">
<meta itemprop="description" content="Jakiś czas temu opisywałem moduł TPE (Trusted Path Execution) dla kernela linux, który jest w
stanie dość znacznie poprawić bezpieczeństwo naszego systemu. Ostatnio jednak natknąłem się na
moduł LKRG (Linux Kernel Runtime Guard), którego to zadaniem jest stać na straży samego jądra
operacyjnego i chronić je w czasie rzeczywistym przed różnego rodzaju zagrożeniami poprzez
wykrywanie eksploitów wykorzystujących luki w jego mechanizmach bezpieczeństwa. Jako, że ja
bardzo lubię zbroić swojego Debiana, to postanowiłem się przyjrzeć nieco bliżej temu całemu LKRG i
sprawdzić jego użyteczność. Trzeba jednak wiedzieć, że LKRG jest dostarczany w formie osobnego
modułu zamiast łaty na kernel, przez co trzeba będzie także postarać się o automatyzację pewnych
rzeczy, m.in. procesu budowania modułu przy aktualizacji kernela via DKMS.">
<meta itemprop="datePublished" content="2020-06-09T20:56:00+00:00" />
<meta itemprop="dateModified" content="2020-06-26T20:56:00+02:00" />
<meta itemprop="wordCount" content="3964">



<meta itemprop="keywords" content="debian,dkms,lkrg,kernel,moduły-kernela," />

		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Moduł LKRG (Linux Kernel Runtime Guard)"/>
<meta name="twitter:description" content="Jakiś czas temu opisywałem moduł TPE (Trusted Path Execution) dla kernela linux, który jest w
stanie dość znacznie poprawić bezpieczeństwo naszego systemu. Ostatnio jednak natknąłem się na
moduł LKRG (Linux Kernel Runtime Guard), którego to zadaniem jest stać na straży samego jądra
operacyjnego i chronić je w czasie rzeczywistym przed różnego rodzaju zagrożeniami poprzez
wykrywanie eksploitów wykorzystujących luki w jego mechanizmach bezpieczeństwa. Jako, że ja
bardzo lubię zbroić swojego Debiana, to postanowiłem się przyjrzeć nieco bliżej temu całemu LKRG i
sprawdzić jego użyteczność. Trzeba jednak wiedzieć, że LKRG jest dostarczany w formie osobnego
modułu zamiast łaty na kernel, przez co trzeba będzie także postarać się o automatyzację pewnych
rzeczy, m.in. procesu budowania modułu przy aktualizacji kernela via DKMS."/>

	<link rel="stylesheet" href="https://morfikov.github.io/css/bundle.css">
	<link rel="stylesheet" href="https://morfikov.github.io/css/custom.css">
	<link rel="icon" href="https://morfikov.github.io/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="https://morfikov.github.io/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="https://morfikov.github.io/manifest.json">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-119125303-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
	<header class="header">
	<a class="logo" href="https://morfikov.github.io/">Morfitronik</a>
	
<nav class="main-nav main-nav--right" role="navigation">
	<button id="toggle" class="main-nav__btn" aria-label="Menu toggle" aria-expanded="false" tabindex="0">
		<div class="main-nav__btn-box" tabindex="-1">
			<svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18">
				<path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/>
				<path class="icon-menu__x" d="M11.55 9L18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55 0 9 6.45 15.45 0 18 2.55 11.55 9z"/>
			</svg>
		</div>
	</button>
	<ul id="menu" class="main-nav__list">
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/categories/">
					
					<span class="main-nav__text">Kategorie</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/tags/">
					
					<span class="main-nav__text">Tagi</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/info-kontakt/">
					
					<span class="main-nav__text">Info/Kontakt</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/wsparcie/">
					
					<span class="main-nav__text">Wsparcie</span>
					
				</a>
			</li>
	</ul>
</nav>
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/">Home</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">Moduł LKRG (Linux Kernel Runtime Guard)</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2020-06-09T20:56:00Z">Opublikowano: 09/06/2020</time>
	<time class="entry__meta-lastmod meta-lastmod" datetime="2020-06-26T20:56:00&#43;02:00">Zaktualizowano: 26/06/2020</time>

<span class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Kategorie:
		<a class="meta-categories__link" href="https://morfikov.github.io/categories/linux/" rel="category">Linux</a>
	</span>
</span>
	</div>
				<h1 class="entry__title">Moduł LKRG (Linux Kernel Runtime Guard)</h1>
<details class="entry__toc toc" >
	<summary class="toc__title">Spis treści</summary>
	<nav id="TableOfContents">
  <ol>
    <li><a href="#moduł-lkrg">Moduł LKRG</a>
      <ol>
        <li><a href="#problemy-z-lkrg-na-kernel-57">Problemy z LKRG na kernel 5.7</a></li>
      </ol>
    </li>
    <li><a href="#konfiguracja-kernela-na-potrzeby-lkrg">Konfiguracja kernela na potrzeby LKRG</a></li>
    <li><a href="#konfiguracja-dkms-dla-modułu-lkrg">Konfiguracja DKMS dla modułu LKRG</a></li>
    <li><a href="#przygotowanie-paczki-deb-ze-źródłami-lkrg">Przygotowanie paczki .deb ze źródłami LKRG</a>
      <ol>
        <li><a href="#plik-debiansourceformat">Plik <code>debian/source/format</code></a></li>
        <li><a href="#plik-debianchangelog">Plik <code>debian/changelog</code></a></li>
        <li><a href="#plik-debiancontrol">Plik <code>debian/control</code></a></li>
        <li><a href="#plik-debiancopyright">Plik <code>debian/copyright</code></a></li>
        <li><a href="#plik-debianlkrg-dkmsdkms">Plik <code>debian/lkrg-dkms.dkms</code></a></li>
        <li><a href="#plik-debianlkrg-dkmsservice">Plik <code>debian/lkrg-dkms.service</code></a></li>
        <li><a href="#plik-debianrules">Plik <code>debian/rules</code></a></li>
        <li><a href="#plik-debianwatch">Plik <code>debian/watch</code></a></li>
        <li><a href="#plik-debianupstreamsigning-keyasc">Plik <code>debian/upstream/signing-key.asc</code></a>
          <ol>
            <li><a href="#budowanie-paczki-deb">Budowanie paczki .deb</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#instalacja-modułu-lkrg">Instalacja modułu LKRG</a></li>
    <li><a href="#ładowanie-modułu-lkrg-przy-starcie-systemu">Ładowanie modułu LKRG przy starcie systemu</a></li>
    <li><a href="#konfiguracja-modułu-lkrg">Konfiguracja modułu LKRG</a>
      <ol>
        <li><a href="#profilowanie-ustawień">Profilowanie ustawień</a></li>
      </ol>
    </li>
    <li><a href="#podsumowanie">Podsumowanie</a></li>
  </ol>
</nav>
</details>
				<div class="entry__content"><p>Jakiś czas temu opisywałem <a href="https://morfikov.github.io
/post/modul-tpe-trusted-path-execution-dla-kernela-linux/">moduł TPE</a> (Trusted Path Execution) dla kernela linux, który jest w
stanie dość znacznie poprawić bezpieczeństwo naszego systemu. Ostatnio jednak natknąłem się na
<a href="https://www.openwall.com/lkrg/">moduł LKRG</a> (Linux Kernel Runtime Guard), którego to zadaniem jest stać na straży samego jądra
operacyjnego i chronić je w czasie rzeczywistym przed różnego rodzaju zagrożeniami poprzez
wykrywanie eksploitów wykorzystujących luki w jego mechanizmach bezpieczeństwa. Jako, że ja
bardzo lubię zbroić swojego Debiana, to postanowiłem się przyjrzeć nieco bliżej temu całemu LKRG i
sprawdzić jego użyteczność. Trzeba jednak wiedzieć, że LKRG jest dostarczany w formie osobnego
modułu zamiast łaty na kernel, przez co trzeba będzie także postarać się o automatyzację pewnych
rzeczy, m.in. procesu budowania modułu przy aktualizacji kernela via DKMS.</p>
<h2 id="moduł-lkrg">Moduł LKRG</h2>
<p>Jak zostało już nadmienione we wstępie, LKRG jest dostępny jako osobny moduł dla kernela, a nie
jako patch na kernel. Ten fakt może odstraszyć część użytkowników, którzy kompilują wszystkie
niezbędne moduły kernela bezpośrednio w jądro, by uniknąć budowania zbędnej i często niebezpiecznej
funkcjonalności, np. opcji ładowania/wyładowania modułów podczas pracy systemu operacyjnego.
Dodatkowo, jeśli wykorzystujemy <a href="https://morfikov.github.io
/post/jak-dodac-wlasne-klucze-dla-secure-boot-do-firmware-efi-uefi-pod-linux/">mechanizm Secure Boot mając EFI/UEFI</a>, to trzeba będzie
poczynić drobne przygotowania, by ten dodatkowy moduł podpisać, gdyż w przeciwnym wypadku nie
zostanie on załadowany przez nasz OS. Na szczęście, jak to zwykle bywa w przypadku zewnętrznych
modułów, możemy zaprzęgnąć do pracy DKMS, w którym to możemy nieco <a href="https://morfikov.github.io
/post/automatyczne-podpisywanie-modulow-kernela-przez-dkms/">zautomatyzować sam proces
podpisywania modułów</a> przy ich instalacji w systemie. Zatem nie jest tak źle jak mogłoby się
wydawać, choć oczywiście mogłoby być trochę lepiej.</p>
<p><a href="https://bitbucket.org/Adam_pi3/lkrg-main/">Źródła modułu LKRG</a> są udostępnione na licencji GPL2 i można je pobrać przy pomocy <code>git</code> w
poniższy sposób:</p>
<pre><code>$ git clone https://bitbucket.org/Adam_pi3/lkrg-main.git lkrg
$ cd lkrg/
</code></pre>
<h3 id="problemy-z-lkrg-na-kernel-57">Problemy z LKRG na kernel 5.7</h3>
<p>Moduł LKRG bez problemu się budował na kernelu 5.6 i wcześniejszych ale począwszy od wersji 5.7 w
kernelu nastąpiły pewne zmiany, które uniemożliwiły budowanie aktualnej wersji LKRG (0.7) na tym
nowszym jądrze. Stosowne zmiany w źródłach LKRG zostały już poczynione by dostosować je do kernela
5.7 ale póki co te zmiany są jedynie w wersji git i dlatego jeśli korzystamy z tego nowszego
kernela, to musimy pobrać źródła bezpośrednio z repozytorium git.</p>
<p>Te pobrane źródła pakujemy przy pomocy <code>tar</code> i nazywamy <code>lkrg_0.7+git20200604.orig.tar.xz</code> , gdzie
ten numerek po <code>+git</code> odnosi się do daty ostatniego commit'a:</p>
<pre><code>$ tar --exclude='.git' --exclude='.gitignore' --exclude='.pc' --exclude='debian' -cf - ../lkrg  | xz -9 -c - &gt; ../lkrg_0.7+git20200604.orig.tar.xz
</code></pre>
<h2 id="konfiguracja-kernela-na-potrzeby-lkrg">Konfiguracja kernela na potrzeby LKRG</h2>
<p>By moduł LKRG nam się zbudował bez większych problemów, musimy upewnić się, że mamy odpowiednio
skonfigurowany kernel. Wymagane włączenie jest tych poniższych opcji:</p>
<pre><code>CONFIG_KPROBES
CONFIG_HAVE_KRETPROBES
CONFIG_MODULE_UNLOAD
CONFIG_KALLSYMS_ALL
CONFIG_JUMP_LABEL
CONFIG_STACKTRACE
</code></pre>
<h2 id="konfiguracja-dkms-dla-modułu-lkrg">Konfiguracja DKMS dla modułu LKRG</h2>
<p>Nic nie stoi na przeszkodzie by po pobraniu źródeł zbudować moduł przy pomocy <code>make</code> i zainstalować
go via <code>make install</code> ale lepszym rozwiązaniem jest <a href="https://morfikov.github.io
/post/dkms-czyli-automatycznie-budowane-moduly/">mechanizm DKMS</a>, który będzie nam ten moduł
budował automatycznie ilekroć tylko kernel będzie aktualizowany. Możemy również pójść o krok dalej
i <a href="https://morfikov.github.io
/post/poradnik-maintainera-czyli-jak-zrobic-pakiet-deb/">zrobić sobie paczkę .deb przy pomocy pbuilder</a>.</p>
<p>Poniżej znajduje się plik <code>dkms.conf</code> z konfiguracją dla DKMS:</p>
<pre><code>PACKAGE_NAME=&quot;lkrg&quot;
PACKAGE_VERSION=&quot;0.7&quot;
#BUILT_MODULE_LOCATION[0]=&quot;output&quot;
BUILT_MODULE_NAME[0]=&quot;p_lkrg&quot;
DEST_MODULE_LOCATION[0]=&quot;/updates/dkms&quot;
DEST_MODULE_NAME[0]=&quot;p_lkrg&quot;
REMAKE_INITRD=&quot;no&quot;
AUTOINSTALL=&quot;yes&quot;

MAKE[0]=&quot;make -C ${kernel_source_dir} M=${dkms_tree}/${PACKAGE_NAME}/${PACKAGE_VERSION}/build&quot;
CLEAN=&quot;make -C ${kernel_source_dir} M=${dkms_tree}/${PACKAGE_NAME}/${PACKAGE_VERSION}/build clean&quot;
</code></pre>
<p>Ta widoczna wyżej wykomentowana linijka odnosi się do katalogu, do którego moduł LKRG zostanie
skopiowany po skompilowaniu. Niemniej jednak, moduł po zbudowaniu będzie również siedział w
katalogu głównym i system DKMS bez problemu odnajdzie stosowny plik po nazwie. Można zatem
korzystać z <code>BUILT_MODULE_LOCATION</code> lub też pozostawić ją wykomentowaną.</p>
<h2 id="przygotowanie-paczki-deb-ze-źródłami-lkrg">Przygotowanie paczki .deb ze źródłami LKRG</h2>
<p>Jeśli zaś chcemy przygotować sobie paczkę <code>.deb</code> , która zainstaluje nam wszystkie niezbędne pliki
w odpowiednim miejscu, to potrzebna nam będzie dodatkowa konfiguracja dla <code>pbuilder</code> . Tworzymy
zatem katalog <code>debian/</code> w głównym katalogu ze źródłami LKRG, a w nim te poniższe pliki.</p>
<h3 id="plik-debiansourceformat">Plik <code>debian/source/format</code></h3>
<p>Standardowo w tym pliku umieszczamy poniższą linijkę:</p>
<pre><code>3.0 (quilt)
</code></pre>
<h3 id="plik-debianchangelog">Plik <code>debian/changelog</code></h3>
<p>Tutaj z kolei najważniejszą rolę odgrywa wersja, która znajduje się w nawiasie ( <code>0.7+git20200604</code> ,
bez <code>-1</code> ), oraz nazwa pakietu ( <code>lkrg</code> ). Te dwie wartości muszą pasować do nazwy paczki <code>tar.gz</code> ,
którą zrobiliśmy wcześniej:</p>
<pre><code>lkrg (0.7+git20200604-1) unstable; urgency=medium

  * Initial Release (Closes: #123456)

 -- Mikhail Morfikov &lt;morfik@nsa.com&gt;  Thu, 04 Jun 2020 23:06:27 +0200
</code></pre>
<h3 id="plik-debiancontrol">Plik <code>debian/control</code></h3>
<p>W tym pliku określamy wszystko to, co tyczy się procesu budowania paczki <code>.deb</code> :</p>
<pre><code>Source: lkrg
Section: kernel
Priority: optional
Maintainer: Mikhail Morfikov &lt;morfik@nsa.com&gt;
Homepage: https://www.openwall.com/lkrg/
Vcs-Browser: https://bitbucket.org/Adam_pi3/lkrg-main
Vcs-Git: https://bitbucket.org/Adam_pi3/lkrg-main.git
Standards-Version: 4.5.0
Rules-Requires-Root: no
Build-Depends: debhelper (&gt;= 13), debhelper-compat (= 13),
 dkms

Package: lkrg-dkms
Architecture: all
Depends: ${shlibs:Depends}, ${misc:Depends},
 dkms
Description: Linux Kernel Runtime Guard (LKRG) Source Code and DKMS
 Linux Kernel Runtime Integrity Checking and Exploit Detection.
 .
 LKRG provides security through diversity.
 Similar to running an uncommon operating system (kernel) would.
 .
 This package uses DKMS to automatically build the LKRG kernel
 module.
</code></pre>
<h3 id="plik-debiancopyright">Plik <code>debian/copyright</code></h3>
<p>Tutaj z kolei określamy wszystkie rzeczy związane z prawami autorskimi i licencjami do plików
projektu:</p>
<pre><code>Format: https://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: lkrg
Upstream-Contact: pi3ki31ny &lt;pi3@itsec.pl&gt;
Source: https://www.openwall.com/lkrg/

Files: *
Copyright: 2018-2020 Adam 'pi3' Zabrocki
License: GPL-2.0

Files: debian/*
Copyright: 2020 Mikhail Morfikov &lt;morfik@nsa.com&gt;
License: GPL-2.0

License: GPL-2.0
 This package is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; either version 2 of the License, or
 (at your option) any later version.
 .
 This package is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 .
 You should have received a copy of the GNU General Public License
 along with this program. If not, see &lt;http://www.gnu.org/licenses/&gt;
 .
 On Debian systems, the complete text of the GNU General
 Public License version 2 can be found in &quot;/usr/share/common-licenses/GPL-2&quot;.
</code></pre>
<h3 id="plik-debianlkrg-dkmsdkms">Plik <code>debian/lkrg-dkms.dkms</code></h3>
<p>W tym pliku definiujemy konfigurację dla mechanizmu DKMS. W <code>PACKAGE_VERSION</code> nie określamy jako
takiej wersji modułu tylko <code>&quot;#MODULE_VERSION#&quot;</code> , by system budowania pakietu <code>.deb</code> bez problemu
uzupełniał nam wersję bez angażowania nas w ten proces:</p>
<pre><code>PACKAGE_NAME=&quot;lkrg&quot;
PACKAGE_VERSION=&quot;#MODULE_VERSION#&quot;
#BUILT_MODULE_LOCATION[0]=&quot;output&quot;
BUILT_MODULE_NAME[0]=&quot;p_lkrg&quot;
DEST_MODULE_LOCATION[0]=&quot;/updates/dkms&quot;
DEST_MODULE_NAME[0]=&quot;p_lkrg&quot;
REMAKE_INITRD=&quot;no&quot;
AUTOINSTALL=&quot;yes&quot;

MAKE[0]=&quot;make -C ${kernel_source_dir} M=${dkms_tree}/${PACKAGE_NAME}/${PACKAGE_VERSION}/build&quot;
CLEAN=&quot;make -C ${kernel_source_dir} M=${dkms_tree}/${PACKAGE_NAME}/${PACKAGE_VERSION}/build clean&quot;
</code></pre>
<h3 id="plik-debianlkrg-dkmsservice">Plik <code>debian/lkrg-dkms.service</code></h3>
<p>Projekt LKRG dostarcza usługę dla systemd, która ma na celu ładowanie i wyładowanie modułu. Jeśli
nas interesuje ta usługa to możemy ten plik sobie stworzyć, choć moim zdaniem lepszym rozwiązaniem
jest ładować moduł via plik <code>/etc/modules</code> . Tak czy inaczej poniżej znajduje się plik usługi dla
systemd:</p>
<pre><code>[Unit]
Description=Linux Kernel Runtime Guard
Documentation=https://bitbucket.org/Adam_pi3/lkrg-main/src/master/README
DefaultDependencies=no
After=systemd-modules-load.service
Before=systemd-sysctl.service
Before=sysinit.target shutdown.target
Conflicts=shutdown.target
ConditionKernelCommandLine=!nolkrg

[Service]
Type=oneshot
ExecStart=/sbin/modprobe -v p_lkrg
#ExecStop=/sbin/modprobe -v -r p_lkrg
RemainAfterExit=yes

[Install]
WantedBy=sysinit.target
</code></pre>
<h3 id="plik-debianrules">Plik <code>debian/rules</code></h3>
<p>W tym pliku określamy to, co tak naprawdę ma się znaleźć w wynikowej paczce, jak ją zbudować i
jakie akcje będą przeprowadzane przy instalacji (czy usuwaniu) jej w docelowym systemie. W tym
przypadku samej kompilacji jako takiej nie będzie, jedynie przenosimy pliki w odpowiednie miejsca
oraz instalujemy usługę dla systemd w trybie wyłączonym (bez jej aktywacji):</p>
<pre><code>#!/usr/bin/make -f

export DH_VERBOSE=1
export DH_OPTIONS = -v
export DEB_BUILD_MAINT_OPTIONS = hardening=+all
DPKG_EXPORT_BUILDFLAGS = 1
include /usr/share/dpkg/buildflags.mk
include /usr/share/dpkg/pkg-info.mk

%:
    dh $@ --with dkms

override_dh_install:
    dh_install -p lkrg-dkms scripts/ usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)
    dh_install -p lkrg-dkms src/ usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)
    dh_install -p lkrg-dkms Makefile usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)

override_dh_dkms:
    dh_dkms -V $(DEB_VERSION_UPSTREAM)

override_dh_auto_configure:
override_dh_auto_build:
override_dh_auto_test:
override_dh_auto_install:
override_dh_auto_clean:

override_dh_installsystemd:
    dh_installsystemd --no-enable --no-stop-on-upgrade

override_dh_missing:
    dh_missing --list-missing --fail-missing
</code></pre>
<h3 id="plik-debianwatch">Plik <code>debian/watch</code></h3>
<p>Ten plik ma za zadanie umożliwić pobranie nowszej wersji projektu, gdyby się takowa pojawiła, za
sprawą narzędzia <code>uscan</code> . Dodatkowo, jako że projekt LKRG podpisuje cyfrowo swoje paczki ze
źródłami, to będzie ten podpis automatycznie sprawdzamy i weryfikowany:</p>
<pre><code>version=4
opts=pgpsigurlmangle=s/$/.sign/ https://www.openwall.com/lkrg/lkrg-(.+).tar.gz
</code></pre>
<h3 id="plik-debianupstreamsigning-keyasc">Plik <code>debian/upstream/signing-key.asc</code></h3>
<p>By proces weryfikacji podpisu mógł mieć miejsce, potrzebny nam jest klucz publiczny by zweryfikować
sygnaturę dołączoną do paczki <code>tar.gz</code> . Ten klucz publiczny możemy albo dodać ręcznie:</p>
<pre><code>-----BEGIN PGP PUBLIC KEY BLOCK-----

mQINBFoQgb0BEAC+DksApeHsB/nZYwbmXzoWCYCGZvzRzoXVVJOqYTZbumYqlgWv
pieSSIuHUfbpeAaDjchlJWy3w0xkPW+TP63XTLnwViATsTJtdkACHfT8P792Tfrn
XhYer3c/N3tSWwFTN+wLZF3OpH4XdOfXaFxRIvVWxych/WHmcteVinCjeXZvAwLg
ZbYnADLW/db8CK+kfXFiuGssmrYKkJcTqNhIi05EkQhatwtmgHPMqxyIPHdnlU+q
/0uN4J+XQvkzbUXVjuEqwvbRlOHNDgb6Q9j+tMULefBFb7FGvanw0fgjV0rWtvHy
sY3r9GGxrwAt1GP/TLAPkuL2EVRVtsOmpjTFxj5GgTn6NngpDB4YMsuQB+zCLlPe
yPuwlFvQ6Hk+2GlVG/FtSVwIYmWkFNUyvrQg/l9gLZGAv3Lo/csTUka+9IH6rLXZ
tnL5LiUd/zQexV2jmwenaxQOjaoPGuwzyo+rJjGrL7xF3O4b5Rkk9TnUG27zR7Vl
MwZ4nyQNyabLWmJAFjWeHoQfbRv6ma9iKAZiwprGv+AIccB6psX5o2HLjMqX0uCC
WnWqpZa+vAsDfx1XaXdS5gp9I8ZNKgnZUtys1OswCkx2nHhA1f995jcSkJanEztY
uTDXGbC+Arh+i43KtbfVtGygfFwvIOnE+JuJgOaE4TuJHfiVX343ANIrbQARAQAB
tBxPcGVud2FsbCBvZmZsaW5lIHNpZ25pbmcga2V5iQI4BBMBAgAiBQJaEIG9AhsD
BgsJCAcDAgYVCAIJCgsEFgIDAQIeAQIXgAAKCRAFwCf9S9wTbutbD/wP+Wpp2RzP
zhUtVeAeTAbwuZUBVXMvuqnxCoAaUGTr3SKTGe2bLjjSvy1T5Zh+I6wCA5sy7AX7
LRwgG3frn4Gt+6D4tIbx5xjxx4bJiR5gn33MKl+8DelkB3feS0TLsWoDnrkKnTSk
vEEi8sYi3obdkZRCEE+LdDs3xiy2bC0WYRYKe8CGyKQQRNh6B2eq9IK4saCPCmaZ
9OgoW6DVvkC4qHGVlvhHews9XRXm7xnJ3awh1ru1pKDNedygk8klYGWc+AXkLppG
eMQ/sVv2rQXCU8ADrr+jGW4Goiki5YJqNCul1gijThTppL+BazZV0FWEyj0X8eXE
wR+mgwa+4Q+6v+75S67kkQcFUw8GH8NKcU/LRjslFf4aDIDnu6Yy4L8bKsDENjPj
g3zMHi53Ts8FMNLfepUpAtBLzqnZOm9ylU+PrmJ5GkMC5Ka9N/Rg8yRsRI/XuOzb
Kj//721XN9M+JbjZ5bfI0TxLk0TJhCSFjHpbuPYfUl4kjpx4kZlMPuyzbkQxRWGN
b1hnMfnfdCFGnJa9kVil8YQ+hmPi5RIHVD24yD86Rc1tLSZR2HNes8Ly2dhdnaKR
SFrNzLAhfZ5XldJbwsNKysNVED1cx6t6sYYj8LsZSETcp7LWONNxvA/2MwsbFet4
YvDolumaqLr46KOQjSIB0AY62RoWq3hv0bkCDQRaEIG9ARAAtyk4JFIRkP1vyADr
xoAZK9OzwhYdhPON21bJK4ppq2Jm7m/yhhoLHUMJ22jNSq/wq0MUJXL8U8zcN0E6
jDyucdo+4IBPuGZl4cdIuN53qMTzy9WOC7SNTQMeXIflAqVYRPHJILomwB2sYYoe
84zpKyP/U6skdpISgYYobfzR9G1CbXzefVOHi3b7y7HmCHy/oGMpIf5iTwOQYxCz
OqOd2lTGGbIZ1oaPF4PuQT+OiGsMidgwz+odRzyjtLeoIBtxgtEJ8VeHl/Z7Nh5u
EQkrPd0Q10A63hlaLiB3+OizEzbuNYJUS4JydWe6pVNExNP4CyyU6evOskUeTyU/
jSfHNZ5JCiolOcyio6g/lFVBlqsATt9LM6qyPSUGdg55xRjCmTQzoVAAuhHiWXSY
Xv3Lg5q5KHqN978eX5of/hRTmwExoG+J6L7OPOCLCivDybjGNljoQwIYgt6gDMtW
q/dqs8KvySBliWTeaN+sjwVwUQVjujtB7hYrVzRvpCM8mK2aGAbOCnInMo0FSG5C
ZwsMrZvZGIszyj9HhnYkTRtPRWtBDBkiNxBcEEkRUlDF2rTy/FY9aQ4WfjdkhHEq
Yo2fW669wWUJzA8fqcMerfnqjzA8O4kw+DBy3LE2RjlOT7Irm4ij1p3ZO78hXbsW
7FBp8Tcf+HtTAC856glDglSaxEUAEQEAAYkCHwQYAQIACQUCWhCBvQIbDAAKCRAF
wCf9S9wTbka5D/9g3Y3vt4o9Sh9jDSaVpuJFSPJ1GK7faycsgDDs+y5RlI/zis7J
UGOXg2WoqiFb2nEc2wEy2P4Pl0/ROjfPQEOH16jOWur+GFhSxrrMaVhnSP1UJsih
Pp9wCCRRJVrI6mNy2zHHQlJw/JYxUDnyhNwVYs6q4J27vifqhQTcgS6SGE2xowdK
y44FRtyCpXeNUomWMyY7RRfDD4O2FQ5raZaaAD1ym4G3hwZ1593WdjaI9qKrW9ho
40I0yVM1i1Yic7sUjroaLwKEFBr+JzOJYUbp3TMHvjNqbnsOaJlAsKPECExqc1GK
07NmlZugVAaQ5d6JJEo7NxY5PJglbDHGXEuC19geNSQTZWak9/tBR5yYTReLZVBf
jhb+CUIsPnkDEjL/XgzXCJp9pPHXrcpudEu2xLbf5opvWDiDCCW5xUMfKIf9l3pA
TC/1xFDEf/LPuXZYDDjZZP5speb3gGVqYteMNJpmetJoJ3LOdXN8Uchk5nTfsfmh
Wo2nuFp6FyqeRQNTbuSCGyJmXSuX62q5LksgVzTd3OgOCHjsjzEbVU58+TX7Z/V2
+iBqlnWwg/W+/bRWAvbUsEEhhN0TDFsHEIkYrkKN3iKn6oeI75hVKxZJWH3EVX/Y
uadXcCs/e77lKhuFz3jofL4/VGTumzkCN1C44iChUlJZPDme3LmQEFWqDw==
=kkUp
-----END PGP PUBLIC KEY BLOCK-----
</code></pre>
<p>Albo też możemy w terminalu wpisać poniższe polecenie (trzeba pierw uprzednio pozyskać klucz
<code>0x05C027FD4BDC136E</code> ):</p>
<pre><code>$ gpg --armor --export-options export-minimal --export 0x05C027FD4BDC136E &gt;&gt; debian/upstream/signing-key.asc
</code></pre>
<h4 id="budowanie-paczki-deb">Budowanie paczki .deb</h4>
<p>Mając już przygotowany katalog <code>debian/</code> możemy zbudować paczkę <code>.deb</code> w poniższy sposób:</p>
<pre><code>$ debuild -S -sa -d -i --lintian-opts --profile debian
$ sudo pbuilder --build ../lkrg_0.7+git20200604-1.dsc
</code></pre>
<p>Zbudowanie paczki zajmie dosłownie chwilę jako, że nie będzie tutaj żadnego procesu kompilacji
źródeł. Z chwilą, gdy budowa paczki dobiegnie końca, to w katalogu wynikowym <code>pbuiler</code>'a powinno
pojawić się kilka plików, z których jeden ma rozszerzenie <code>.deb</code> i to ten plik właśnie musimy
zainstalować w swoim systemie via <code>dpkg</code> . Oczywiście dobrze jest sobie <a href="https://morfikov.github.io
/post/tworzenie-repozytorium-przy-pomocy-reprepro/">przygotować też lokalne
repozytorium dla APT</a> na tego typu pakiety, tak by mieć je wszystkie w jednym miejscu do
wygodnej instalacji w systemie za sprawą <code>apt-get</code>/<code>aptitude</code> .</p>
<h2 id="instalacja-modułu-lkrg">Instalacja modułu LKRG</h2>
<p>Podczas instalacji pakietu <code>lkrg-dkms</code> zostanie zainicjowany DKMS i moduł LKRG zostanie
automatycznie zbudowany dla aktualnie załadowanego w pamięci operacyjnej kernela. Skompilowany plik
zaś zostanie umieszczony w odpowiednim katalogu z modułami kernela:</p>
<pre><code># aptitude install lkrg-dkms
The following NEW packages will be installed:
  lkrg-dkms
0 packages upgraded, 1 newly installed, 0 to remove and 3 not upgraded.
Need to get 0 B/85.4 kB of archives. After unpacking 872 kB will be used.
Get: 1 file:/media/Kabi/repozytorium/debian sid/main amd64 lkrg-dkms all 0.7+git20200604-1 [85.4 kB]
Retrieving bug reports... Done
Parsing Found/Fixed information... Done
Selecting previously unselected package lkrg-dkms.
(Reading database ... 225996 files and directories currently installed.)
Preparing to unpack .../lkrg-dkms_0.7+git20200604-1_all.deb ...
Unpacking lkrg-dkms (0.7+git20200604-1) ...
Setting up lkrg-dkms (0.7+git20200604-1) ...
Loading new lkrg-0.7+git20200604 DKMS files...
Building for 5.7.0-amd64
Building initial module for 5.7.0-amd64
Done.

p_lkrg.ko:
Running module version sanity check.
 - Original module
   - No original module exists within this kernel
 - Installation
   - Installing to /lib/modules/5.7.0-amd64/updates/dkms/

do_depmod 5.7.0-amd64


DKMS: install completed.
lkrg-dkms.service is a disabled or a static unit, not starting it.

Current status: 0 (+0) broken, 3 (+0) upgradable, 16302 (+0) new.
</code></pre>
<p>Jak widać, również usługa dla systemd została zainstalowana ale nie została ona aktywowana.</p>
<p>Sprawdźmy jeszcze jak moduł jest widziany przez nasz system:</p>
<pre><code># modinfo p_lkrg
filename:       /lib/modules/5.7.0-amd64/updates/dkms/p_lkrg.ko
license:        GPL v2
description:    pi3's Linux kernel Runtime Guard
author:         Adam 'pi3' Zabrocki (http://pi3.com.pl)
srcversion:     B1DF6F54F2541DEC0B0408B
depends:
retpoline:      Y
name:           p_lkrg
vermagic:       5.7.0-amd64 SMP preempt mod_unload modversions RANDSTRUCT_PLUGIN_fb4bb4f688474f3bb721a6ba02f1a3c2d66b2c1ebb8b8f7574514f2a33a6eb05
sig_id:         PKCS#7
signer:         morfikov's kernel-signing key
sig_key:        41:72:D5:0F:5C:43:2C:B4:D7:90:E7:6C:9D:07:74:7F:57:C6:7F:C7
sig_hashalgo:   sha512
signature:      39:BE:F0:CB:24:6C:C7:B6:D9:F7:C5:4E:A2:F0:89:BF:54:66:C6:E3:
                C7:3D:D9:B6:3B:49:29:95:69:8B:44:B8:8E:2A:35:BF:CD:50:4C:6F:
                B7:7A:2E:A6:B1:A0:2B:E5:80:96:B2:4C:F2:16:1F:1F:30:BF:0E:79:
                0F:D9:B2:31:D0:6F:A9:4F:8E:9E:81:1F:8D:44:07:C4:DC:4B:43:2A:
                A6:10:D7:B7:01:CE:BD:EA:E4:79:39:CE:C6:3F:B6:E5:43:0E:95:55:
                71:94:87:C2:9E:4E:66:CC:41:0F:E5:F5:12:56:7E:6B:A7:E3:DA:09:
                5B:6D:40:D8:CB:F0:C2:7B:CF:BC:E0:71:25:A3:09:4D:B0:AC:CF:8B:
                8C:33:06:EC:63:0D:1C:B5:8B:A9:62:BF:D0:92:7C:5B:E7:D1:47:14:
                85:17:EB:1A:52:81:20:79:9C:05:A7:5A:AC:08:68:22:34:1C:47:69:
                F0:C2:CE:90:EB:A3:F9:81:9D:AE:F2:D2:C2:84:4B:7E:D5:5E:FB:B2:
                95:05:1B:D4:30:9B:68:2A:6B:C6:A2:73:3D:1B:9A:16:2B:40:11:98:
                A5:D4:07:7C:A9:EC:A6:05:C1:6B:C0:45:BF:98:97:59:3B:6C:60:1A:
                94:3C:E0:E2:1F:30:5E:1F:6A:2C:80:3A:83:D5:58:0D
parm:           log_level:log_level [3 (warn) is default] (uint)
parm:           heartbeat:heartbeat [0 (don't print) is default] (uint)
parm:           block_modules:block_modules [0 (don't block) is default] (uint)
parm:           interval:interval [15 seconds is default] (uint)
parm:           kint_validate:kint_validate [3 (periodically + random events) is default] (uint)
parm:           kint_enforce:kint_enforce [2 (panic) is default] (uint)
parm:           msr_validate:msr_validate [1 (enabled) is default] (uint)
parm:           pint_validate:pint_validate [2 (current + waking_up) is default] (uint)
parm:           pint_enforce:pint_enforce [1 (kill task) is default] (uint)
parm:           umh_validate:umh_validate [1 (whitelist UMH paths) is default] (uint)
parm:           umh_enforce:umh_enforce [1 (prevent execution) is default] (uint)
parm:           pcfi_validate:pcfi_validate [2 (fully enabled pCFI) is default] (uint)
parm:           pcfi_enforce:pcfi_enforce [1 (kill task) is default] (uint)
parm:           smep_validate:smep_validate [1 (enabled) is default] (uint)
parm:           smep_enforce:smep_enforce [2 (panic) is default] (uint)
parm:           smap_validate:smap_validate [1 (enabled) is default] (uint)
parm:           smap_enforce:smap_enforce [2 (panic) is default] (uint)
</code></pre>
<p>Tak zainstalowany moduł trzeba jeszcze załadować. Możemy to zrobić ręcznie przy pomocy <code>modprobe</code> ,
by sprawdzić czy wszystko działa jak należy:</p>
<pre><code>kernel: [p_lkrg] Loading LKRG...
kernel: [p_lkrg] System does NOT support SMAP. LKRG can't enforce SMAP validation :(
kernel: Freezing user space processes ... (elapsed 0.023 seconds) done.
kernel: OOM killer disabled.
kernel: [p_lkrg] 8/23 UMH paths were whitelisted...
kernel: [p_lkrg] LKRG initialized successfully!
kernel: OOM killer enabled.
kernel: Restarting tasks ... done.
</code></pre>
<p>Informacja <code>LKRG initialized successfully!</code> oznajmia nam jasno, że inicjacja modułu została
zakończona powodzeniem, zatem wszytko działa jak należy.</p>
<h2 id="ładowanie-modułu-lkrg-przy-starcie-systemu">Ładowanie modułu LKRG przy starcie systemu</h2>
<p>Moduły kernela mają to do siebie, że zwykle są ładowane podczas startu systemu lub w późniejszym
czasie jego pracy, gdy są potrzebne. O załadowanie modułu LKRG musimy się zatroszczyć jednak sami i
po to była ta usługa systemd, która miała za zadanie załadować ten moduł wcześnie podczas startu
systemu. Jeśli z jakiegoś powodu nie chcemy korzystać z usługi systemd, to zawsze możemy dodać
nazwę modułu do pliku <code>/etc/modules</code> lub też stworzyć osobny plik w katalogu <code>/etc/modules-load.d/</code>
o poniższej treści:</p>
<pre><code>p_lkrg
</code></pre>
<p>Z chwilą, gdy moduł LKRG zostanie załadowany w systemie, to żadna <a href="https://en.wikipedia.org/wiki/Code_segment">sekcja .text</a> <a href="https://openwall.info/wiki/p_lkrg/Main#Caveats1">nie będzie
już mogła zostać zmodyfikowana</a>. Niemniej jednak, cześć modułów kernela wykorzystuje interfejs
<code>kprobes</code> , który wstrzykuje instrukcję 0xCC do monitorowanej przez LKRG funkcji. Dlatego też
ważnym jest, by wszystkie moduły korzystające z <code>kprobes</code> zostały załadowane zanim moduł LKRG
zostanie aktywowany.</p>
<p>Warto dodać w tym miejscu, że usługa systemd zawiera warunek <code>ConditionKernelCommandLine=!nolkrg</code> ,
który to nakazuje załadować moduł LKRG jedynie w przypadku, gdy linijka kernela w konfiguracji
bootloader'a nie zawiera parametru <code>nolkrg</code> . W ten sposób jeśli system nie będzie chciał nam z
jakiegoś powodu wystartować, to zawsze możemy dopisać ten parametr w linijce kernela, przez co
systemd nie załaduje tej usługi na starcie systemu.</p>
<h2 id="konfiguracja-modułu-lkrg">Konfiguracja modułu LKRG</h2>
<p>Zachowanie LKRG można kontrolować zmieniając opcje modułu przy ładowaniu go w systemie, lub też
przepisując wartości parametrów <code>sysctl</code> .  Póki co dokumentacja LKRG jest dostosowana do wersji
0.7, która wyszła już jakiś czas temu, a od tego momentu trochę zmian w projekcie zaszło i ta
dokumentacja jest ździebko nieaktualna. Niedługo zostanie wypuszczona wersja 0.8 i ten <a href="https://www.openwall.com/lists/lkrg-users/2020/06/08/2">problem
zostanie zaadresowany</a>. Podpierając się jednak <a href="https://bitbucket.org/Adam_pi3/lkrg-main/commits/2febcf467d6182e9bd180334e2601c79812f2cf5">tym commit'em</a>, <a href="https://bitbucket.org/Adam_pi3/lkrg-main/src/master/README">plikiem README</a> na
git oraz <a href="https://www.openwall.com/lists/lkrg-users/2020/06/09/3">komentarzem autora</a>, udało mi się opisać wszystkie parametry, które są dostępne w
<code>sysctl</code> .</p>
<ul>
<li><code>lkrg.block_modules</code> -- blokuje możliwość ładowania modułów przez kernel w przypadku, gdy ustawi
się tutaj wartość &quot;1&quot;. Ten parametr jest podobny do <code>modules_disabled</code> ,
z tą różnicą, że nie wspiera blokowania wyładowania modułów oraz można
przepisać jego wartość z &quot;1&quot; na &quot;0&quot; bez potrzeby restartu maszyny.
(Domyślnie: &quot;0&quot;)</li>
<li><code>lkrg.heartbeat</code>     -- jeśli ustawiony na &quot;1&quot;, określa czy wypisywać co jakiś czas w logu
systemowym wiadomość &quot;System is clean!&quot;. (Domyślnie: &quot;0&quot;)</li>
<li><code>lkrg.interval</code>      -- kontroluje jak często zegar kernela, który woła funkcje sprawdzające
integralność systemu, będzie uruchamiany. Nie można tutaj ustawić mniej
niż 5 sekund, by nie zjadać zbyt wielu zasobów systemowych oraz nie
można ustawić więcej niż 1800s (pół godziny). (Domyślnie: &quot;15&quot;)</li>
<li><code>lkrg.log_level</code>     -- ten parametr może przyjąć wartość z zakresu &quot;0-4&quot; (lub &quot;0-6&quot; jeśli
debugowanie zostało użyte). Jeśli mamy problemy z LKRG, to te logi mogą
się okazać bardzo pomocne w namierzeniu przyczyny. (Domyślnie: &quot;3&quot;)</li>
<li><code>lkrg.hide</code>          -- ma za zadanie ździebko zamaskować wykorzystanie LKRG przez ukrycie go na
liście modułów (w <code>lsmod</code>). Niemniej jednak, trzeba liczyć się z faktem,
że LKRG może zostać wykryty za sprawą interfejsu <code>/sys</code> lub <code>/proc</code>
(przykładowo obecność katalogu <code>/proc/sys/lkrg/</code>), co może w przyszłości
zostanie zaadresowane. (Domyślnie: &quot;0&quot;)</li>
<li><code>lkrg.kint_validate</code> -- kontroluje weryfikację integralności kernela/systemu. Określenie
wartości &quot;0&quot; wyłącza sprawdzenie integralności. Można także określić &quot;1&quot;
i w takim przypadku sprawdzenie integralności odbywać się będzie tylko
na wyraźne żądanie (przez <code>sysctl -w lkrg.trigger=1</code>). Jest też do
określenia wartość &quot;2&quot;, gdzie sprawdzenie integralności odbywać się
będzie co pewien ustalony interwał czasu zależny od <code>lkrg.interval</code>
(domyślnie co 15s). W przypadku &quot;3&quot; sprawdzenie integralności dokonywane
będzie na tej samej zasadzie co w przypadku &quot;2&quot; z tą różnicą, że
dodatkowo będzie ono odbywać się przy [różnych zdarzeniach systemowych]
<a href="https://openwall.info/wiki/p_lkrg/Main#When-is-the-LKRG-validation-routine-executed">17</a>, np. podłączanie urządzeń, zarządzanie energia, zdarzenia sieciowe,
itp. (Domyślnie: &quot;3&quot;)</li>
<li><code>lkrg.kint_enforce</code>  -- określa co zrobić w sytuacji, gdy sprawdzenie integralności kernela się
nie powiedzie. Możemy tutaj określić wartość &quot;0&quot;, gdzie system zaloguje
ostrzeżenie tylko jeden raz i będzie kontynuował swoją pracę tak jak
to do tej pory robił. W przypadku podania &quot;1&quot; system również wypisze
stosowny komunikat w logu z tą różnicą, że za każdym razem, gdy
sprawdzenie integralności się nie powiedzie (te komunikaty mogą dość
mocno zaspamować log). Natomiast w przypadku ustawienia &quot;2&quot; kernel
spanikuje i dalsza praca systemu nie będzie już możliwa. (Domyślnie:
&quot;2&quot;)</li>
<li><code>lkrg.pint_validate</code> -- kontroluje logikę weryfikacji procesów. W przypadku ustawienia &quot;0&quot;
sprawdzanie procesów zostanie wyłączone. W przypadku &quot;1&quot; będą
weryfikowane tylko te procesy, które aktualnie są wykonywane. Można
także tutaj określić &quot;2&quot;, gdzie poza aktualnie wykonywanymi procesami
sprawdzane będą także te procesy mające stan RUNNING. No i jest jeszcze
wartość &quot;3&quot;, która weryfikuje wszystkie procesy w systemie bez względu
na ich stan (tryb dla paranoików). (Domyślnie: &quot;2&quot;)</li>
<li><code>lkrg.pint_enforce</code>  -- kontroluje zachowanie LKRG w przypadku, gdy kontrola integralności
procesów się nie powiedzie. W przypadku określenia wartości &quot;0&quot;
zostanie wypisany tylko komunikat ostrzegawczy i system będzie
kontynuował dalej swoją pracę. W przypadku ustawienia &quot;1&quot; zostanie
ubity proces, który nie przeszedł pomyślnie weryfikacji. Można też
określić wartość &quot;2&quot; i w takiej sytuacji, gdy jakiś proces nie
przejdzie weryfikacji, to kernel spanikuje. (Domyślnie: &quot;1&quot;)</li>
<li><code>lkrg.msr_validate</code>  -- włącza weryfikację rejestrów MSR (Model-Specific Register) w procesorach
o architekturach x86 i x86-64. Czasami bywają jednak sytuacje, w
których taka weryfikacja MSR jest niepożądana, np. gdy LKRG działa na
hoście, który zarządza maszynami wirtualnymi. W takim przypadku, host
może dynamicznie przekonfigurować część rejestrów MSR, które LKRG
weryfikuje. Ustawienie tutaj wartości &quot;0&quot; wyłączy weryfikację MSR,
natomiast wartość &quot;1&quot; tę weryfikację włącza. (Domyślnie: &quot;1&quot;)</li>
<li><code>lkrg.trigger</code>       -- ma na celu manualne zainicjowanie sprawdzenia integralności systemu
przez ustawienie tutaj &quot;1&quot;. Ta wartość automatycznie zostanie
przepisana na &quot;0&quot; po przeprowadzeniu całego procesu. (Domyślnie: &quot;0&quot;)</li>
<li><code>lkrg.smep_validate</code> -- kontroluje weryfikację SMEP (Supervisor Mode Execution Prevention). By
ten mechanizm włączyć trzeba tutaj ustawić &quot;1&quot;, a by wyłączyć &quot;0&quot;.
(Default: &quot;1&quot;)</li>
<li><code>lkrg.smep_enforce</code>  -- kontroluje zachowanie LKRG w przypadku, gdy weryfikacja SMEP nie
zakończy się powodzeniem. W przypadku wartości &quot;0&quot; zostanie wypisany w
logu komunikat ostrzegawczy, a praca systemu nie zostanie w żaden
sposób przerwana. W przypadku ustawienia &quot;1&quot; zostanie wypisany
komunikat ostrzegawczy, a stan SMEP zostanie odtworzony do tego sprzed
dokonania modyfikacji. Zaś w przypadku ustawienia &quot;2&quot; kernel spanikuje.
(Domyślnie: &quot;2&quot;)</li>
<li><code>lkrg.smap_validate</code> -- podobny do <code>lkrg.smep_validate</code>, z tą różnicą, że odnosi się do SMAP
(Supervisor Mode Access Prevention). (Domyślnie: &quot;0&quot;)</li>
<li><code>lkrg.smap_enforce</code>  -- podobny do <code>lkrg.smep_enforce</code>, z tą różnicą, że odnosi się do SMAP.
(Domyślnie: &quot;0&quot;)</li>
<li><code>lkrg.umh_validate</code>  -- kontroluje weryfikację <a href="https://kernelnewbies.org/KernelProjects/usermode-helper-enhancements">UMH</a> (the kernel UserMode Helper). Wartość
&quot;0&quot; wyłącza weryfikację UMH. Z kolei wartość &quot;1&quot; zezwala UMH na
wykonanie binarek tylko z białej listy. Jest jeszcze wartość &quot;2&quot;,
której ustawienie całkowicie blokuje UMH. (Domyślnie: &quot;1&quot;)</li>
<li><code>lkrg.umh_enforce</code>   -- kontroluje zachowanie LKRG w przypadku, gdy weryfikacja UMH nie zakończy
się powodzeniem. W przypadku ustawienia &quot;0&quot; zostanie wypisany jedynie
komunikat ostrzegawczy. W przypadku &quot;1&quot; wykonanie pliku binarnego
zostanie zabronione, a w przypadku &quot;2&quot; kernel spanikuje. (Domyślnie:
&quot;1&quot;)</li>
<li><code>lkrg.pcfi_validate</code> -- kontroluje weryfikację pCFI (<a href="http://blog.pi3.com.pl/?cat=7">poor's man CFI</a>, <a href="https://lwn.net/Articles/810077/">Control-Flow
Integrity</a>). Wartość &quot;0&quot; wyłącza weryfikację. Wartość &quot;1&quot; włącza
słaby pCFI (weak pCFI), gdzie weryfikowany jest wskaźnik stosu (stack
pointer) oraz strona stosu (stack page) ale bez stackwalk, przez co
LKRG ma szanse na wykrycie jedynie ataków ROP (Return Oriented
Programming). Zaś wartość &quot;2&quot; włącza pełną weryfikację pCFI.
(Domyślnie: &quot;2&quot;)</li>
<li><code>lkrg.pcfi_enforce</code>  -- kontroluje zachowanie LKRG w przypadku, gdy weryfikacja pCFI nie
zakończy się powodzeniem. W przypadku ustawienia wartości &quot;0&quot; zostanie
zalogowane jedynie ostrzeżenie w logu systemowym. W przypadku wartości
&quot;1&quot; zostanie zabity proces, który nie przeszedł weryfikacji. W
przypadku wartości &quot;2&quot; kernel spanikuje. (Domyślnie: &quot;1&quot;)</li>
</ul>
<h3 id="profilowanie-ustawień">Profilowanie ustawień</h3>
<p>Stosunkowo niedawno też <a href="https://bitbucket.org/Adam_pi3/lkrg-main/commits/11da921d4196741b69f5156a9fd01be980141cb4">pojawiła się możliwość profilowania ustawień LKRG</a> pozwalająca przy
pomocy jednego parametru określić wartości wszystkich opcji <code>*_validate</code> lub <code>*_enforce</code> . Chodzi o
<code>lkrg.profile_enforce</code> oraz <code>lkrg.profile_validate</code> , które domyślnie przyjmują wartość &quot;2&quot; i &quot;3&quot;
odpowiadającą za tryb mieszany (własne ustawienia). Parametr <code>lkrg.profile_validate</code> może przyjąć
wartości z zakresu 0-4, a <code>lkrg.profile_enforce</code> z zakresu 0-3.</p>
<p>Poniżej znajduje się krótka rozpiska dla wartości parametru <code>lkrg.profile_validate</code> :</p>
<pre><code>|=========================================================================================|
|          0 (Disabled)          |        1 (Light)       |         2 (Balanced)          |
|================================|========================|===============================|
| -&gt; kint_validate = 0 (Disabled)| 1 (Manual trigger only)| 2 (Triggered by timer)        |
| -&gt; pint_validate = 0 (Disabled)| 1 (Current task only)  | 2 (Current + weaking up task) |
| -&gt; pcfi_validate = 0 (Disabled)| 1 (Weak pCFI)          | 1 (Weak pCFI)                 |
| -&gt;  umh_validate = 0 (Disabled)| 1 (Whitelist)          | 1 (Whitelist)                 |
| -&gt;  msr_validate = 0 (Disabled)| 0 (Disabled)           | 0 (Disabled)                  |
| -&gt; smep_validate = 0 (Disabled)| 1 (Enabled)            | 1 (Enabled)                   |
| -&gt; smap_validate = 0 (Disabled)| 1 (Enabled)            | 1 (Enabled)                   |
|=========================================================================================|
|               3 (Heavy)               |                  4 (Paranoid)                   |
|=========================================================================================|
| 3 (Triggered by timer + random events)| 3 (Triggered by timer + random events)          |
| 2 (Current + weaking up task)         | 3 (Verify all tasks in the system by every hook)|
| 2 (Full pCFI)                         | 2 (Full pCFI)                                   |
| 1 (Whitelist)                         | 2 (Full UMH lock-down)                          |
| 1 (Disabled)                          | 1 (Enabled)                                     |
| 1 (Enabled)                           | 1 (Enabled)                                     |
| 1 (Enabled)                           | 1 (Enabled)                                     |
|=========================================================================================|
</code></pre>
<p>Niżej zaś znajduje się rozpiska wartości dla parametru <code>lkrg.profile_enforce</code> :</p>
<pre><code>|================================================================================|
|          0 (Log &amp; Accept)         | 1 (Selective) | 2 (Strict)   | 3 (Paranoid)|
|===================================|============================================|
| -&gt; kint_enforce = 0 (Log &amp; accept)| 1 (Log only)  | 2 (Panic)    | 2 (Panic)   |
| -&gt; pint_enforce = 0 (Log &amp; accept)| 1 (Kill task) | 1 (Kill task)| 2 (Panic)   |
| -&gt; pcfi_enforce = 0 (Log only)    | 1 (Kill task) | 1 (Kill task)| 2 (Panic)   |
| -&gt;  umh_enforce = 0 (Log only)    | 1 (Prev exec) | 1 (Prev exec)| 2 (Panic)   |
| -&gt; smep_enforce = 0 (Log &amp; accept)| 2 (Panic)     | 2 (Panic)    | 2 (Panic)   |
| -&gt; smap_enforce = 0 (Log &amp; accept)| 2 (Panic)     | 2 (Panic)    | 2 (Panic)   |
|================================================================================|
</code></pre>
<p>Jak widać, jeśli nie chce nam się zbytnio myśleć na ustawieniami, to możemy wybrać jeden z
predefiniowanych profili i on już zajmie się wszystkimi zależnymi ustawieniami za nas.</p>
<h2 id="podsumowanie">Podsumowanie</h2>
<p>Jakby nie patrzeć, ten osobny moduł LKRG trochę miesza w systemach, które z modułów nie korzystają.
Nie chodzi tutaj nawet o zewnętrzne moduły kernela (te Out Of Tree) ale ogólnie o posiadanie
<a href="https://morfikov.github.io
/post/budowanie-kernela-linux-dla-konkretnej-maszyny-z-debianem/">własnego kernela dla konkretnej maszyny linux'owej</a>, gdzie z zasady wszystkie potrzebne moduły
są wbudowane bezpośrednio w samo jądro operacyjne właśnie też m.in. ze względów bezpieczeństwa. Do
tego dochodzi oczywiście potrzeba zastosowana DKMS oraz problemy z podpisami w środowiskach
EFI/UEFI.</p>
<p>Póki co moduł LKRG da radę wykryć bez większego trudu i był/jest on też podatny na <a href="https://github.com/milabs/lkrg-bypass">różne metody
obejścia</a> (choć te metody zgromadzone w tym linku już nie działają). Być może problem z
wykryciem modułu LKRG zostanie zaadresowany w przyszłości ale póki co trzeba mieć ten fakt na
uwadze. Trzeba też pamiętać o tym, że LKRG nie ochroni naszego systemu, gdy problemy tkwią
bezpośrednio w hardware, np. CPU i <a href="https://zaufanatrzeciastrona.pl/post/linux-kernel-runtime-guard-ochrona-przed-jeszcze-nieznanymi-exploitami/">nie da rady nas ochronić przed choćby Meltdown</a>. Podobnie
sprawa wygląda w przypadku ataków wymierzonych w procedurę startu linux'a (MBR/BIOS/UEFI,
initramfs/initrd, hibernacja, itp) -- te ataki nie zostaną zatrzymane przez LKRG. Warto też
zaznaczyć tutaj, że LKRG nie chroni nas również przed postronnymi osobami zaglądającymi nam przez
ramię podczas wpisywania haseł przy logowaniu się na root czy przy otwieraniu zaszyfrowanych
kontenerów LUKS. Dlatego też dobrze jest się zapoznać się z <a href="https://openwall.info/wiki/p_lkrg/Threat_model">modelem zagrożenia LKRG</a>, by nie
mieć później pretensji, że ochrona nie zadziałała. Dodatkowo, warto też jest zaznajomić się z <a href="http://jultika.oulu.fi/files/nbnfioulu-202004201485.pdf">tym
opracowaniem poświęconym metodom wykrywania rootkit'ów w systemach unix/linux</a>. Może ono nieco
rozjaśnić umysł osobom, które nie do końca zdają sobie sprawę przed jakimi zagrożeniami LKRG ma
chronić system naszego komputera.</p>
<p>Utrata wydajności systemu jaką niesie ze sobą LKRG to około 0,7-2,5% w zależności od
skonfigurowanych opcji ochrony. Wcześniej te liczby wyglądały o wiele gorzej, tj. 6,5%. Zatem można
liczyć, że ten moduł z czasem będzie jeszcze mniej zasobożerny niż jest w tej chwili. Niemniej
jednak, jeśli chodzi o laptopy czy desktopy, to większego spadku wydajności raczej nie zauważymy.</p>
<p>Problemy z nowszymi wersjami kernela/gcc też mogą ździebko irytować ale też trzeba mieć na
względzie fakt, że taka jest specyfika oprogramowania, które nieustannie jest zmieniane i od czasu
do czasu pewne zależne projekty mogą mieć problemy z działaniem. Kluczowe w takiej sytuacji jest
zawsze podejście dewelopera do poprawienia zaistniałego problemu. Wsparcie dla kernela 5.7 zostało
w zasadzie dodane <a href="https://www.openwall.com/lists/lkrg-users/2020/06/02/1">w parę dni po zgłoszeniu całej sytuacji</a>, zatem projekt jak najbardziej się
rozwija, a zgłaszane nieprawidłowości są dość szybko weryfikowane i poprawiane.</p>
<p>Od dłuższego też czasu <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=944476">LKRG próbuje się wbić do repozytorium Debiana</a> ale coś słabo mu to
idzie. Jedno jest pewne, gdy mu się w końcu uda, to instalacja tego modułu w systemie ulegnie
sporemu uproszczeniu, co powinno przyczynić się do większego zainteresowania projektem.</p></div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/debian/">debian</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/dkms/">dkms</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/lkrg/">lkrg</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/kernel/">kernel</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/modu%C5%82y-kernela/">moduły-kernela</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Podziel się na Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmorfikov.github.io%2fpost%2fmodul-lkrg-linux-kernel-runtime-guard%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fmodul-lkrg-linux-kernel-runtime-guard%2f&amp;text=Modu%c5%82%20LKRG%20%28Linux%20Kernel%20Runtime%20Guard%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Reddit" href="https://www.reddit.com/submit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fmodul-lkrg-linux-kernel-runtime-guard%2f&amp;title=Modu%c5%82%20LKRG%20%28Linux%20Kernel%20Runtime%20Guard%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Reddit', 'width=832,height=624,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Reddit" role="img" width="32" height="32" viewBox="0 0 512 512"><path fill-rule="evenodd" d="M375 146a32 32 0 1 0-29-46l-65-13c-5-1-9 2-10 6l-22 97c-45 1-85 15-113 36a42 42 0 1 0-45 69l-1 12c0 65 74 117 166 117s166-52 166-117l-1-11a42 42 0 1 0-44-69c-28-21-67-35-111-37l19-86 58 13a32 32 0 0 0 32 29zM190 353c2-1 4 0 5 1 15 11 38 18 61 18s46-6 61-18a7 7 0 0 1 8 10c-18 14-44 21-69 21-25-1-51-7-69-21a6 6 0 0 1 3-11zm23-44a31 31 0 1 1-44-44 31 31 0 0 1 44 44zm130 0a31 31 0 1 0-44-44 31 31 0 0 0 44 44z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Telegram" href="https://t.me/share/url?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fmodul-lkrg-linux-kernel-runtime-guard%2f&amp;title=Modu%c5%82%20LKRG%20%28Linux%20Kernel%20Runtime%20Guard%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Telegram', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmorfikov.github.io%2fpost%2fmodul-lkrg-linux-kernel-runtime-guard%2f&title=Modu%c5%82%20LKRG%20%28Linux%20Kernel%20Runtime%20Guard%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na VK" href="https://vk.com/share.php?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fmodul-lkrg-linux-kernel-runtime-guard%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na VK', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="VK" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M274 363c5-1 14-3 14-15 0 0-1-30 13-34s32 29 51 42c14 9 25 8 25 8l51-1s26-2 14-23c-1-2-9-15-39-42-31-30-26-25 11-76 23-31 33-50 30-57-4-7-20-6-20-6h-57c-6 0-9 1-12 6 0 0-9 25-21 45-25 43-35 45-40 42-9-5-7-24-7-37 0-45 7-61-13-65-13-2-59-4-73 3-7 4-11 11-8 12 3 0 12 1 17 7 8 13 9 75-2 81-15 11-53-62-62-86-2-6-5-7-12-9H79c-6 0-15 1-11 13 27 56 83 193 184 192z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pocket" href="https://getpocket.com/edit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fmodul-lkrg-linux-kernel-runtime-guard%2f&amp;title=Modu%c5%82%20LKRG%20%28Linux%20Kernel%20Runtime%20Guard%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=480,height=320,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pocket" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M388.8 88.9H123.2A47.4 47.4 0 0 0 76 136.5v131.9c0 2.4.2 4.8.5 7.2a101.8 101.8 0 0 0-.5 10.6c0 75.6 80.6 137 180 137s180-61.4 180-137c0-3.6-.2-7.1-.5-10.6.3-2.4.5-4.8.5-7.2v-132A47.4 47.4 0 0 0 388.8 89zm-22.4 132.6l-93 93c-4.7 4.6-11 7-17.1 7a23.8 23.8 0 0 1-17.7-7l-93-93a24 24 0 0 1 33.8-33.8l76.6 76.5 76.6-76.5a24 24 0 0 1 33.8 33.8z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pinterest" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fmodul-lkrg-linux-kernel-runtime-guard%2f&description=Modu%c5%82%20LKRG%20%28Linux%20Kernel%20Runtime%20Guard%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=800,height=720,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pinterest" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="m265 65c-104 0-157 75-157 138 0 37 14 71 45 83 5 2 10 0 12-5l3-18c2-6 1-7-2-12-9-11-15-24-15-43 0-56 41-106 108-106 60 0 92 37 92 85 0 64-28 116-70 116-23 0-40-18-34-42 6-27 19-57 19-77 0-18-9-34-30-34-24 0-42 25-42 58 0 20 7 34 7 34l-29 120a249 249 0 0 0 2 86l3-1c2-3 31-37 40-72l16-61c7 15 29 28 53 28 71 0 119-64 119-151 0-66-56-126-140-126z"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="Mikhail Morfikov avatar" src="https://morfikov.github.io/img/avatar.png" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				Mikhail Morfikov
			</div>
			<div class="author__bio">Po ponad 10 latach spędzonych z różnej maści linux&#39;ami (Debian/Ubuntu, OpenWRT, Android) mogę śmiało powiedzieć, że nie ma rzeczy niemożliwych i problemów, których nie da się rozwiązać. Jedną umiejętność, którą ludzki umysł musi posiąść, by wybrnąć nawet z tej najbardziej nieprzyjemniej sytuacji, to zdolność logicznego rozumowania.</div>
		</div>
	</div>
</div>
	



<div class="related block">
	<h3 class="related__title">Powiązane</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/automatyczne-podpisywanie-modulow-kernela-przez-dkms/">Automatyczne podpisywanie modułów kernela przez DKMS</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/dkms-czyli-automatycznie-budowane-moduly/">DKMS, czyli automatycznie budowane moduły</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/modul-tpe-trusted-path-execution-dla-kernela-linux/">Moduł TPE (Trusted Path Execution) dla kernela linux</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/jak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms/">Jak na Debianie zrobić pakiet .deb zawierający moduł kernela linux (DKMS)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/jak-recznie-zweryfikowac-sygnature-modulu-kernela-linux/">Jak ręcznie zweryfikować sygnaturę modułu kernela linux</a></li>
		
	</ul>
</div>

	
<section class="comments block">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "morfitronik" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:morfitronik@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/mikhailmorfikov">
			<svg class="social__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://t.me/morfikov">
			<svg class="social__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/morfikov">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/morfikov">
			<svg class="social__icon" aria-label="Gitlab" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M450 282l-22-67-43-133c-2-7-12-7-14 0l-43.3 133H184.3L141 82c-2-7-12-7-14 0L84 215l-22 67c-2 6 0 13 6 16l188 137 188-137c6-3 8-10 6-16z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/users/3015317">
			<svg class="social__icon" aria-label="Stack Overflow" role="img" width="32" height="32" viewBox="0 0 512 512"><g stroke-width="30"><path fill="none" d="M125 297v105h241V297"/><path d="M170 341h150m-144-68l148 31M199 204l136 64m-95-129l115 97M293 89l90 120"/></g></svg>
		</a>
</div>
	<div class="footer__copyright">© 2020 Mikhail Morfikov.
	<span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span>
	<span class="footer__copyright-cc">
		Except where otherwise noted, content on this site is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International license</a>.
		<img alt="Licencja Creative Commons" style="border-width:0" src="https://licensebuttons.net/l/by-nc-sa/4.0/80x15.png" />
	</span>
	</div>
</footer>

<script src="https://morfikov.github.io/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="https://morfikov.github.io/js/custom.js"></script>
</body>
</html>