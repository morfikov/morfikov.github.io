<!DOCTYPE html>
<html class="no-js" lang="pl-PL">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Jak na Debianie zrobić pakiet .deb zawierający moduł kernela linux (DKMS) | Morfitronik</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Jak na Debianie zrobić pakiet .deb zawierający moduł kernela linux (DKMS)" />
<meta property="og:description" content="Kernel linux&#39;a jest dość złożonym organizmem, który może zostać rozbudowany przy pomocy dodatkowego
kodu ładowanego w postaci zewnętrznych modułów. Czasem ze względu na wczesny etap prac nad nową
funkcjonalnością jądra, taki moduł może zachowywać się dość nieprzewidywalnie, co przekreśla jego
szanse na pojawienie się w stabilnych wydaniach kernela. Czasem też z jakiegoś niezrozumiałego
powodu pewne rzeczy nie są celowo dodawane do jądra operacyjnego. Jedną z nich
jest moduł Trusted Path Execution (TPE), który jest w
stanie znacznie poprawić bezpieczeństwo systemu uniemożliwiając przeprowadzenie w nim szeregu
podejrzanych działań. W Debianie tego typu niedogodności związane z brakiem pewnych modułów można
obejść przez
zastosowanie mechanizmu DKMS, który
przy instalacji modułu spoza głównego drzewa kernela linux&#39;a jest nam go w stanie automatycznie
zbudować. W repozytorium dystrybucji Debiana znajduje się już szereg pakietów z modułami (mają
końcówki -dkms ) i w prosty sposób można je sobie doinstalować. Co jednak w przypadku, gdy mamy
moduł, którego nikt jeszcze nie przygotował i nie wrzucił do repozytorium? Co, gdy takich modułów
mamy kilka, a przy tym korzystamy z najnowszego stabilnego kernela, który jest aktualizowany
średnio co kilka dni? Ręczna budowa wszystkich zewnętrznych modułów za każdym razem jak tylko
wyjdzie nowsza wersja kernela, to nie najlepsze wyjście, zwłaszcza jak dojdzie nam do tego
aktualizacja samych modułów. Można za to zrobić sobie paczkę .deb tak, by przy instalacji nowego
jądra operacyjnego, system nam automatycznie zbudował wszystkie dodatkowe moduły, których nasz
komputer wymaga do poprawnej pracy." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://morfikov.github.io/post/jak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-03-17T09:37:28&#43;00:00" />
<meta property="article:modified_time" content="2019-03-17T09:37:28&#43;00:00" />


		<meta itemprop="name" content="Jak na Debianie zrobić pakiet .deb zawierający moduł kernela linux (DKMS)">
<meta itemprop="description" content="Kernel linux&#39;a jest dość złożonym organizmem, który może zostać rozbudowany przy pomocy dodatkowego
kodu ładowanego w postaci zewnętrznych modułów. Czasem ze względu na wczesny etap prac nad nową
funkcjonalnością jądra, taki moduł może zachowywać się dość nieprzewidywalnie, co przekreśla jego
szanse na pojawienie się w stabilnych wydaniach kernela. Czasem też z jakiegoś niezrozumiałego
powodu pewne rzeczy nie są celowo dodawane do jądra operacyjnego. Jedną z nich
jest moduł Trusted Path Execution (TPE), który jest w
stanie znacznie poprawić bezpieczeństwo systemu uniemożliwiając przeprowadzenie w nim szeregu
podejrzanych działań. W Debianie tego typu niedogodności związane z brakiem pewnych modułów można
obejść przez
zastosowanie mechanizmu DKMS, który
przy instalacji modułu spoza głównego drzewa kernela linux&#39;a jest nam go w stanie automatycznie
zbudować. W repozytorium dystrybucji Debiana znajduje się już szereg pakietów z modułami (mają
końcówki -dkms ) i w prosty sposób można je sobie doinstalować. Co jednak w przypadku, gdy mamy
moduł, którego nikt jeszcze nie przygotował i nie wrzucił do repozytorium? Co, gdy takich modułów
mamy kilka, a przy tym korzystamy z najnowszego stabilnego kernela, który jest aktualizowany
średnio co kilka dni? Ręczna budowa wszystkich zewnętrznych modułów za każdym razem jak tylko
wyjdzie nowsza wersja kernela, to nie najlepsze wyjście, zwłaszcza jak dojdzie nam do tego
aktualizacja samych modułów. Można za to zrobić sobie paczkę .deb tak, by przy instalacji nowego
jądra operacyjnego, system nam automatycznie zbudował wszystkie dodatkowe moduły, których nasz
komputer wymaga do poprawnej pracy."><meta itemprop="datePublished" content="2019-03-17T09:37:28&#43;00:00" />
<meta itemprop="dateModified" content="2019-03-17T09:37:28&#43;00:00" />
<meta itemprop="wordCount" content="2223">
<meta itemprop="keywords" content="debian,kernel,dkms," />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Jak na Debianie zrobić pakiet .deb zawierający moduł kernela linux (DKMS)"/>
<meta name="twitter:description" content="Kernel linux&#39;a jest dość złożonym organizmem, który może zostać rozbudowany przy pomocy dodatkowego
kodu ładowanego w postaci zewnętrznych modułów. Czasem ze względu na wczesny etap prac nad nową
funkcjonalnością jądra, taki moduł może zachowywać się dość nieprzewidywalnie, co przekreśla jego
szanse na pojawienie się w stabilnych wydaniach kernela. Czasem też z jakiegoś niezrozumiałego
powodu pewne rzeczy nie są celowo dodawane do jądra operacyjnego. Jedną z nich
jest moduł Trusted Path Execution (TPE), który jest w
stanie znacznie poprawić bezpieczeństwo systemu uniemożliwiając przeprowadzenie w nim szeregu
podejrzanych działań. W Debianie tego typu niedogodności związane z brakiem pewnych modułów można
obejść przez
zastosowanie mechanizmu DKMS, który
przy instalacji modułu spoza głównego drzewa kernela linux&#39;a jest nam go w stanie automatycznie
zbudować. W repozytorium dystrybucji Debiana znajduje się już szereg pakietów z modułami (mają
końcówki -dkms ) i w prosty sposób można je sobie doinstalować. Co jednak w przypadku, gdy mamy
moduł, którego nikt jeszcze nie przygotował i nie wrzucił do repozytorium? Co, gdy takich modułów
mamy kilka, a przy tym korzystamy z najnowszego stabilnego kernela, który jest aktualizowany
średnio co kilka dni? Ręczna budowa wszystkich zewnętrznych modułów za każdym razem jak tylko
wyjdzie nowsza wersja kernela, to nie najlepsze wyjście, zwłaszcza jak dojdzie nam do tego
aktualizacja samych modułów. Można za to zrobić sobie paczkę .deb tak, by przy instalacji nowego
jądra operacyjnego, system nam automatycznie zbudował wszystkie dodatkowe moduły, których nasz
komputer wymaga do poprawnej pracy."/>

	<link rel="stylesheet" href="https://morfikov.github.io/css/bundle.css">
	<link rel="stylesheet" href="https://morfikov.github.io/css/custom.css">
	<link rel="icon" href="https://morfikov.github.io/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="https://morfikov.github.io/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="https://morfikov.github.io/manifest.json">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-119125303-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
	<header class="header">
	<a class="logo" href="https://morfikov.github.io/">Morfitronik</a>
	
<nav class="main-nav main-nav--right" role="navigation">
	<button id="toggle" class="main-nav__btn" aria-label="Menu toggle" aria-expanded="false" tabindex="0">
		<div class="main-nav__btn-box" tabindex="-1">
			<svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18">
				<path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/>
				<path class="icon-menu__x" d="M11.55 9L18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55 0 9 6.45 15.45 0 18 2.55 11.55 9z"/>
			</svg>
		</div>
	</button>
	<ul id="menu" class="main-nav__list">
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/categories/">
					
					<span class="main-nav__text">Kategorie</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/tags/">
					
					<span class="main-nav__text">Tagi</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/info-kontakt/">
					
					<span class="main-nav__text">Info/Kontakt</span>
					
				</a>
			</li>
	</ul>
</nav>
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/">Home</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">Jak na Debianie zrobić pakiet .deb zawierający moduł kernela linux (DKMS)</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2019-03-17T09:37:28Z">Opublikowano: 17/03/2019</time>

<span class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Kategorie:
		<a class="meta-categories__link" href="https://morfikov.github.io/categories/linux/" rel="category">Linux</a>
	</span>
</span>
	</div>
				<h1 class="entry__title">Jak na Debianie zrobić pakiet .deb zawierający moduł kernela linux (DKMS)</h1>
<details class="entry__toc toc" >
	<summary class="toc__title">Spis treści</summary>
	<nav id="TableOfContents">
  <ol>
    <li><a href="#parę-słów-na-temat-budowy-pakietu-deb">Parę słów na temat budowy pakietu .deb</a></li>
    <li><a href="#przygotowanie-źródeł-modułu-kernela">Przygotowanie źródeł modułu kernela</a>
      <ol>
        <li><a href="#plik-debiancontrol">Plik debian/control</a></li>
        <li><a href="#plik-debianchangelog">Plik debian/changelog</a></li>
        <li><a href="#plik-debiancopyright">Plik debian/copyright</a></li>
        <li><a href="#plik-debianrules">Plik debian/rules</a></li>
        <li><a href="#plik-debiantpe-dkmsdkms">Plik debian/tpe-dkms.dkms</a></li>
        <li><a href="#plik-debianwatch">Plik debian/watch</a></li>
        <li><a href="#plik-debiansourceformat">Plik debian/source/format</a></li>
        <li><a href="#paczka-tar-z-oryginalnymi-źródłami">Paczka .tar z oryginalnymi źródłami</a></li>
      </ol>
    </li>
    <li><a href="#budowanie-paczki-deb-zawierającej-źródła-modułu-kernela">Budowanie paczki .deb zawierającej źródła modułu kernela</a></li>
    <li><a href="#instalacja-modułu-kernela-przy-pomocy-dkms-w-systemie">Instalacja modułu kernela przy pomocy DKMS w systemie</a></li>
    <li><a href="#podpisywanie-modułów-dkms">Podpisywanie modułów DKMS</a></li>
  </ol>
</nav>
</details>
				<div class="entry__content"><p>Kernel linux'a jest dość złożonym organizmem, który może zostać rozbudowany przy pomocy dodatkowego
kodu ładowanego w postaci zewnętrznych modułów. Czasem ze względu na wczesny etap prac nad nową
funkcjonalnością jądra, taki moduł może zachowywać się dość nieprzewidywalnie, co przekreśla jego
szanse na pojawienie się w stabilnych wydaniach kernela. Czasem też z jakiegoś niezrozumiałego
powodu pewne rzeczy nie są celowo dodawane do jądra operacyjnego. Jedną z nich
jest <a href="https://github.com/cormander/tpe-lkm">moduł Trusted Path Execution</a> (TPE), który jest w
stanie znacznie poprawić bezpieczeństwo systemu uniemożliwiając przeprowadzenie w nim szeregu
podejrzanych działań. W Debianie tego typu niedogodności związane z brakiem pewnych modułów można
obejść przez
zastosowanie <a href="https://en.wikipedia.org/wiki/Dynamic_Kernel_Module_Support">mechanizmu DKMS</a>, który
przy instalacji modułu spoza głównego drzewa kernela linux'a jest nam go w stanie automatycznie
zbudować. W repozytorium dystrybucji Debiana znajduje się już szereg pakietów z modułami (mają
końcówki <code>-dkms</code> ) i w prosty sposób można je sobie doinstalować. Co jednak w przypadku, gdy mamy
moduł, którego nikt jeszcze nie przygotował i nie wrzucił do repozytorium? Co, gdy takich modułów
mamy kilka, a przy tym korzystamy z najnowszego stabilnego kernela, który jest aktualizowany
średnio co kilka dni? Ręczna budowa wszystkich zewnętrznych modułów za każdym razem jak tylko
wyjdzie nowsza wersja kernela, to nie najlepsze wyjście, zwłaszcza jak dojdzie nam do tego
aktualizacja samych modułów. Można za to zrobić sobie paczkę <code>.deb</code> tak, by przy instalacji nowego
jądra operacyjnego, system nam automatycznie zbudował wszystkie dodatkowe moduły, których nasz
komputer wymaga do poprawnej pracy.</p>
<h2 id="parę-słów-na-temat-budowy-pakietu-deb">Parę słów na temat budowy pakietu .deb</h2>
<p>Cały proces związany z budową pakietów <code>.deb</code> dla Debiana jest dość szerokim zagadnieniem i nie
będę go omawiał w tym artykule szczegółowo. Kiedyś napisałem spory kawałek tekstu poświęcony
właśnie <a href="https://morfikov.github.io/post/poradnik-maintainera-czyli-jak-zrobic-pakiet-deb/">zagadnieniu budowy paczek dla tej dystrybucji</a>.
Cała wiedza zawarta w tym podlinkowanym artykule nie jest jednak niezbędna do zbudowania prostej
paczki <code>.deb</code> . Można pójść nawet na skróty i skorzystać z <code>dpkg-buildpackage -b -us -uc</code> . Jeśli
jednak mamy już przygotowane środowisko pod <code>pbuilder</code> (w tym przypadku jest) i do tego jeszcze
własne <a href="https://morfikov.github.io/post/tworzenie-repozytorium-przy-pomocy-reprepro/">lokalne repozytorium na bazie reprepro</a>
(i to również jest), to ogarnięcie <code>pbuilder</code>'a i budowanie paczek <code>.deb</code> za jego sprawą bardzo
ułatwia życie. Zatem nie trzeba studiować tamtego poradnika by zrobić sobie pakiet z modułem DKMS.
Niemniej jednak, jeśli podczas procesu budowy wystąpią jakieś błędy, to możemy nie być w stanie ich
przezwyciężyć. Przydałoby się zatem chociaż pobieżnie tamten artykuł przeczytać.</p>
<p>W niniejszym artykule skupię się głównie na aspektach budowy pakietu związanych z mechanizmem DKMS
i to te kwestie będą tutaj opisane bardziej szczegółowo. Cały proces zostanie przeprowadzony na
przykładzie pakietowania modułu TPE.</p>
<h2 id="przygotowanie-źródeł-modułu-kernela">Przygotowanie źródeł modułu kernela</h2>
<p>Każdy moduł kernela ma swoje źródła, które musimy sobie pierw pozyskać. Tutaj sprawa jest prosta,
bo projekt jest hostowany na GitHub'ie i wystarczy sklonować repozytorium w poniższy sposób:</p>
<pre><code>$ git clone https://github.com/cormander/tpe-lkm tpe-2.0.3
</code></pre>
<p>Mając źródła, trzeba je zdebianizować. Ten proces polega na stworzeniu katalogu <code>debian/</code> i
uzupełnieniu w nim szeregu plików. Te pliki można tworzyć ręcznie ale lepiej jest zaprzęgnąć do
pracy narzędzie <code>dh_make</code> , które znajduje się w pakiecie <code>debhelper</code> . Skorzystanie z <code>dh_make</code>
będzie możliwe dopiero, gdy format nazwy katalogu będzie miał postać <code>nazwapaczki-wersja</code> .</p>
<p>W przypadku modułów DKMS ogromne znaczenie ma nazwa samego modułu. Nie możemy sobie dowolnie wybrać
nazwy pakietu, bo nawet najdrobniejsza różnica w tych nazwach sprawi, że mechanizm DKMS nam tego
modułu nie będzie potrafił zbudować.</p>
<p>Nazwę modułu najlepiej jest odczytać z pliku <code>Makefile</code> , który powinien się znajdować w głównym
katalogu ze źródłami. W pierwszej linijce tego pliku mamy coś takiego:</p>
<pre><code>MODULE_NAME := tpe
</code></pre>
<p>Dlatego nazwa katalogu, do którego klonowaliśmy repozytorium zaczyna się od <code>tpe</code> , po którym mamy
numerek wersji <code>2.0.3</code> . Ta nazwa jest jedynie tymczasowa. W przypadku budowania modułów spoza
głównego drzewa kernela będzie zwykle normalnym stanem rzeczy, że ich autorzy dość często te moduły
będą aktualizować (dodawać nowe commit'y) ale niekoniecznie będą oni przy tym wydawać nową wersję
modułu. Dlatego też będzie trzeba posługiwać się pośrednią wersją, np. w postaci daty ostatniego
commit'a w repozytorium git. Ta powyższa nazwa katalogu źródeł <code>tpe-2.0.3</code> ma jedynie na celu
pomóc w wygenerowaniu plików szkieletowych, które później poddamy edycji.</p>
<p>Mając przygotowaną nazwę katalogu źródeł, przechodzimy do niego i wpisujemy w terminalu poniższe
polecenie:</p>
<pre><code>$ dh_make --single --packagename tpe --email morfik@nsa.com --native --copyright gpl2
Maintainer Name     : Mikhail Morfikov
Email-Address       : morfik@nsa.com
Date                : Sun, 17 Mar 2019 00:45:27 +0100
Package Name        : tpe
Version             : 2.0.3
License             : gpl2
Package Type        : single
Are the details correct? [Y/n/q]
</code></pre>
<p>To powyższe polecenie stworzyło nam katalog <code>debian/</code> . Z plików w tym folderze zostawiamy jedynie
katalog <code>source/</code> oraz pliki <code>changelog</code> , <code>compat</code> , <code>control</code> , <code>copyright</code> i <code>rules</code> .</p>
<h3 id="plik-debiancontrol">Plik debian/control</h3>
<p>Do pliku <code>control</code> wrzucamy poniższą zawartość:</p>
<pre><code>Source: tpe
Section: kernel
Priority: optional
Maintainer: Mikhail Morfikov &lt;morfik@nsa.com&gt;
Build-Depends: debhelper (&gt;= 11~),
  dkms
Standards-Version: 4.3.0
Homepage: https://github.com/cormander/tpe-lkm
Vcs-Git: https://github.com/cormander/tpe-lkm.git
Vcs-Browser: https://github.com/cormander/tpe-lkm

Package: tpe-dkms
Architecture: all
Depends: ${misc:Depends},
 dkms
Recommends: linux-headers
Description: Trusted Path Execution (TPE) Linux Kernel Module, Version 2
 Trusted Path Execution is a security feature that denies users from
 executing programs that are not owned by root, or are writable. This
 closes the door on a whole category of exploits where a malicious
 user tries to execute his or her own code to attack the system.
 .
 Since this module doesn't use any kind of ACLs, it works out of the
 box with no configuration. It isn't complicated to test or deploy to
 current production systems. Just install it and you're done!
</code></pre>
<p>Pozycja <code>Source:</code> ma wskazywać na nazwę, która była w pliku <code>Makefile</code> . Każda paczka zawierająca
moduły DKMS musi kończyć się frazą <code>-dkms</code> . Dlatego też w <code>Package:</code> mamy <code>tpe-dkms</code> . Zależności
zawsze będą takie same. Pozostałe pola trzeba sobie dostosować w zależności od modułu.</p>
<h3 id="plik-debianchangelog">Plik debian/changelog</h3>
<p>Plik <code>changelog</code> edytujemy wpisując w terminalu <code>dch -i</code> i uzupełniamy w poniższy sposób:</p>
<pre><code>tpe (2.0.3~git20181202-1) unstable; urgency=medium

  * Initial release. (Closes: #123456)
  * Upstream commit: e68ba85

 -- Mikhail Morfikov &lt;morfik@nsa.com&gt;  Sat, 16 Mar 2019 19:25:16 +0100
</code></pre>
<p>Tutaj już się nam zmieniła wersja <code>2.0.3~git20181202-1</code> , bo od <code>2.0.3</code> zostały w repozytorium git
poczynione pewne zmiany i dlatego nie powinniśmy dawać samego <code>2.0.3</code> .</p>
<h3 id="plik-debiancopyright">Plik debian/copyright</h3>
<p>Plik copyright nie jest aż taki ważny, gdy zamierzamy budować paczkę z modułem głównie dla siebie
ale wypadłoby go uzupełnić tak, by miał ręce i nogi:</p>
<pre><code>Format: https://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: tpe
Source: https://github.com/cormander/tpe-lkm

Files: *
Copyright: 2011-2018 Corey Henderson
License: GPL-2

Files: debian/*
Copyright: 2019 Mikhail Morfikov &lt;morfik@nsa.com&gt;,
License: GPL-2

License: GPL-2
 This program is free software; you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation; version 2 dated June, 1991.
 .
 On Debian systems, the complete text of version 2 of the GNU General
 Public License can be found in '/usr/share/common-licenses/GPL-2'.
</code></pre>
<h3 id="plik-debianrules">Plik debian/rules</h3>
<p>Sednem całej zabawy z pakietowaniem modułów DKMS jest odpowiednie uzupełnienie pliku
<code>debian/rules</code> . Poniżej jest przykładowa zawartość:</p>
<pre><code>#!/usr/bin/make -f
# -*- makefile -*-

export DH_VERBOSE=1
export DH_OPTIONS = -v
export DEB_BUILD_MAINT_OPTIONS = hardening=+all
DPKG_EXPORT_BUILDFLAGS = 1
include /usr/share/dpkg/buildflags.mk
include /usr/share/dpkg/pkg-info.mk

%:
    dh $@ --with dkms

override_dh_install:
    dh_install -p tpe-dkms scripts/ usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)
    dh_install -p tpe-dkms conf/ usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)
    dh_install -p tpe-dkms README usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)
    dh_install -p tpe-dkms Makefile usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)
    dh_install -p tpe-dkms *.c usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)
    dh_install -p tpe-dkms *.h usr/src/$(DEB_SOURCE)-$(DEB_VERSION_UPSTREAM)

override_dh_dkms:
    dh_dkms -V $(DEB_VERSION_UPSTREAM)

override_dh_auto_configure:
override_dh_auto_build:
override_dh_auto_test:
override_dh_auto_install:
override_dh_auto_clean:
</code></pre>
<p>Jako, że budujemy moduł DKMS, to określamy <code>--with dkms</code> . Na samym dole zaś mamy kilka pozycji
<code>override_dh_auto_*</code> . Wszystkie z nich są puste i nadpisują odpowiadające im targety. Ma to na
celu uniemożliwienie budowania modułu podczas tworzenia pakietu --  w końcu nie chcemy budować
samego kodu, a jedynie przygotować paczkę, która przy instalacji zbuduje moduł na docelowej
maszynie.</p>
<p>Przy pomocy <code>override_dh_install:</code> przepisujemy domyślny target instalacji plików. Musimy w nim
skopiować wszystkie pliki źródłowe wykorzystywane w procesie budowania modułu kernela. Zwykle są
to pliki mające sufiks <code>*.c</code> i <code>*.h</code> ale mogą być również i inne. Wszystkie te pliki trzeba
umieścić w odpowiednim katalogu pod <code>/usr/src/</code> . W zasadzie to edycja tego targetu w przypadku
różnych modułów kernela sprowadza się do określenia plików, które chcemy skopiować oraz zmiany
nazwy pakietu w <code>-p tpe-dkms</code> .</p>
<p>Z kolei <code>override_dh_dkms:</code> nadpisze nam target konfigurujący DKMS. W tym przypadku będzie
dostosowana wersja w pliku <code>dkms.conf</code> bez potrzeby ręcznej edycji tego pliku. Plik <code>dkms.conf</code>
musimy za to sobie stworzyć ręcznie.</p>
<h3 id="plik-debiantpe-dkmsdkms">Plik debian/tpe-dkms.dkms</h3>
<p>Wspomniany wyżej plik <code>dkms.conf</code> będzie po części generowany ale musimy i tak stworzyć jego
szkielet. Nazwa pliku <code>debian/tpe-dkms.dkms</code> odpowiada temu co wpisaliśmy w polu <code>Package:</code> w pliku
<code>control</code> plus sufiks <code>.dkms</code> . Poniżej znajduje się jego zawartość:</p>
<pre><code>PACKAGE_NAME=&quot;tpe&quot;
PACKAGE_VERSION=&quot;#MODULE_VERSION#&quot;
BUILT_MODULE_NAME[0]=&quot;$PACKAGE_NAME&quot;
MAKE[0]=&quot;make -C ${kernel_source_dir} M=${dkms_tree}/${PACKAGE_NAME}/${PACKAGE_VERSION}/build&quot;
CLEAN=&quot;make -C ${kernel_source_dir} M=${dkms_tree}/${PACKAGE_NAME}/${PACKAGE_VERSION}/build clean&quot;
DEST_MODULE_LOCATION[0]=&quot;/updates/dkms&quot;
REMAKE_INITRD=&quot;no&quot;
AUTOINSTALL=&quot;yes&quot;
</code></pre>
<p>W zmiennej <code>$PACKAGE_NAME</code> podajemy nazwę modułu z pliku <code>Makefile</code> . W zmiennej <code>$PACKAGE_VERSION</code>
nie określamy wersji modułu. Będzie ona automatycznie generowana przez mechanizm budowy pakietu.
Pozostałe zmienne również zostawiamy bez zmian. Niekiedy będzie potrzeba dostosowania zmiennych
<code>$MAKE</code> i <code>$CLEAN</code> . Jeśli nasz moduł nie jest niezbędny w fazie initramfs/initrd, to nie musimy
ustawiać zmiennej <code>$REMAKE_INITRD</code> na <code>yes</code> , co przyśpieszy instalację modułu w systemie.</p>
<h3 id="plik-debianwatch">Plik debian/watch</h3>
<p>Przydałoby się także stworzyć plik <code>debian/watch</code> , który ma za zadanie monitorować czy upstream
wypuścił nowszą wersję modułu. Niemniej jednak, jeśli będziemy podbierać wersję z git'a, to trzeba
będzie synchronizować repozytorium z pominięciem pliku <code>debian/watch</code> . Tak czy inaczej poniżej
znajduje się jego zawartość:</p>
<pre><code>version=4
opts=filenamemangle=s/.+\/v?(\d\S*)\.tar\.gz/tpe-lkm-$1\.tar\.gz/ \
 https://github.com/cormander/tpe-lkm/releases .*/archive/(\d\S*)\.tar\.gz
</code></pre>
<h3 id="plik-debiansourceformat">Plik debian/source/format</h3>
<p>Na koniec musimy jeszcze zmienić format źródeł z <code>3.0 (native)</code> na <code>3.0 (quilt)</code> . Edytujemy zatem
plik <code>debian/source/format</code> i przepisujemy go do poniższej postaci:</p>
<pre><code>3.0 (quilt)
</code></pre>
<h3 id="paczka-tar-z-oryginalnymi-źródłami">Paczka .tar z oryginalnymi źródłami</h3>
<p>Musimy teraz stworzyć sobie paczkę <code>.tar</code> , w której będą przechowywane oryginalne źródła.
Pamiętajmy, że nie możemy po prostu skompresować katalogu roboczego, bo w nim znajdują się choćby
nasz katalog <code>debian/</code> oraz pliki od repozytorium git <code>.git/</code> . Tych wszystkich rzeczy trzeba się z
paczki <code>.tar</code> pozbyć. Robimy to w poniższy sposób:</p>
<pre><code>$ cd ..
$ tar --exclude='.git*' --exclude='.pc' --exclude='debian' -cf - tpe-2.0.3 | xz -9 -c - &gt; tpe_2.0.3~git20181202.orig.tar.xz
</code></pre>
<p>Kluczowe tutaj jest określenie nazwy paczki <code>.tar</code> , która musi pasować do wzoru
<code>nazwapaczki_wersja.orig.tar.xz</code> . Jeśli w pliku <code>debian/changelog</code> uwzględniliśmy także datę
ostatniego commit'a, to ją również trzeba uwzględnić w nazwie paczki <code>.tar</code> .</p>
<h2 id="budowanie-paczki-deb-zawierającej-źródła-modułu-kernela">Budowanie paczki .deb zawierającej źródła modułu kernela</h2>
<p>Mając przygotowane pliki źródłowe, możemy przejść do stworzenia paczki <code>.deb</code> , która nam je ładnie
ogarnie. Budujemy pierw źródła:</p>
<pre><code>$ cd tpe-2.0.3
$ debuild -S -sa -d -i
</code></pre>
<p>I budujemy pakiet <code>.deb</code> :</p>
<pre><code>$ cd ..
$ sudo pbuilder --build tpe_2.0.3\~git20181202-1.dsc
</code></pre>
<p>Z racji, że nie będziemy nic kompilować, a jedynie zainstalujemy trochę zależności, to proces
budowania paczki <code>.deb</code> zajmie jedynie chwilę. Po paru minutach paczka powinna być gotowa do
instalacji w docelowym systemie.</p>
<h2 id="instalacja-modułu-kernela-przy-pomocy-dkms-w-systemie">Instalacja modułu kernela przy pomocy DKMS w systemie</h2>
<p>Jeśli wszystkie kroki do tej pory przeprowadziliśmy poprawnie, to możemy przejść do etapu
instalacji paczki <code>.deb</code> w systemie. Mając lokalne repozytorium stworzone za sprawą <code>reprepro</code>
dodajemy pierw paczkę do niego:</p>
<pre><code>$ debsign /media/Kabi/pbuilder/result/tpe_2.0.3\~git20181202-1_amd64.changes
$ reprepro --basedir /media/Kabi/repozytorium/debian/ include sid /media/Kabi/pbuilder/result/tpe_2.0.3\~git20181202-1_amd64.changes.
</code></pre>
<p>Odświeżamy listę pakietów w repozytorium i instalujemy paczkę <code>tpe-dkms</code> :</p>
<pre><code># apt-get update
# aptitude install tpe-dkms
The following NEW packages will be installed:
  tpe-dkms
0 packages upgraded, 1 newly installed, 0 to remove and 112 not upgraded.
Need to get 0 B/17.3 kB of archives. After unpacking 75.8 kB will be used.
Get: 1 file:/media/Kabi/repozytorium/debian sid/main amd64 tpe-dkms all 2.0.3~git20181202-1 [17.3 kB]
Retrieving bug reports... Done
Parsing Found/Fixed information... Done
Selecting previously unselected package tpe-dkms.
(Reading database ... 325463 files and directories currently installed.)
Preparing to unpack .../tpe-dkms_2.0.3~git20181202-1_all.deb ...
Unpacking tpe-dkms (2.0.3~git20181202-1) ...
Setting up tpe-dkms (2.0.3~git20181202-1) ...
...
</code></pre>
<p>Po chwili powinien rozpocząć się automatyczny proces budowania modułu kernela za sprawą mechanizmu
DKMS. W zasadzie to wszystkie kroki, które w tym procesie mają miejsce są dokładnie takie same jak
przy <a href="https://morfikov.github.io/post/dkms-czyli-automatycznie-budowane-moduly/">ręcznej budowie modułu kernela via DKMS</a>,
z tym, że to system bez naszej ingerencji przeprowadzi cały ten proces:</p>
<pre><code>...
Loading new tpe-2.0.3~git20181202 DKMS files...
Building for 4.20.16-amd64-morficzny+
Building initial module for 4.20.16-amd64-morficzny+
Done.

tpe.ko:
Running module version sanity check.
 - Original module
   - No original module exists within this kernel
 - Installation
   - Installing to /lib/modules/4.20.16-amd64-morficzny+/updates/dkms/

do_depmod 4.20.16-amd64-morficzny+
DKMS: install completed.
</code></pre>
<p>Proces budowy modułu się zakończył, podobnie jak i proces instalacji pakietu. Niektóre moduły będą
się budować dłużej, a inne krócej, przez co cała instalacja będzie sprawiać wrażenie, że nic się
nie kompilowało. Na wszelki wypadek można jeszcze sprawdzić status zainstalowanych w systemie
modułów DKMS:</p>
<pre><code># dkms status
tpe, 2.0.3~git20181202, 4.20.16-amd64-morficzny+, x86_64: installed
</code></pre>
<p>Informacja na końcu, tj. <code>installed</code> oznacza, że moduł został dodany do mechanizmu DKMS, zbudowany
i zainstalowany przez niego, co potwierdza wyjście polecenia <code>modinfo</code> :</p>
<pre><code># modinfo tpe
filename:       /lib/modules/4.20.16-amd64-morficzny+/updates/dkms/tpe.ko
version:        2.0.3
description:    Trusted Path Execution (TPE) Module
license:        GPL v2
author:         Corey Henderson
srcversion:     59FE85B47CF025933F0DEC7
depends:
retpoline:      Y
name:           tpe
vermagic:       4.20.16-amd64-morficzny+ SMP preempt modversions RANDSTRUCT_PLUGIN_0eaedf097c03a5950fbbc3dbbc78d213cd5e0408fdc9f6643749049983af6ba9
sig_id:         PKCS#7
signer:         Key for morfikownias kernel
sig_key:        08:D5:CC:EF:11:AF:1F:63:0C:A6:C7:2A:B2:DB:71:A7:F0:41:DF:24
sig_hashalgo:   sha512
signature:      3A:BB:B3:40:07:35:59:25:30:B0:89:53:01:94:B1:DC:36:04:90:60:
                14:91:8B:5B:67:25:CD:03:62:B3:19:6F:5F:3D:9F:EF:15:1E:AA:23:
                25:6D:A6:73:E1:FC:4F:7B:1C:65:34:82:35:CC:F7:9D:71:FF:0A:08:
                65:E9:F5:79:33:52:00:0C:BB:CC:5A:3F:64:97:5D:62:5C:D2:76:61:
                2B:95:1D:0C:67:A7:59:89:4A:D4:14:A4:54:D5:DB:5A:E1:06:C0:98:
                B5:26:67:46:D6:C3:ED:D1:1E:89:3D:3E:4B:7D:D3:D9:23:97:8A:75:
                E4:91:36:9A:D1:8E:50:57:3C:84:40:9F:7A:2A:C7:D1:61:74:D8:1D:
                79:9D:9D:3B:D0:13:30:8F:9F:86:6D:B9:C3:4B:1A:B5:7E:84:B9:48:
                5B:A3:4C:5C:78:E5:45:A5:BB:84:E8:DC:20:A5:F2:A1:E7:6D:E2:A4:
                33:ED:CA:92:B5:74:B6:0D:09:1C:A2:8C:2F:FE:A6:A4:8D:AD:2A:99:
                7D:B1:F9:FF:83:B3:A0:A2:3A:50:29:D7:B5:B9:C8:36:30:10:CA:98:
                43:1B:1E:18:52:76:50:F3:1B:60:15:D1:82:6E:B8:58:1C:43:4C:71:
                BD:C6:CF:1F:62:6F:5A:65:4B:D4:62:56:AC:32:36:44:65:BF:22:FE:
                E3:24:36:31:EC:14:99:18:60:54:42:CF:76:FF:5B:09:7B:6F:15:49:
                9A:1A:30:B9:B4:C5:98:78:19:1D:BB:02:09:24:C9:B8:44:66:A0:87:
                E8:87:85:F3:3A:CA:40:72:70:65:01:0C:46:88:77:F2:8F:4D:5C:D4:
                7A:01:2A:16:20:68:97:18:07:80:50:B3:9D:1D:A4:94:76:11:4A:AB:
                30:33:87:8E:EE:4C:75:86:86:F8:34:A7:B4:64:EF:02:09:C9:3B:3A:
                AB:AF:AD:DA:36:C5:B7:14:2B:5B:9B:43:73:6A:F8:43:BF:AB:BF:3F:
                CC:56:52:F9:E2:18:D9:A2:F9:75:EC:8A:17:9E:D5:BC:36:FB:4C:9D:
                6B:96:BE:8E:3F:FB:2C:0C:06:82:5D:8B:87:A5:CB:5C:90:EF:98:52:
                11:9C:ED:E5:90:CD:F3:6C:2D:74:1F:C3:A6:AF:AB:8F:B7:1D:0F:2C:
                BF:8D:85:5C:6D:EE:59:5F:66:07:C5:71:37:A4:86:69:A7:71:18:63:
                C4:0B:69:C3:88:03:62:15:03:BA:28:FE:79:A4:85:64:DC:C4:18:04:
                C1:26:61:E6:FF:BA:72:86:45:AD:D3:C6:80:E1:9E:9E:20:83:7B:72:
                FB:7E:F1:90:64:AC:3F:93:48:ED:14:47
</code></pre>
<p>No i jak widać, moduł <code>tpe.ko</code> siedzi na swoim miejscu, zatem cały proces przygotowania pakietu
<code>.deb</code> z modułem kernela zakończył się powodzeniem. Podobnie sprawa będzie wyglądać, gdy
zaktualizujemy paczkę, czy też będziemy instalować nowszy kernel.</p>
<p>Warto też zadbać o to, by moduł instalowany przy pomocy mechanizmu DKMS ładował się przy starcie
systemu tworząc stosowną konfigurację w katalogach <code>/etc/modules-load.d/</code> oraz <code>/etc/modprobe.d/</code> .</p>
<h2 id="podpisywanie-modułów-dkms">Podpisywanie modułów DKMS</h2>
<p>Jeśli nasz kernel wykorzystuje podpisy cyfrowe i nie zezwala na załadowanie modułów, które nie
zostaną podpisane tym samym kluczem co kernel, to trzeba również zadbać
o <a href="https://morfikov.github.io/post/automatyczne-podpisywanie-modulow-kernela-przez-dkms/">podpisanie modułów tworzonych za sprawą mechanizmu DKMS</a>.</p></div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/debian/">debian</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/kernel/">kernel</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/dkms/">dkms</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Podziel się na Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms%2f&amp;text=Jak%20na%20Debianie%20zrobi%c4%87%20pakiet%20.deb%20zawieraj%c4%85cy%20modu%c5%82%20kernela%20linux%20%28DKMS%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Reddit" href="https://www.reddit.com/submit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms%2f&amp;title=Jak%20na%20Debianie%20zrobi%c4%87%20pakiet%20.deb%20zawieraj%c4%85cy%20modu%c5%82%20kernela%20linux%20%28DKMS%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Reddit', 'width=832,height=624,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Reddit" role="img" width="32" height="32" viewBox="0 0 512 512"><path fill-rule="evenodd" d="M375 146a32 32 0 1 0-29-46l-65-13c-5-1-9 2-10 6l-22 97c-45 1-85 15-113 36a42 42 0 1 0-45 69l-1 12c0 65 74 117 166 117s166-52 166-117l-1-11a42 42 0 1 0-44-69c-28-21-67-35-111-37l19-86 58 13a32 32 0 0 0 32 29zM190 353c2-1 4 0 5 1 15 11 38 18 61 18s46-6 61-18a7 7 0 0 1 8 10c-18 14-44 21-69 21-25-1-51-7-69-21a6 6 0 0 1 3-11zm23-44a31 31 0 1 1-44-44 31 31 0 0 1 44 44zm130 0a31 31 0 1 0-44-44 31 31 0 0 0 44 44z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Telegram" href="https://t.me/share/url?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms%2f&amp;title=Jak%20na%20Debianie%20zrobi%c4%87%20pakiet%20.deb%20zawieraj%c4%85cy%20modu%c5%82%20kernela%20linux%20%28DKMS%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Telegram', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms%2f&title=Jak%20na%20Debianie%20zrobi%c4%87%20pakiet%20.deb%20zawieraj%c4%85cy%20modu%c5%82%20kernela%20linux%20%28DKMS%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na VK" href="https://vk.com/share.php?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na VK', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="VK" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M274 363c5-1 14-3 14-15 0 0-1-30 13-34s32 29 51 42c14 9 25 8 25 8l51-1s26-2 14-23c-1-2-9-15-39-42-31-30-26-25 11-76 23-31 33-50 30-57-4-7-20-6-20-6h-57c-6 0-9 1-12 6 0 0-9 25-21 45-25 43-35 45-40 42-9-5-7-24-7-37 0-45 7-61-13-65-13-2-59-4-73 3-7 4-11 11-8 12 3 0 12 1 17 7 8 13 9 75-2 81-15 11-53-62-62-86-2-6-5-7-12-9H79c-6 0-15 1-11 13 27 56 83 193 184 192z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pocket" href="https://getpocket.com/edit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms%2f&amp;title=Jak%20na%20Debianie%20zrobi%c4%87%20pakiet%20.deb%20zawieraj%c4%85cy%20modu%c5%82%20kernela%20linux%20%28DKMS%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=480,height=320,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pocket" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M388.8 88.9H123.2A47.4 47.4 0 0 0 76 136.5v131.9c0 2.4.2 4.8.5 7.2a101.8 101.8 0 0 0-.5 10.6c0 75.6 80.6 137 180 137s180-61.4 180-137c0-3.6-.2-7.1-.5-10.6.3-2.4.5-4.8.5-7.2v-132A47.4 47.4 0 0 0 388.8 89zm-22.4 132.6l-93 93c-4.7 4.6-11 7-17.1 7a23.8 23.8 0 0 1-17.7-7l-93-93a24 24 0 0 1 33.8-33.8l76.6 76.5 76.6-76.5a24 24 0 0 1 33.8 33.8z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pinterest" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-na-debianie-zrobic-pakiet-deb-zawierajacy-modul-kernela-linux-dkms%2f&description=Jak%20na%20Debianie%20zrobi%c4%87%20pakiet%20.deb%20zawieraj%c4%85cy%20modu%c5%82%20kernela%20linux%20%28DKMS%29" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=800,height=720,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pinterest" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="m265 65c-104 0-157 75-157 138 0 37 14 71 45 83 5 2 10 0 12-5l3-18c2-6 1-7-2-12-9-11-15-24-15-43 0-56 41-106 108-106 60 0 92 37 92 85 0 64-28 116-70 116-23 0-40-18-34-42 6-27 19-57 19-77 0-18-9-34-30-34-24 0-42 25-42 58 0 20 7 34 7 34l-29 120a249 249 0 0 0 2 86l3-1c2-3 31-37 40-72l16-61c7 15 29 28 53 28 71 0 119-64 119-151 0-66-56-126-140-126z"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="Mikhail Morfikov avatar" src="https://morfikov.github.io/img/avatar.png" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				Mikhail Morfikov
			</div>
			<div class="author__bio">Po ponad 10 latach spędzonych z różnej maści linux&#39;ami (Debian/Ubuntu, OpenWRT, Android) mogę śmiało powiedzieć, że nie ma rzeczy niemożliwych i problemów, których nie da się rozwiązać. Jedną umiejętność, którą ludzki umysł musi posiąść, by wybrnąć nawet z tej najbardziej nieprzyjemniej sytuacji, to zdolność logicznego rozumowania.</div>
		</div>
	</div>
</div>
	



<div class="related block">
	<h3 class="related__title">Powiązane</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/automatyczne-podpisywanie-modulow-kernela-przez-dkms/">Automatyczne podpisywanie modułów kernela przez DKMS</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/dkms-czyli-automatycznie-budowane-moduly/">DKMS, czyli automatycznie budowane moduły</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/jak-recznie-zweryfikowac-sygnature-modulu-kernela-linux/">Jak ręcznie zweryfikować sygnaturę modułu kernela linux</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/budowanie-kernela-linux-dla-konkretnej-maszyny-z-debianem/">Budowanie kernela linux dla konkretnej maszyny z Debianem</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/czy-linuxowy-firewall-powinien-blokowac-pakiety-not-syn-w-stanie-new/">Czy linux&#39;owy firewall powinien blokować pakiety not-syn w stanie NEW</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/brak-wsparcia-dla-ipset-w-nftables/">Brak wsparcia dla ipset w nftables</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/jak-przy-pomocy-usbguard-zabezpieczyc-porty-usb-przed-zlosliwymi-urzadzeniami/">Jak przy pomocy USBguard zabezpieczyć porty USB przed złośliwymi urządzeniami</a></li>
		
	</ul>
</div>

	

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:morfitronik@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/mikhailmorfikov">
			<svg class="social__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://t.me/morfikov">
			<svg class="social__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/morfikov">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/morfikov">
			<svg class="social__icon" aria-label="Gitlab" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M450 282l-22-67-43-133c-2-7-12-7-14 0l-43.3 133H184.3L141 82c-2-7-12-7-14 0L84 215l-22 67c-2 6 0 13 6 16l188 137 188-137c6-3 8-10 6-16z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/users/3015317">
			<svg class="social__icon" aria-label="Stack Overflow" role="img" width="32" height="32" viewBox="0 0 512 512"><g stroke-width="30"><path fill="none" d="M125 297v105h241V297"/><path d="M170 341h150m-144-68l148 31M199 204l136 64m-95-129l115 97M293 89l90 120"/></g></svg>
		</a>
</div>
	<div class="footer__copyright">© 2021 Mikhail Morfikov.
	<span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span>
	<span class="footer__copyright-cc">
		Except where otherwise noted, content on this site is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International license</a>.
		<img alt="Licencja Creative Commons" style="border-width:0" src="https://licensebuttons.net/l/by-nc-sa/4.0/80x15.png" />
	</span>
	</div>
</footer>

<script src="https://morfikov.github.io/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="https://morfikov.github.io/js/custom.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 40,
  textColor: '#c3c3c3'
})</script>
</body>
</html>
