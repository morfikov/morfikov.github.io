<!DOCTYPE html>
<html class="no-js" lang="pl-PL">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Jak skonfigurować roaming WiFi z wpa_supplicant w linux&#39;ie | Morfitronik</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Jak skonfigurować roaming WiFi z wpa_supplicant w linux&#39;ie" />
<meta property="og:description" content="Bezprzewodowe sieci WiFi są wszędzie. Wystarczy tylko przejść się kawałek po okolicy i przeskanować
eter, a sami zobaczymy, że wynik takiego skanowania zidentyfikuje nam całą masę domowych nadajników.
Oczywiście do większości z nich raczej nigdy nie będziemy mieć dostępu ale są wśród nich takie AP,
do których zwykliśmy się logować. Niekoniecznie te AP muszą należeć do naszej własnej domowej sieci
WiFi. Mogą to być, np. firmowe hotspoty. Nawet jeśli ograniczymy się tylko do naszego domu, to gdy
ten jest nieco większy, to prawdopodobnie jeden bezprzewodowy router nie wystarczy, by pokryć
zasięgiem całą dostępną przestrzeń użytkową. Będziemy musieli dokupić drugi router, czy jakiś
wzmacniacz sygnału. Być może też zdecydujemy się na transmitery sieciowe
(powerline). Jest cała masa
urządzeń, które mogą nam pomóc rozwiązać problem słabego zasięgu. To co zwykle łączy te urządzenia,
to fakt, że wszystkie z nich zawierają dodatkowy AP, który trzeba skonfigurować. Pojawia się zatem
problem przełączania między tymi punktami dostępowymi. Można sobie z tym poradzić konfigurując
roaming. W takiej sytuacji przełączanie między sieciami będzie następowało automatycznie, szybko i
bez naszego udziału. W linux&#39;ach roaming można włączyć przy pomocy narzędzia wpa_supplicant i w
tym artykule zobaczymy jak tego dokonać." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://morfikov.github.io/post/jak-skonfigurowac-roaming-wifi-wpa_supplicant-linux/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2016-09-10T12:13:09+00:00" />
<meta property="article:modified_time" content="2016-09-10T12:13:09+00:00" />


		<meta itemprop="name" content="Jak skonfigurować roaming WiFi z wpa_supplicant w linux&#39;ie">
<meta itemprop="description" content="Bezprzewodowe sieci WiFi są wszędzie. Wystarczy tylko przejść się kawałek po okolicy i przeskanować
eter, a sami zobaczymy, że wynik takiego skanowania zidentyfikuje nam całą masę domowych nadajników.
Oczywiście do większości z nich raczej nigdy nie będziemy mieć dostępu ale są wśród nich takie AP,
do których zwykliśmy się logować. Niekoniecznie te AP muszą należeć do naszej własnej domowej sieci
WiFi. Mogą to być, np. firmowe hotspoty. Nawet jeśli ograniczymy się tylko do naszego domu, to gdy
ten jest nieco większy, to prawdopodobnie jeden bezprzewodowy router nie wystarczy, by pokryć
zasięgiem całą dostępną przestrzeń użytkową. Będziemy musieli dokupić drugi router, czy jakiś
wzmacniacz sygnału. Być może też zdecydujemy się na transmitery sieciowe
(powerline). Jest cała masa
urządzeń, które mogą nam pomóc rozwiązać problem słabego zasięgu. To co zwykle łączy te urządzenia,
to fakt, że wszystkie z nich zawierają dodatkowy AP, który trzeba skonfigurować. Pojawia się zatem
problem przełączania między tymi punktami dostępowymi. Można sobie z tym poradzić konfigurując
roaming. W takiej sytuacji przełączanie między sieciami będzie następowało automatycznie, szybko i
bez naszego udziału. W linux&#39;ach roaming można włączyć przy pomocy narzędzia wpa_supplicant i w
tym artykule zobaczymy jak tego dokonać."><meta itemprop="datePublished" content="2016-09-10T12:13:09+00:00" />
<meta itemprop="dateModified" content="2016-09-10T12:13:09+00:00" />
<meta itemprop="wordCount" content="1588">
<meta itemprop="keywords" content="wifi,sieć," />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Jak skonfigurować roaming WiFi z wpa_supplicant w linux&#39;ie"/>
<meta name="twitter:description" content="Bezprzewodowe sieci WiFi są wszędzie. Wystarczy tylko przejść się kawałek po okolicy i przeskanować
eter, a sami zobaczymy, że wynik takiego skanowania zidentyfikuje nam całą masę domowych nadajników.
Oczywiście do większości z nich raczej nigdy nie będziemy mieć dostępu ale są wśród nich takie AP,
do których zwykliśmy się logować. Niekoniecznie te AP muszą należeć do naszej własnej domowej sieci
WiFi. Mogą to być, np. firmowe hotspoty. Nawet jeśli ograniczymy się tylko do naszego domu, to gdy
ten jest nieco większy, to prawdopodobnie jeden bezprzewodowy router nie wystarczy, by pokryć
zasięgiem całą dostępną przestrzeń użytkową. Będziemy musieli dokupić drugi router, czy jakiś
wzmacniacz sygnału. Być może też zdecydujemy się na transmitery sieciowe
(powerline). Jest cała masa
urządzeń, które mogą nam pomóc rozwiązać problem słabego zasięgu. To co zwykle łączy te urządzenia,
to fakt, że wszystkie z nich zawierają dodatkowy AP, który trzeba skonfigurować. Pojawia się zatem
problem przełączania między tymi punktami dostępowymi. Można sobie z tym poradzić konfigurując
roaming. W takiej sytuacji przełączanie między sieciami będzie następowało automatycznie, szybko i
bez naszego udziału. W linux&#39;ach roaming można włączyć przy pomocy narzędzia wpa_supplicant i w
tym artykule zobaczymy jak tego dokonać."/>

	<link rel="stylesheet" href="https://morfikov.github.io/css/bundle.css">
	<link rel="stylesheet" href="https://morfikov.github.io/css/custom.css">
	<link rel="icon" href="https://morfikov.github.io/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="https://morfikov.github.io/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="https://morfikov.github.io/manifest.json">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-119125303-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
	<header class="header">
	<a class="logo" href="https://morfikov.github.io/">Morfitronik</a>
	
<nav class="main-nav main-nav--right" role="navigation">
	<button id="toggle" class="main-nav__btn" aria-label="Menu toggle" aria-expanded="false" tabindex="0">
		<div class="main-nav__btn-box" tabindex="-1">
			<svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18">
				<path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/>
				<path class="icon-menu__x" d="M11.55 9L18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55 0 9 6.45 15.45 0 18 2.55 11.55 9z"/>
			</svg>
		</div>
	</button>
	<ul id="menu" class="main-nav__list">
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/categories/">
					
					<span class="main-nav__text">Kategorie</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/tags/">
					
					<span class="main-nav__text">Tagi</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/info-kontakt/">
					
					<span class="main-nav__text">Info/Kontakt</span>
					
				</a>
			</li>
	</ul>
</nav>
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/">Home</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">Jak skonfigurować roaming WiFi z wpa_supplicant w linux&#39;ie</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2016-09-10T12:13:09Z">Opublikowano: 10/09/2016</time>

<span class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Kategorie:
		<a class="meta-categories__link" href="https://morfikov.github.io/categories/linux/" rel="category">Linux</a>
	</span>
</span>
	</div>
				<h1 class="entry__title">Jak skonfigurować roaming WiFi z wpa_supplicant w linux&#39;ie</h1>
<details class="entry__toc toc" >
	<summary class="toc__title">Spis treści</summary>
	<nav id="TableOfContents">
  <ol>
    <li><a href="#czym-jest-roaming-wifi">Czym jest roaming WiFi</a></li>
    <li><a href="#konfiguracja-interfejsu-wlan0-w-etcnetworkinterfaces">Konfiguracja interfejsu wlan0 w /etc/network/interfaces</a></li>
    <li><a href="#konfiguracja-wpa_supplicant">Konfiguracja wpa_supplicant</a>
      <ol>
        <li><a href="#roaming-w-tej-samej-sieci-ten-sam-essid-i-hasło">Roaming w tej samej sieci (ten sam ESSID i hasło)</a></li>
        <li><a href="#roaming-w-różnych-sieciach-różny-essid-i-hasło">Roaming w różnych sieciach (różny ESSID i hasło)</a></li>
      </ol>
    </li>
    <li><a href="#roaming-wifi-i-bonding">Roaming WiFi i bonding</a></li>
  </ol>
</nav>
</details>
				<div class="entry__content"><p>Bezprzewodowe sieci WiFi są wszędzie. Wystarczy tylko przejść się kawałek po okolicy i przeskanować
eter, a sami zobaczymy, że wynik takiego skanowania zidentyfikuje nam całą masę domowych nadajników.
Oczywiście do większości z nich raczej nigdy nie będziemy mieć dostępu ale są wśród nich takie AP,
do których zwykliśmy się logować. Niekoniecznie te AP muszą należeć do naszej własnej domowej sieci
WiFi. Mogą to być, np. firmowe hotspoty. Nawet jeśli ograniczymy się tylko do naszego domu, to gdy
ten jest nieco większy, to prawdopodobnie jeden bezprzewodowy router nie wystarczy, by pokryć
zasięgiem całą dostępną przestrzeń użytkową. Będziemy musieli dokupić drugi router, czy jakiś
wzmacniacz sygnału. Być może też zdecydujemy się na <a href="https://morfikov.github.io/post/transmitery-sieciowe-tl-wpa4226t-kit-tp-link/">transmitery sieciowe
(powerline)</a>. Jest cała masa
urządzeń, które mogą nam pomóc rozwiązać problem słabego zasięgu. To co zwykle łączy te urządzenia,
to fakt, że wszystkie z nich zawierają dodatkowy AP, który trzeba skonfigurować. Pojawia się zatem
problem przełączania między tymi punktami dostępowymi. Można sobie z tym poradzić konfigurując
roaming. W takiej sytuacji przełączanie między sieciami będzie następowało automatycznie, szybko i
bez naszego udziału. W linux'ach roaming można włączyć przy pomocy narzędzia <code>wpa_supplicant</code> i w
tym artykule zobaczymy jak tego dokonać.</p>
<h2 id="czym-jest-roaming-wifi">Czym jest roaming WiFi</h2>
<p>Przede wszystkim, interesuje nas sytuacja poprawienia zasięgu na danym obszarze. Dlatego też szereg
punktów dostępowych musi być w swoim zasięgu, by zapewnić dobrej jakości sygnał w każdym miejscu
domu czy działki. Jest niemal pewne, że będziemy mieć równocześnie w zasięgu kilka punktów
dostępowych. Jak w takiej sytuacji zachowa się nasz laptop? Bez prawidłowo skonfigurowanego
roamingu będzie on próbował się trzymać jednego AP, aż straci z nim łączność całkowicie. Wtedy
nastąpi rozłączenie i podłączenie do innego AP, który nadaje mocniejszy sygnał.</p>
<p>Po zastosowaniu kilku AP, w pewnych miejscach naszego domu możemy mieć słaby sygnał z jednego AP ale
równocześnie możemy mieć przyzwoity sygnał z drugiego AP. Niemniej jednak, bez roamingu przełączenie
może w ogóle nie nastąpić. W efekcie jakość negocjowanych parametrów sieci WiFi może być bardzo
niska, co zwykle przekłada się na jeszcze słabszy transfer.</p>
<p>Na linux'ach, które wykorzystują jedynie niewielkie menadżery okien, jak Openbox, zwykle nie mamy
poprawnie skonfigurowanego roamingu. Na tych bardziej rozbudowanych środowiskach graficznych (GNOME,
KDE) są raczej dostępne automaty przełączające i nie musimy sobie roamingiem zawracać głowy. Ja z
tych środowisk nie korzystam i niestety musiałem się trochę wysilić, by skonfigurować na swoim
laptopie ten cały roaming WiFi.</p>
<h2 id="konfiguracja-interfejsu-wlan0-w-etcnetworkinterfaces">Konfiguracja interfejsu wlan0 w /etc/network/interfaces</h2>
<p>Mój laptop dysponuje jednym interfejsem bezprzewodowym <code>wlan0</code> . By skonfigurować ten interfejs do
pracy, trzeba poddać edycji plik <code>/etc/network/interfaces</code> i dopisać w nim poniższy blok kodu:</p>
<pre><code>auto wlan0
iface wlan0 inet manual
    wpa-driver nl80211
    wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf
    wpa-roam-default-iface default

iface default inet dhcp
</code></pre>
<p>Linijka z <code>iface wlan0</code> musi być ustawiona na <code>manual</code> , by mieć możliwość włączenia roamingu.
Sterownik w <code>wpa-driver</code> dobieramy w zależności od posiadanej karty. Te nowsze korzystają z
<code>nl80211</code> , a te starsze z <code>wext</code> . Parametr <code>wpa-roam</code> wskazuje plik, który zawiera konfigurację
sieci WiFi. W tym pliku może znajdować się dowolna ilość bloków z ustawieniami parametrów
poszczególnych sieci, do których mamy dostęp. Jeśli w każdej z tych sieci adresację uzyskujemy
przez protokół DHCP i nie stosujemy żadnej dodatkowej konfiguracji, to możemy ustawić sobie tylko
jeden wirtualny interfejs <code>default</code> . Z kolei parametr <code>wpa-roam-default-iface</code> ustawia domyślny
wirtualny interfejs, który będzie dobierany w przypadku, gdy w pliku
<code>/etc/wpa_supplicant/wpa_supplicant.conf</code> zabraknie opcji <code>id_str</code> , czyli informacji na temat
wirtualnego interfejsu, z którego ma korzystać dana sieć.</p>
<p>Na potrzeby tego artykułu rozważymy sobie jedynie dwa przypadki, które dotyczą sytuacji posiadania w
bliskim sąsiedztwie dwóch punktów dostępowych. Czemu dwa AP blisko siebie? Bo wtedy jest z nimi
najwięcej problemów podczas konfiguracji. W przypadku, gdy zmieniamy lokalizację o wiele kilometrów,
np. na linii dom &lt;-&gt; firma, to zwykle po odpaleniu systemu (np. z hibernacji) zostaniemy
zalogowani do takiej sieci, w której zasięgu jesteśmy. Te sieci ze sobą nie kolidują w żaden sposób
i system nie ma problemu z podłączeniem nas do sieci WiFi w takiej sytuacji.</p>
<h2 id="konfiguracja-wpa_supplicant">Konfiguracja wpa_supplicant</h2>
<p>Konfigurację interfejsu sieciowego mamy z głowy. Teraz musimy skonfigurować sobie narzędzie
<code>wpa_supplicant</code> . Powinno być ono już zainstalowane nawet w najbardziej okrojonych linux'ach (jak
coś to trzeba się rozejrzeć za pakietem <code>wpasupplicant</code> ). Dokładny opis konfiguracji tego narzędzia
znajduje się w artykule o <a href="https://morfikov.github.io/post/konfiguracja-polaczenia-wifi-pod-debianem/">konfiguracji sieci WiFi pod
Debianem</a>. Poniżej zaś znajduje
się jedynie opis potrzebnych nam opcji. Jeśli coś jest niezrozumiałe, to odsyłam do powyższego
artykułu. Przechodzimy zatem do edycji pliku <code>/etc/wpa_supplicant/wpa_supplicant.conf</code> .</p>
<h3 id="roaming-w-tej-samej-sieci-ten-sam-essid-i-hasło">Roaming w tej samej sieci (ten sam ESSID i hasło)</h3>
<p>Pierwszym przypadkiem, którym się zajmiemy, jest jedna bezprzewodowa sieć o określonych parametrach
(ten sam ESSID i hasło). To, że mamy do czynienia z jedną siecią, nie oznacza, że mamy w niej tylko
jeden AP. Takich punktów dostępowych może być kilka, a system odróżnia je po adresie MAC, tj. po
BSSID.</p>
<p>Załóżmy, że mamy w domu dwa punkty dostępowe: AP1 i AP2. AP1 jest ulokowany na paterze, a AP2 gdzieś
na piętrze. W ten sposób mamy w miarę dobry sygnał na obu kondygnacjach. Nasz cel jest prosty. Gdy
jesteśmy na parterze, chcemy być logowani do AP1, a gdy zabieramy laptopa na pięterko, to ma
automatycznie nastąpić przełączenie do AP2. Konfiguracja w pliku
<code>/etc/wpa_supplicant/wpa_supplicant.conf</code> wyglądałaby mniej więcej tak:</p>
<pre><code>ctrl_interface=DIR=/run/wpa_supplicant GROUP=netdev
eapol_version=2
ap_scan=1
fast_reauth=1
country=PL

network={
#   id_str=&quot;default&quot;
    bgscan=&quot;simple:10:-50:300&quot;
    priority=20
    ssid=&quot;Ever_Vigilant&quot;
    psk=&quot;12345678&quot;
    disabled=0
}
</code></pre>
<p>Jest tylko jeden blok sieciowy, bo mamy jedną sieć. Natomiast na uwagę zasługuje parametr <code>bgscan</code> .
Odpowiada on, jak nazwa wskazuje, za skanowanie sieci w tle. Chodzi o to, że roaming może działać
jedynie w oparciu o pewne parametry sieci, które system musi analizować na bieżąco. Inaczej nie
byłby on w stanie oszacować, gdzie nas podłączyć. W tym przypadku interesuje nas siła sygnału,
który dociera do naszego laptopa.</p>
<p>Jako, że nas interesuje siła sygnału, to korzystamy z algorytmu <code>simple</code> , który przyjmuje trzy
parametry, w tym przypadku są to <code>10:-50:300</code> . Liczba <code>-50</code> odnosi się do progu siły sygnału, czyli
-50 dBm. Ten parametr jest analizowany na bieżąco. Gdy sygnał mamy dobrej jakości, tj. lepszy niż
-50 dBm, to skanowanie sieci jest dokonywane co 300 sekund. W przypadku, gdy siła odbieranego
sygnału spadnie poniżej określonego progu (np. -60, -70, etc), to skanowanie sieci będzie odbywać
się co 10 sekund.</p>
<p>Każde skanowanie sieci zwraca listę wszystkich AP w okolicy oraz jakość odbieranego od nich sygnału.
Takie skanowanie możemy sami zainicjować wpisując w terminalu polecenie <code>wpa_cli scan</code> i po chwili
podejrzeć wynik poleceniem <code>wpa_cli scan_results</code> , poniżej przykład:</p>
<p><img loading="lazy" src="https://morfikov.github.io/img/2016/09/1.roaming-wifi-linux-skan-sieci-wpasupplicant.png" alt="roaming-wifi-linux-skan-sieci-wpasupplicant"    class="huge"></p>
<p>Jak widać wyżej, mamy dwa AP z tą samą nazwą sieci <code>Ever_Vigilant</code> . Widzimy też, że poziom sygnału
docierającego do mojego laptopa to -13 dBm i -52 dBm. Jesteśmy naturalnie podłączeni w tej chwili do
tego AP z lepszym sygnałem. Niemniej jednak, różnica jest dość spora i dlatego bawimy się w roaming.</p>
<p>W przypadku przechodzenia do pokoju, gdzie jest zlokalizowany AP2, jakość sygnału z AP1 będzie
ulegać stopniowej degradacji, aż w pewnym momencie przekroczy próg -50 dBm. Taka sytuacja
zapoczątkuje agresywne skanowanie sieci co 10 sekund w celu zaktualizowania tej powyższej tabelki.
Wtedy okaże się, że w pewnym momencie sygnał będzie się prezentował tak jak na tym poniższym
obrazku:</p>
<p><img loading="lazy" src="https://morfikov.github.io/img/2016/09/2.roaming-wifi-linux-skan-sieci-wpasupplicant.png" alt="roaming-wifi-linux-skan-sieci-wpasupplicant"    class="huge"></p>
<p>Zatem nastąpiła zamiana miejsc i teraz AP2 dostarcza przyzwoity sygnał. W takim przypadku po
zastosowaniu opcji <code>bgscan</code> , system powinien nas automatycznie przełączyć między tymi dwoma AP i to
bez żadnych powiadomień czy wymagania podjęcia jakichś akcji z naszej strony. Poniżej jest fotka
zalogowanego zdarzenia:</p>
<p><img loading="lazy" src="https://morfikov.github.io/img/2016/09/3.roaming-wifi-linux-przelaczanie-sieci-ten-sam-essid.png" alt="roaming-wifi-linux-przelaczanie-sieci-ten-sam-essid"    class="huge"></p>
<p>Wyżej w logu widzimy komunikat <code>wlan0: disconnect from AP c4:6e:1f:95:ef:fd for new auth to ec:08:6b:8d:32:aa</code> . Jest to informacja, która oświadcza nam, że demon roamingowy znalazł AP o
lepszym sygnale i będzie próbował przełączyć się do niego. W powyższym logu mamy dwa zdarzenia,
które efektywnie testują roaming w tej samej sieci.</p>
<h3 id="roaming-w-różnych-sieciach-różny-essid-i-hasło">Roaming w różnych sieciach (różny ESSID i hasło)</h3>
<p>Drugą sytuacją, w której roaming jest wielce niezbędny, jest posiadanie na danym obszarze kilku AP
niepowiązanych ze sobą, tj. należą one do różnych sieci WiFi. W tym przypadku ESSID rozgłaszanej w
okolicy sieci się różni. Dlatego też nie możemy skorzystać z opisanej powyżej konfiguracji dla
narzędzia <code>wpa_supplicant</code> . Oczywiście część parametrów będzie taka sama ale musimy określić kilka
bloków sieci, a dokładnie tyle z iloma sieciami zamierzamy się łączyć. Poniżej jest przykładowy plik
<code>/etc/wpa_supplicant/wpa_supplicant.conf</code> :</p>
<pre><code>ctrl_interface=DIR=/run/wpa_supplicant GROUP=netdev
eapol_version=2
ap_scan=1
fast_reauth=1
country=PL

network={
#   id_str=&quot;default&quot;
    bgscan=&quot;simple:10:-60:300&quot;
    priority=20
    ssid=&quot;Ever_Vigilant&quot;
    psk=&quot;12345678&quot;
    disabled=0
}
network={
#   id_str=&quot;default&quot;
    bgscan=&quot;simple:10:-60:300&quot;
    priority=20
    ssid=&quot;TP-LINK&quot;
    psk=&quot;87654321&quot;
    disabled=0
}
</code></pre>
<p>Za wiele się ta konfiguracja nie różni od tej poprzedniej. Niemniej jednak, w każdym z tych dwóch
bloków sieciowych mamy określoną opcję <code>bgscan</code> . Informuje ona system, że tylko te dwie sieci mają
być brane pod uwagę przy roamingu, czyli będąc podłączonym do którejś z nich, sygnał będzie
analizowany i przy słabej jego jakości nastąpi przeskanowanie pasma sieciowego. Niemniej jednak, to
do której sieci zostaniemy podłączeni zależy od samej konfiguracji sieci w pliku
<code>/etc/wpa_supplicant/wpa_supplicant.conf</code> , np. priorytety mają znaczenie.</p>
<p>Tak obecnie wygląda eter w mojej okolicy:</p>
<p><img loading="lazy" src="https://morfikov.github.io/img/2016/09/4.roaming-wifi-linux-skan-sieci-wpasupplicant.png" alt="roaming-wifi-linux-skan-sieci-wpasupplicant"    class="huge"></p>
<p>Dwie moje sieci są oznaczone jako <code>Ever_Vigilant</code> oraz <code>TP-LINK</code> . Obie te sieci zostały określone w
konfiguracji <code>wpa_supplicant</code> i na obu z nich mamy ustawiony roaming. Wystarczy, że sygnał spadnie
poniżej tych -60 dBm, a system przełączy nas do drugiego AP:</p>
<p><img loading="lazy" src="https://morfikov.github.io/img/2016/09/5.roaming-wifi-linux-przelaczanie-sieci-rozne-essid.png" alt="roaming-wifi-linux-przelaczanie-sieci-rozne-essid"    class="huge"></p>
<p>W tym przypadku, jako że są różne nazwy sieci, w logu pojawiła się informacja na temat tej, do
której zostaliśmy przyłączeni.</p>
<p>W powyższej konfiguracji definiowaliśmy sieci, które mają być objęte roamingiem przez określenie w
odpowiednich blokach sieciowych opcji <code>bgscan</code> . Ta opcja może także powędrować do sekcji globalnej.
W takiej sytuacji roaming zostanie włączony na wszystkich zdefiniowanych w pliku
<code>/etc/wpa_supplicant/wpa_supplicant.conf</code> sieciach.</p>
<h2 id="roaming-wifi-i-bonding">Roaming WiFi i bonding</h2>
<p>Co ciekawe, roaming działa bez zarzutu z interfejsem <code>bond0</code> . Zatem jeśli <a href="https://morfikov.github.io/post/konfiguracja-interfejsow-bond-bonding/">mamy na swoim linux'ie
skonfigurowany bonding</a> między
interfejsem przewodowym i bezprzewodowym i chcielibyśmy korzystać z roamingu WiFi, to nie powinniśmy
napotkać żadnych problemów przy korzystaniu z takiego ustawienia.</p></div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/wifi/">wifi</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/siec/">sieć</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Podziel się na Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-skonfigurowac-roaming-wifi-wpa_supplicant-linux%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-skonfigurowac-roaming-wifi-wpa_supplicant-linux%2f&amp;text=Jak%20skonfigurowa%c4%87%20roaming%20WiFi%20z%20wpa_supplicant%20w%20linux%27ie" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Reddit" href="https://www.reddit.com/submit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-skonfigurowac-roaming-wifi-wpa_supplicant-linux%2f&amp;title=Jak%20skonfigurowa%c4%87%20roaming%20WiFi%20z%20wpa_supplicant%20w%20linux%27ie" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Reddit', 'width=832,height=624,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Reddit" role="img" width="32" height="32" viewBox="0 0 512 512"><path fill-rule="evenodd" d="M375 146a32 32 0 1 0-29-46l-65-13c-5-1-9 2-10 6l-22 97c-45 1-85 15-113 36a42 42 0 1 0-45 69l-1 12c0 65 74 117 166 117s166-52 166-117l-1-11a42 42 0 1 0-44-69c-28-21-67-35-111-37l19-86 58 13a32 32 0 0 0 32 29zM190 353c2-1 4 0 5 1 15 11 38 18 61 18s46-6 61-18a7 7 0 0 1 8 10c-18 14-44 21-69 21-25-1-51-7-69-21a6 6 0 0 1 3-11zm23-44a31 31 0 1 1-44-44 31 31 0 0 1 44 44zm130 0a31 31 0 1 0-44-44 31 31 0 0 0 44 44z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Telegram" href="https://t.me/share/url?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-skonfigurowac-roaming-wifi-wpa_supplicant-linux%2f&amp;title=Jak%20skonfigurowa%c4%87%20roaming%20WiFi%20z%20wpa_supplicant%20w%20linux%27ie" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Telegram', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-skonfigurowac-roaming-wifi-wpa_supplicant-linux%2f&title=Jak%20skonfigurowa%c4%87%20roaming%20WiFi%20z%20wpa_supplicant%20w%20linux%27ie" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na VK" href="https://vk.com/share.php?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-skonfigurowac-roaming-wifi-wpa_supplicant-linux%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na VK', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="VK" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M274 363c5-1 14-3 14-15 0 0-1-30 13-34s32 29 51 42c14 9 25 8 25 8l51-1s26-2 14-23c-1-2-9-15-39-42-31-30-26-25 11-76 23-31 33-50 30-57-4-7-20-6-20-6h-57c-6 0-9 1-12 6 0 0-9 25-21 45-25 43-35 45-40 42-9-5-7-24-7-37 0-45 7-61-13-65-13-2-59-4-73 3-7 4-11 11-8 12 3 0 12 1 17 7 8 13 9 75-2 81-15 11-53-62-62-86-2-6-5-7-12-9H79c-6 0-15 1-11 13 27 56 83 193 184 192z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pocket" href="https://getpocket.com/edit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-skonfigurowac-roaming-wifi-wpa_supplicant-linux%2f&amp;title=Jak%20skonfigurowa%c4%87%20roaming%20WiFi%20z%20wpa_supplicant%20w%20linux%27ie" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=480,height=320,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pocket" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M388.8 88.9H123.2A47.4 47.4 0 0 0 76 136.5v131.9c0 2.4.2 4.8.5 7.2a101.8 101.8 0 0 0-.5 10.6c0 75.6 80.6 137 180 137s180-61.4 180-137c0-3.6-.2-7.1-.5-10.6.3-2.4.5-4.8.5-7.2v-132A47.4 47.4 0 0 0 388.8 89zm-22.4 132.6l-93 93c-4.7 4.6-11 7-17.1 7a23.8 23.8 0 0 1-17.7-7l-93-93a24 24 0 0 1 33.8-33.8l76.6 76.5 76.6-76.5a24 24 0 0 1 33.8 33.8z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pinterest" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-skonfigurowac-roaming-wifi-wpa_supplicant-linux%2f&description=Jak%20skonfigurowa%c4%87%20roaming%20WiFi%20z%20wpa_supplicant%20w%20linux%27ie" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=800,height=720,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pinterest" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="m265 65c-104 0-157 75-157 138 0 37 14 71 45 83 5 2 10 0 12-5l3-18c2-6 1-7-2-12-9-11-15-24-15-43 0-56 41-106 108-106 60 0 92 37 92 85 0 64-28 116-70 116-23 0-40-18-34-42 6-27 19-57 19-77 0-18-9-34-30-34-24 0-42 25-42 58 0 20 7 34 7 34l-29 120a249 249 0 0 0 2 86l3-1c2-3 31-37 40-72l16-61c7 15 29 28 53 28 71 0 119-64 119-151 0-66-56-126-140-126z"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="Mikhail Morfikov avatar" src="https://morfikov.github.io/img/avatar.png" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				Mikhail Morfikov
			</div>
			<div class="author__bio">Po ponad 10 latach spędzonych z różnej maści linux&#39;ami (Debian/Ubuntu, OpenWRT, Android) mogę śmiało powiedzieć, że nie ma rzeczy niemożliwych i problemów, których nie da się rozwiązać. Jedną umiejętność, którą ludzki umysł musi posiąść, by wybrnąć nawet z tej najbardziej nieprzyjemniej sytuacji, to zdolność logicznego rozumowania.</div>
		</div>
	</div>
</div>
	



<div class="related block">
	<h3 class="related__title">Powiązane</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/debian-profilowanie-sieci-guessnet-ifplugd-wpasupplicant/">Debian: Profilowanie sieci z guessnet, ifplugd i wpasupplicant</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/metryki-tras-interfejsow-eth0-wlan0-laptop-metric/">Metryki tras interfejsów eth0 i wlan0 w laptopie (metric)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/transmitery-sieciowe-tl-wpa4226t-kit-tp-link/">Recenzja: Transmitery sieciowe TL-WPA4226T KIT od TP-LINK</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/transmiter-sieciowy-panel-admina-linux/">Transmiter sieciowy i jego panel admina pod linux&#39;em</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/rozne-adresy-lan-wlan-openwrt-routed-ap/">Różne adresy LAN i WLAN w OpenWRT (Routed AP)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/bezprzewodowa-siec-goscinna-guest-wlan/">Bezprzewodowa sieć gościnna (guest WLAN)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/router-openwrt-jako-serwer-klient-radius/">Router OpenWRT jako serwer i klient RADIUS</a></li>
		
	</ul>
</div>

	<div id="comments">
		<script src="https://utteranc.es/client.js"
        repo="morfikov/morfitronik-comments"
        issue-term="og:title"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>

	</div>

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:morfitronik@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/mikhailmorfikov">
			<svg class="social__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://t.me/morfikov">
			<svg class="social__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/morfikov">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/morfikov">
			<svg class="social__icon" aria-label="Gitlab" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M450 282l-22-67-43-133c-2-7-12-7-14 0l-43.3 133H184.3L141 82c-2-7-12-7-14 0L84 215l-22 67c-2 6 0 13 6 16l188 137 188-137c6-3 8-10 6-16z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/users/3015317">
			<svg class="social__icon" aria-label="Stack Overflow" role="img" width="32" height="32" viewBox="0 0 512 512"><g stroke-width="30"><path fill="none" d="M125 297v105h241V297"/><path d="M170 341h150m-144-68l148 31M199 204l136 64m-95-129l115 97M293 89l90 120"/></g></svg>
		</a>
</div>
	<div class="footer__copyright">© 2022 Mikhail Morfikov.
	<span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span>
	<span class="footer__copyright-cc">
		<div class="license-icons">
			<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" title="Creative Commons Attribution 4.0 International license">
<i class="icon-cc"></i><i class="icon-cc-by"></i><i class="icon-cc-nc"></i><i class="icon-cc-sa"></i>
</a>
		</div>
		Except where otherwise noted, content on this site is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International license</a>.
	</span>
	</div>
</footer>

<script src="https://morfikov.github.io/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="https://morfikov.github.io/js/custom.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 40,
  textColor: '#c3c3c3'
})</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
const images = Array.from(document.querySelectorAll(".entry__content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    scrollOffset: 40,  
    container: null,  
    template: null,  
    background: 'rgba(0, 0, 0, 0.8)'
  });
});
</script>
</body>
</html>
