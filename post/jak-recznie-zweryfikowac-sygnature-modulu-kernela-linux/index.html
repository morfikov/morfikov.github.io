<!DOCTYPE html>
<html class="no-js" lang="pl-PL">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Jak ręcznie zweryfikować sygnaturę modułu kernela linux | Morfitronik</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Jak ręcznie zweryfikować sygnaturę modułu kernela linux" />
<meta property="og:description" content="Bawiąc się ostatnio kernelem linux na dystrybucji Debian i opcjami mającymi poprawić jego
bezpieczeństwo, włączyłem
sobie mechanizm podpisywania modułów.
W ten sposób żaden zewnętrzny moduł nie zostanie załadowany przez jądro operacyjne, no chyba, że
taki moduł będzie podpisany przez ten sam klucz co i kernel. Zdziwiłem się odrobinę, gdy moim
oczom pokazał się hash md4 w wyjściu polecenia modinfo . Jak się okazało później, to niezbyt
dokładne zinterpretowanie wiadomości PKCS#7 przez kmod było (i nadal jest) wynikiem błędu
obecnego w tym pakiecie od już paru lat. W
efekcie modinfo nie jest w stanie zweryfikować tej sygnatury, a w moim umyśle zaistniało pytanie:
czy istnieje w ogóle możliwość manualnego sprawdzenia czy ta sygnatura jest w porządku? Kernel co
prawda ten cały zabieg przeprowadza automatycznie ale przydałoby się ręcznie zweryfikować
poprawność sygnatury modułu i przy okazji obadać sobie co tak naprawdę się dzieje podczas tego
procesu." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://morfikov.github.io/post/jak-recznie-zweryfikowac-sygnature-modulu-kernela-linux/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-01-26T10:10:12+00:00" />
<meta property="article:modified_time" content="2019-01-26T10:10:12+00:00" />


		<meta itemprop="name" content="Jak ręcznie zweryfikować sygnaturę modułu kernela linux">
<meta itemprop="description" content="Bawiąc się ostatnio kernelem linux na dystrybucji Debian i opcjami mającymi poprawić jego
bezpieczeństwo, włączyłem
sobie mechanizm podpisywania modułów.
W ten sposób żaden zewnętrzny moduł nie zostanie załadowany przez jądro operacyjne, no chyba, że
taki moduł będzie podpisany przez ten sam klucz co i kernel. Zdziwiłem się odrobinę, gdy moim
oczom pokazał się hash md4 w wyjściu polecenia modinfo . Jak się okazało później, to niezbyt
dokładne zinterpretowanie wiadomości PKCS#7 przez kmod było (i nadal jest) wynikiem błędu
obecnego w tym pakiecie od już paru lat. W
efekcie modinfo nie jest w stanie zweryfikować tej sygnatury, a w moim umyśle zaistniało pytanie:
czy istnieje w ogóle możliwość manualnego sprawdzenia czy ta sygnatura jest w porządku? Kernel co
prawda ten cały zabieg przeprowadza automatycznie ale przydałoby się ręcznie zweryfikować
poprawność sygnatury modułu i przy okazji obadać sobie co tak naprawdę się dzieje podczas tego
procesu."><meta itemprop="datePublished" content="2019-01-26T10:10:12+00:00" />
<meta itemprop="dateModified" content="2019-01-26T10:10:12+00:00" />
<meta itemprop="wordCount" content="1818">
<meta itemprop="keywords" content="debian,kernel,moduły-kernela," />
		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Jak ręcznie zweryfikować sygnaturę modułu kernela linux"/>
<meta name="twitter:description" content="Bawiąc się ostatnio kernelem linux na dystrybucji Debian i opcjami mającymi poprawić jego
bezpieczeństwo, włączyłem
sobie mechanizm podpisywania modułów.
W ten sposób żaden zewnętrzny moduł nie zostanie załadowany przez jądro operacyjne, no chyba, że
taki moduł będzie podpisany przez ten sam klucz co i kernel. Zdziwiłem się odrobinę, gdy moim
oczom pokazał się hash md4 w wyjściu polecenia modinfo . Jak się okazało później, to niezbyt
dokładne zinterpretowanie wiadomości PKCS#7 przez kmod było (i nadal jest) wynikiem błędu
obecnego w tym pakiecie od już paru lat. W
efekcie modinfo nie jest w stanie zweryfikować tej sygnatury, a w moim umyśle zaistniało pytanie:
czy istnieje w ogóle możliwość manualnego sprawdzenia czy ta sygnatura jest w porządku? Kernel co
prawda ten cały zabieg przeprowadza automatycznie ale przydałoby się ręcznie zweryfikować
poprawność sygnatury modułu i przy okazji obadać sobie co tak naprawdę się dzieje podczas tego
procesu."/>

	<link rel="stylesheet" href="https://morfikov.github.io/css/bundle.css">
	<link rel="stylesheet" href="https://morfikov.github.io/css/custom.css">
	<link rel="icon" href="https://morfikov.github.io/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="https://morfikov.github.io/icons/32.png" sizes="32x32" type="image/png">
	<link rel="manifest" href="https://morfikov.github.io/manifest.json">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-119125303-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
	<header class="header">
	<a class="logo" href="https://morfikov.github.io/">Morfitronik</a>
	
<nav class="main-nav main-nav--right" role="navigation">
	<button id="toggle" class="main-nav__btn" aria-label="Menu toggle" aria-expanded="false" tabindex="0">
		<div class="main-nav__btn-box" tabindex="-1">
			<svg class="main-nav__icon icon-menu" width="18" height="18" viewBox="0 0 18 18">
				<path class="icon-menu__burger" d="M18 0v3.6H0V0h18zM0 10.8h18V7.2H0v3.6zM0 18h18v-3.6H0V18z"/>
				<path class="icon-menu__x" d="M11.55 9L18 15.45 15.45 18 9 11.55 2.55 18 0 15.45 6.45 9 0 2.55 2.55 0 9 6.45 15.45 0 18 2.55 11.55 9z"/>
			</svg>
		</div>
	</button>
	<ul id="menu" class="main-nav__list">
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/categories/">
					
					<span class="main-nav__text">Kategorie</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/tags/">
					
					<span class="main-nav__text">Tagi</span>
					
				</a>
			</li>
			<li class="main-nav__item">
				<a class="main-nav__link" href="https://morfikov.github.io/page/info-kontakt/">
					
					<span class="main-nav__text">Info/Kontakt</span>
					
				</a>
			</li>
	</ul>
</nav>
</header>
	<div class="primary">
	
	<main class="main">
		
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/">Home</a>
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="https://morfikov.github.io/post/">Posts</a>
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">Jak ręcznie zweryfikować sygnaturę modułu kernela linux</li>
	</ol>
</nav>
		<div class="single block">
			<article class="entry">
	<div class="entry__meta meta mb">
	<time class="entry__meta-published meta-published" datetime="2019-01-26T10:10:12Z">Opublikowano: 26/01/2019</time>

<span class="entry__meta-categories meta-categories">
	<span class="meta-categories__list">Kategorie:
		<a class="meta-categories__link" href="https://morfikov.github.io/categories/linux/" rel="category">Linux</a>
	</span>
</span>
	</div>
				<h1 class="entry__title">Jak ręcznie zweryfikować sygnaturę modułu kernela linux</h1>
<details class="entry__toc toc" >
	<summary class="toc__title">Spis treści</summary>
	<nav id="TableOfContents">
  <ol>
    <li><a href="#jak-wydobyć-wiadomość-pkcs7-z-modułu-kernela">Jak wydobyć wiadomość PKCS#7 z modułu kernela</a></li>
    <li><a href="#jak-wydobyć-certyfikat-x509-i-klucz-publiczny-z-kernela">Jak wydobyć certyfikat x509 i klucz publiczny z kernela</a></li>
    <li><a href="#jak-rozkodować-strukturę-asn1-i-wyciągnąć-sygnaturę-modułu">Jak rozkodować strukturę ASN.1 i wyciągnąć sygnaturę modułu</a></li>
    <li><a href="#weryfikacja-sygnatury-modułu-kernela">Weryfikacja sygnatury modułu kernela</a></li>
  </ol>
</nav>
</details>
				<div class="entry__content"><p>Bawiąc się ostatnio kernelem linux na dystrybucji Debian i opcjami mającymi poprawić jego
bezpieczeństwo, włączyłem
sobie <a href="https://morfikov.github.io/post/automatyczne-podpisywanie-modulow-kernela-przez-dkms/">mechanizm podpisywania modułów</a>.
W ten sposób żaden zewnętrzny moduł nie zostanie załadowany przez jądro operacyjne, no chyba, że
taki moduł będzie podpisany przez ten sam klucz co i kernel. Zdziwiłem się odrobinę, gdy moim
oczom pokazał się hash <code>md4</code> w wyjściu polecenia <code>modinfo</code> . Jak się okazało później, to niezbyt
dokładne zinterpretowanie wiadomości PKCS#7 przez <code>kmod</code> było (i nadal jest) wynikiem <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1320921">błędu
obecnego w tym pakiecie od już paru lat</a>. W
efekcie <code>modinfo</code> nie jest w stanie zweryfikować tej sygnatury, a w moim umyśle zaistniało pytanie:
czy istnieje w ogóle możliwość manualnego sprawdzenia czy ta sygnatura jest w porządku? Kernel co
prawda ten cały zabieg przeprowadza automatycznie ale przydałoby się ręcznie zweryfikować
poprawność sygnatury modułu i przy okazji obadać sobie co tak naprawdę się dzieje podczas tego
procesu.</p>
<h2 id="jak-wydobyć-wiadomość-pkcs7-z-modułu-kernela">Jak wydobyć wiadomość PKCS#7 z modułu kernela</h2>
<p>Na potrzeby tego doświadczenia potrzebny będzie nam moduł kernela, który został już podpisany. Nie
ma przy tym znaczenia, czy moduł został podpisany na etapie budowania samego kernela, czy też
później, np. za sprawą DKMS. Potrzebny jest nam zatem jedynie plik, którego sygnaturę chcemy
zweryfikować. W tym przypadku oczywiście mamy do czynienia z modułami kernela dostarczanymi przez
mechanizm DKMS, zatem pliki, które nas będą interesować znajdują się pod
<code>/lib/modules/*/updates/dkms/</code> , gdzie <code>*</code> oznacza numerek kernela.</p>
<p>Mając podpisany moduł, trzeba z niego
wydobyć <a href="https://pl.wikipedia.org/wiki/PKCS">wiadomość PKCS#7</a>. Do tego celu można skorzystać ze
skryptu dostarczanego wraz z kernelem (plik <code>scripts/extract-module-sig.pl</code> ):</p>
<pre><code># cd /usr/src/linux-source-4.20/
# scripts/extract-module-sig.pl -s /lib/modules/4.20.0-amd64-morficzny/updates/dkms/xt_ACCOUNT.ko &gt; /tmp/modsig
Read 50200 bytes from module file
Found magic number at 50200
Found PKCS#7/CMS encapsulation
Found 760 bytes of signature [308202f406092a864886f70d010702a0]
</code></pre>
<h2 id="jak-wydobyć-certyfikat-x509-i-klucz-publiczny-z-kernela">Jak wydobyć certyfikat x509 i klucz publiczny z kernela</h2>
<p>Następnie musimy wydobyć certyfikat x509 i klucz publiczny z obrazu kernela. Trzeba tutaj zwrócić
uwagę na fakt, że interesuje nas jedynie niespakowany obraz, czyli plik <code>vmlinux</code> , a nie
<code>vmlinuz</code> . Plik <code>vmlinux</code> jest dostępny w katalogu ze źródłami kernela. By wydobyć certyfikat i
klucz publiczny, wpisujemy kolejno te dwa poniższe polecenia:</p>
<pre><code># scripts/extract-sys-certs.pl vmlinux /tmp/cert.x509
Have 34 sections
Have 130812 symbols
Have 1513 bytes of certs at VMA 0xffffffff8310d838
Certificate list in section .init.data
Certificate list at file offset 0x250d838

# openssl x509 -pubkey -noout -inform der -in /tmp/cert.x509 -out /tmp/pubkey
</code></pre>
<p>Powinniśmy w tej chwili mieć trzy pliki w katalogu <code>/tmp/</code> : <code>modsig</code> , <code>cert.x509 </code> oraz <code>pubkey</code> .</p>
<h2 id="jak-rozkodować-strukturę-asn1-i-wyciągnąć-sygnaturę-modułu">Jak rozkodować strukturę ASN.1 i wyciągnąć sygnaturę modułu</h2>
<p>W skład pakietu <code>openssl</code> wchodzi narzędzie <code>asn1parse</code> , dzięki któremu możemy
rozkodować <a href="https://pl.wikipedia.org/wiki/Abstract_Syntax_Notation_One">strukturę ASN.1</a> i wydobyć
całą wiadomość PKCS#7 w czytelnej dla człowieka formie. Trzeba jedynie wskazać plik wydobytej
wcześniej wiadomości PKCS#7:</p>
<pre><code># openssl asn1parse -inform der -in modsig
    0:d=0  hl=4 l= 756 cons: SEQUENCE
    4:d=1  hl=2 l=   9 prim: OBJECT            :pkcs7-signedData
   15:d=1  hl=4 l= 741 cons: cont [ 0 ]
   19:d=2  hl=4 l= 737 cons: SEQUENCE
   23:d=3  hl=2 l=   1 prim: INTEGER           :01
   26:d=3  hl=2 l=  13 cons: SET
   28:d=4  hl=2 l=  11 cons: SEQUENCE
   30:d=5  hl=2 l=   9 prim: OBJECT            :sha512
   41:d=3  hl=2 l=  11 cons: SEQUENCE
   43:d=4  hl=2 l=   9 prim: OBJECT            :pkcs7-data
   54:d=3  hl=4 l= 702 cons: SET
   58:d=4  hl=4 l= 698 cons: SEQUENCE
   62:d=5  hl=2 l=   1 prim: INTEGER           :01
   65:d=5  hl=3 l= 148 cons: SEQUENCE
   68:d=6  hl=2 l= 124 cons: SEQUENCE
   70:d=7  hl=2 l=  11 cons: SET
   72:d=8  hl=2 l=   9 cons: SEQUENCE
   74:d=9  hl=2 l=   3 prim: OBJECT            :countryName
   79:d=9  hl=2 l=   2 prim: PRINTABLESTRING   :IT
   83:d=7  hl=2 l=  18 cons: SET
   85:d=8  hl=2 l=  16 cons: SEQUENCE
   87:d=9  hl=2 l=   3 prim: OBJECT            :localityName
   92:d=9  hl=2 l=   9 prim: UTF8STRING        :LocalHost
  103:d=7  hl=2 l=  20 cons: SET
  105:d=8  hl=2 l=  18 cons: SEQUENCE
  107:d=9  hl=2 l=   3 prim: OBJECT            :organizationName
  112:d=9  hl=2 l=  11 prim: UTF8STRING        :Morfikownia
  125:d=7  hl=2 l=  36 cons: SET
  127:d=8  hl=2 l=  34 cons: SEQUENCE
  129:d=9  hl=2 l=   3 prim: OBJECT            :commonName
  134:d=9  hl=2 l=  27 prim: UTF8STRING        :Key for morfikownias kernel
  163:d=7  hl=2 l=  29 cons: SET
  165:d=8  hl=2 l=  27 cons: SEQUENCE
  167:d=9  hl=2 l=   9 prim: OBJECT            :emailAddress
  178:d=9  hl=2 l=  14 prim: IA5STRING         :morfik@nsa.com
  194:d=6  hl=2 l=  20 prim: INTEGER           :08D5CCEF11AF1F630CA6C72AB2DB71A7F041DF24
  216:d=5  hl=2 l=  11 cons: SEQUENCE
  218:d=6  hl=2 l=   9 prim: OBJECT            :sha512
  229:d=5  hl=2 l=  13 cons: SEQUENCE
  231:d=6  hl=2 l=   9 prim: OBJECT            :rsaEncryption
  242:d=6  hl=2 l=   0 prim: NULL
  244:d=5  hl=4 l= 512 prim: OCTET STRING      [HEX DUMP]:
  B3239B84269AF9B6100EC4408E137D972F464A5F8B1059313818B6E346839B67748AC6F4D1
  45F179ADD73ED2E44A101953E6D4BFD53F589E5BE3F3B62CD530D23B7055C622B7596E323E
  753E097D58F487B86E93061B14709FDA0B92E7EFED6ABF474B13DE13AC0C68ABA3724A7E25
  9C47311F5E1C1CC5EBCE9621D9DDA4422768A6464B18314E7682E3DF17DA9AF43CEBC2B5ED
  3523EF7FDAE2109ED9605853505CC86FF1F5DC00AEE90D1E541097471ED540C2B6751DBD6F
  B4F5CBFF732E13E3217AA4103D19C4E9493442690227C4A12D4E8021C60C41515E912A7B6C
  8D88F53EA225D64C35EF351A8175883FF9CEC8BD7CD5A3014895805D9BDFBCE35AEE16FD4D
  C0182A17A07C984F19753346A76D938855DE6AB6D056250697A30BBCA68E935580C6213343
  1CD40DC3094B99F7F34ADDBC0967B4B07DD2A627B85C9B0A9EB999C078CEE5BCF44A393A7F
  45B34159CD2BEBD01A60643D933416D12F72F8CBEA8FE21159941817E575B32EDC8C39F7C3
  76776BD2B39A6D9CA14E26614406185E221633CB4BEFC3126A66D2E8DAEA7EE9618727DCA1
  3660804ECBB6C6198E4FBF8863CF2BC5E48EB9FD056B51725F1A06962C693F2634E02BE2E9
  1F021845147A837B2B279BD6398F64FD41EA7CAD890F762A557A29A7734339858C985DD16C
  2CB120F38A7CBA68DFF7EA1E8A9D922A998E3BEA881A850B2D21308A4C1146
</code></pre>
<p>Linijka mająca <code>[HEX DUMP]</code> w wyjściu wyżej (pocięta dla czytelności) to część wiadomości PKCS#7
odpowiedzialna za samą sygnaturę (dane binarne zakodowane w HEX). Musimy ten kawałek sobie wykroić
do osobnego pliku przy pomocy <code>dd</code> . Ale zanim to zrobimy, to musimy pierw ustalić co tak naprawdę
chcemy wykroić.</p>
<p>W tej ostatniej linijce, zaraz na początku mamy trzy wartości: <code>244</code> , <code>hl=4</code> oraz <code>l= 512</code> .
Pierwsza liczba to offset kolejnego nagłówka, z kolei <code>hl</code> to długość nagłówka, a <code>l</code> to długość
danych. Całkowity offset dla <code>dd</code> to 244+4=248, a długość to 512 bajtów, co odpowiada rozmiarowi
użytego hash'a przy podpisywaniu modułu (w tym przypadku został użyty <code>sha512</code> ). Zatem, by wykroić
ten hash, wpisujemy poniższe polecenie:</p>
<pre><code># dd if=/tmp/modsig of=/tmp/signed-sha512.bin bs=1 skip=$[ 244 + 4 ] count=512
512+0 records in
512+0 records out
512 bytes copied, 0.00649218 s, 78.9 kB/s
</code></pre>
<p>Możemy porównać zapis HEX w pliku <code>signed-sha512.bin</code> z tym co wcześniej było widoczne w
<code>[HEX DUMP]</code> :</p>
<pre><code># hexdump -C /tmp/signed-sha512.bin
00000000  b3 23 9b 84 26 9a f9 b6  10 0e c4 40 8e 13 7d 97  |.#..&amp;......@..}.|
00000010  2f 46 4a 5f 8b 10 59 31  38 18 b6 e3 46 83 9b 67  |/FJ_..Y18...F..g|
00000020  74 8a c6 f4 d1 45 f1 79  ad d7 3e d2 e4 4a 10 19  |t....E.y..&gt;..J..|
00000030  53 e6 d4 bf d5 3f 58 9e  5b e3 f3 b6 2c d5 30 d2  |S....?X.[...,.0.|
00000040  3b 70 55 c6 22 b7 59 6e  32 3e 75 3e 09 7d 58 f4  |;pU.&quot;.Yn2&gt;u&gt;.}X.|
00000050  87 b8 6e 93 06 1b 14 70  9f da 0b 92 e7 ef ed 6a  |..n....p.......j|
00000060  bf 47 4b 13 de 13 ac 0c  68 ab a3 72 4a 7e 25 9c  |.GK.....h..rJ~%.|
00000070  47 31 1f 5e 1c 1c c5 eb  ce 96 21 d9 dd a4 42 27  |G1.^......!...B'|
00000080  68 a6 46 4b 18 31 4e 76  82 e3 df 17 da 9a f4 3c  |h.FK.1Nv.......&lt;|
00000090  eb c2 b5 ed 35 23 ef 7f  da e2 10 9e d9 60 58 53  |....5#.......`XS|
000000a0  50 5c c8 6f f1 f5 dc 00  ae e9 0d 1e 54 10 97 47  |P\.o........T..G|
000000b0  1e d5 40 c2 b6 75 1d bd  6f b4 f5 cb ff 73 2e 13  |..@..u..o....s..|
000000c0  e3 21 7a a4 10 3d 19 c4  e9 49 34 42 69 02 27 c4  |.!z..=...I4Bi.'.|
000000d0  a1 2d 4e 80 21 c6 0c 41  51 5e 91 2a 7b 6c 8d 88  |.-N.!..AQ^.*{l..|
000000e0  f5 3e a2 25 d6 4c 35 ef  35 1a 81 75 88 3f f9 ce  |.&gt;.%.L5.5..u.?..|
000000f0  c8 bd 7c d5 a3 01 48 95  80 5d 9b df bc e3 5a ee  |..|...H..]....Z.|
00000100  16 fd 4d c0 18 2a 17 a0  7c 98 4f 19 75 33 46 a7  |..M..*..|.O.u3F.|
00000110  6d 93 88 55 de 6a b6 d0  56 25 06 97 a3 0b bc a6  |m..U.j..V%......|
00000120  8e 93 55 80 c6 21 33 43  1c d4 0d c3 09 4b 99 f7  |..U..!3C.....K..|
00000130  f3 4a dd bc 09 67 b4 b0  7d d2 a6 27 b8 5c 9b 0a  |.J...g..}..'.\..|
00000140  9e b9 99 c0 78 ce e5 bc  f4 4a 39 3a 7f 45 b3 41  |....x....J9:.E.A|
00000150  59 cd 2b eb d0 1a 60 64  3d 93 34 16 d1 2f 72 f8  |Y.+...`d=.4../r.|
00000160  cb ea 8f e2 11 59 94 18  17 e5 75 b3 2e dc 8c 39  |.....Y....u....9|
00000170  f7 c3 76 77 6b d2 b3 9a  6d 9c a1 4e 26 61 44 06  |..vwk...m..N&amp;aD.|
00000180  18 5e 22 16 33 cb 4b ef  c3 12 6a 66 d2 e8 da ea  |.^&quot;.3.K...jf....|
00000190  7e e9 61 87 27 dc a1 36  60 80 4e cb b6 c6 19 8e  |~.a.'..6`.N.....|
000001a0  4f bf 88 63 cf 2b c5 e4  8e b9 fd 05 6b 51 72 5f  |O..c.+......kQr_|
000001b0  1a 06 96 2c 69 3f 26 34  e0 2b e2 e9 1f 02 18 45  |...,i?&amp;4.+.....E|
000001c0  14 7a 83 7b 2b 27 9b d6  39 8f 64 fd 41 ea 7c ad  |.z.{+'..9.d.A.|.|
000001d0  89 0f 76 2a 55 7a 29 a7  73 43 39 85 8c 98 5d d1  |..v*Uz).sC9...].|
000001e0  6c 2c b1 20 f3 8a 7c ba  68 df f7 ea 1e 8a 9d 92  |l,. ..|.h.......|
000001f0  2a 99 8e 3b ea 88 1a 85  0b 2d 21 30 8a 4c 11 46  |*..;.....-!0.L.F|
00000200
</code></pre>
<p>Widać, że jest to dokładnie ten sam ciąg binarny.</p>
<h2 id="weryfikacja-sygnatury-modułu-kernela">Weryfikacja sygnatury modułu kernela</h2>
<p>Sygnatura siedzi sobie już w osobnym pliku i tę sygnaturę możemy już ręcznie zweryfikować:</p>
<pre><code># openssl rsautl -verify -pubin -inkey /tmp/pubkey &lt; /tmp/signed-sha512.bin &gt; /tmp/verified.bin
</code></pre>
<p>W <code>-inkey</code> podajemy ścieżkę do klucza publicznego wydobytego z kernela zaraz na początku artykułu.
To powyższe polecenie stworzy nam plik <code>verified.bin</code> , który także jest w formacie ASN.1 . Wygląda
on tak:</p>
<pre><code># hexdump -C /tmp/verified.bin
00000000  30 51 30 0d 06 09 60 86  48 01 65 03 04 02 03 05  |0Q0...`.H.e.....|
00000010  00 04 40 8a 4f f7 fc be  62 df a3 f9 44 8c 1b 36  |..@.O...b...D..6|
00000020  87 44 0d 66 f8 2d 39 86  8e bc dd 63 24 78 8b d2  |.D.f.-9....c$x..|
00000030  df 2f 00 6b e7 c5 55 90  24 99 96 a7 2b e4 f3 7c  |./.k..U.$...+..||
00000040  e2 c5 d0 3a 09 24 47 e9  36 f3 92 ee 75 68 68 17  |...:.$G.6...uhh.|
00000050  2a e1 08                                          |*..|
00000053
</code></pre>
<p>Możemy go zdekodować w poniższy sposób:</p>
<pre><code># openssl asn1parse -inform der -in /tmp/verified.bin
    0:d=0  hl=2 l=  81 cons: SEQUENCE
    2:d=1  hl=2 l=  13 cons: SEQUENCE
    4:d=2  hl=2 l=   9 prim: OBJECT            :sha512
   15:d=2  hl=2 l=   0 prim: NULL
   17:d=1  hl=2 l=  64 prim: OCTET STRING      [HEX DUMP]:
   8A4FF7FCBE62DFA3F9448C1B3687440D66F82D39868EBCDD6324788BD2DF2F006BE7C5559
   0249996A72BE4F37CE2C5D03A092447E936F392EE756868172AE108
</code></pre>
<p>Mamy tutaj informację na temat użytej funkcji skrótu oraz hash pliku, pod którym została złożona
sygnatura (zanim plik został podpisany). Zatem ten ciąg binarny ( w <code>[HEX DUMP]</code> ) musi pasować do
tego co zostanie zwrócone przez polecenie <code>sha512sum</code> na pliku modułu kernela.</p>
<pre><code># sha512sum /lib/modules/4.20.0-amd64-morficzny/updates/dkms/xt_ACCOUNT.ko
8a4ff7fcbe62dfa3f9448c1b3687440d66f82d39868ebcdd6324788bd2df2f006be7c5559
0249996a72be4f37ce2c5d03a092447e936f392ee756868172ae108
</code></pre>
<p>Oczywiście to powyższe polecenie dotyczy modułu kernela, który jeszcze nie został podpisany. Jeśli
byśmy spróbowali wyciągnąć hash z podpisanego modułu, to ten będzie inny, jako że po podpisaniu
modułu <a href="https://www.kernel.org/doc/html/v4.17/admin-guide/module-signing.html#signed-modules-and-stripping">na jego końcu doczepiana jest sygnatura</a>.
Jeśli nie dysponujemy źródłowym plikiem, to zawsze możemy uciąć tę sygnaturę z modułu w poniższy
sposób:</p>
<pre><code># strip --strip-debug /lib/modules/4.20.0-amd64-morficzny/updates/dkms/xt_ACCOUNT.ko
</code></pre>
<p>I dopiero wtedy porównać czy hash się zgadza. Jeśli tak, to sygnatura została pomyślnie
zweryfikowana.</p>
<p>Więcej informacji można
znaleźć <a href="https://unix.stackexchange.com/questions/493170/how-to-verify-a-kernel-module-signature">tutaj</a>
i <a href="https://qistoph.blogspot.com/2012/01/manual-verify-pkcs7-signed-data-with.html">tutaj</a>.</p></div>
				
				<footer class="entry__footer">
					
<div class="entry__tags">
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/debian/">debian</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/kernel/">kernel</a>
			<a class="entry__tag btn" href="https://morfikov.github.io/tags/modu%C5%82y-kernela/">moduły-kernela</a>
</div>
					
<div class="entry__share share">
	<a class="share__link btn" title="Podziel się na Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-recznie-zweryfikowac-sygnature-modulu-kernela-linux%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-recznie-zweryfikowac-sygnature-modulu-kernela-linux%2f&amp;text=Jak%20r%c4%99cznie%20zweryfikowa%c4%87%20sygnatur%c4%99%20modu%c5%82u%20kernela%20linux" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Reddit" href="https://www.reddit.com/submit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-recznie-zweryfikowac-sygnature-modulu-kernela-linux%2f&amp;title=Jak%20r%c4%99cznie%20zweryfikowa%c4%87%20sygnatur%c4%99%20modu%c5%82u%20kernela%20linux" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Reddit', 'width=832,height=624,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Reddit" role="img" width="32" height="32" viewBox="0 0 512 512"><path fill-rule="evenodd" d="M375 146a32 32 0 1 0-29-46l-65-13c-5-1-9 2-10 6l-22 97c-45 1-85 15-113 36a42 42 0 1 0-45 69l-1 12c0 65 74 117 166 117s166-52 166-117l-1-11a42 42 0 1 0-44-69c-28-21-67-35-111-37l19-86 58 13a32 32 0 0 0 32 29zM190 353c2-1 4 0 5 1 15 11 38 18 61 18s46-6 61-18a7 7 0 0 1 8 10c-18 14-44 21-69 21-25-1-51-7-69-21a6 6 0 0 1 3-11zm23-44a31 31 0 1 1-44-44 31 31 0 0 1 44 44zm130 0a31 31 0 1 0-44-44 31 31 0 0 0 44 44z"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na Telegram" href="https://t.me/share/url?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-recznie-zweryfikowac-sygnature-modulu-kernela-linux%2f&amp;title=Jak%20r%c4%99cznie%20zweryfikowa%c4%87%20sygnatur%c4%99%20modu%c5%82u%20kernela%20linux" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na Telegram', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-recznie-zweryfikowac-sygnature-modulu-kernela-linux%2f&title=Jak%20r%c4%99cznie%20zweryfikowa%c4%87%20sygnatur%c4%99%20modu%c5%82u%20kernela%20linux" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" width="32" height="32" viewBox="0 0 512 512"><circle cx="142" cy="138" r="37"/><path stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
	</a>
	<a class="share__link btn" title="Podziel się na VK" href="https://vk.com/share.php?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-recznie-zweryfikowac-sygnature-modulu-kernela-linux%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Podziel się na VK', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="VK" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M274 363c5-1 14-3 14-15 0 0-1-30 13-34s32 29 51 42c14 9 25 8 25 8l51-1s26-2 14-23c-1-2-9-15-39-42-31-30-26-25 11-76 23-31 33-50 30-57-4-7-20-6-20-6h-57c-6 0-9 1-12 6 0 0-9 25-21 45-25 43-35 45-40 42-9-5-7-24-7-37 0-45 7-61-13-65-13-2-59-4-73 3-7 4-11 11-8 12 3 0 12 1 17 7 8 13 9 75-2 81-15 11-53-62-62-86-2-6-5-7-12-9H79c-6 0-15 1-11 13 27 56 83 193 184 192z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pocket" href="https://getpocket.com/edit?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-recznie-zweryfikowac-sygnature-modulu-kernela-linux%2f&amp;title=Jak%20r%c4%99cznie%20zweryfikowa%c4%87%20sygnatur%c4%99%20modu%c5%82u%20kernela%20linux" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=480,height=320,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pocket" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M388.8 88.9H123.2A47.4 47.4 0 0 0 76 136.5v131.9c0 2.4.2 4.8.5 7.2a101.8 101.8 0 0 0-.5 10.6c0 75.6 80.6 137 180 137s180-61.4 180-137c0-3.6-.2-7.1-.5-10.6.3-2.4.5-4.8.5-7.2v-132A47.4 47.4 0 0 0 388.8 89zm-22.4 132.6l-93 93c-4.7 4.6-11 7-17.1 7a23.8 23.8 0 0 1-17.7-7l-93-93a24 24 0 0 1 33.8-33.8l76.6 76.5 76.6-76.5a24 24 0 0 1 33.8 33.8z"/></svg>
	</a>
	<a class="share__link btn" title="Zapisz do Pinterest" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fmorfikov.github.io%2fpost%2fjak-recznie-zweryfikowac-sygnature-modulu-kernela-linux%2f&description=Jak%20r%c4%99cznie%20zweryfikowa%c4%87%20sygnatur%c4%99%20modu%c5%82u%20kernela%20linux" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, 'Zapisz do Pocket', 'width=800,height=720,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Pinterest" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="m265 65c-104 0-157 75-157 138 0 37 14 71 45 83 5 2 10 0 12-5l3-18c2-6 1-7-2-12-9-11-15-24-15-43 0-56 41-106 108-106 60 0 92 37 92 85 0 64-28 116-70 116-23 0-40-18-34-42 6-27 19-57 19-77 0-18-9-34-30-34-24 0-42 25-42 58 0 20 7 34 7 34l-29 120a249 249 0 0 0 2 86l3-1c2-3 31-37 40-72l16-61c7 15 29 28 53 28 71 0 119-64 119-151 0-66-56-126-140-126z"/></svg>
	</a>
</div>
				</footer>
				
			</article>
		</div>
	</main>
	
<div class="authorbox block">
	<div class="author">
		<figure class="author__avatar">
			<img class="author__img" alt="Mikhail Morfikov avatar" src="https://morfikov.github.io/img/avatar.png" height="90" width="90">
		</figure>
		<div class="author__body">
			<div class="author__name">
				Mikhail Morfikov
			</div>
			<div class="author__bio">Po ponad 10 latach spędzonych z różnej maści linux&#39;ami (Debian/Ubuntu, OpenWRT, Android) mogę śmiało powiedzieć, że nie ma rzeczy niemożliwych i problemów, których nie da się rozwiązać. Jedną umiejętność, którą ludzki umysł musi posiąść, by wybrnąć nawet z tej najbardziej nieprzyjemniej sytuacji, to zdolność logicznego rozumowania.</div>
		</div>
	</div>
</div>
	



<div class="related block">
	<h3 class="related__title">Powiązane</h3>
	<ul class="related__list">
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/automatyczne-podpisywanie-modulow-kernela-przez-dkms/">Automatyczne podpisywanie modułów kernela przez DKMS</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/dkms-czyli-automatycznie-budowane-moduly/">DKMS, czyli automatycznie budowane moduły</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/budowanie-kernela-linux-dla-konkretnej-maszyny-z-debianem/">Budowanie kernela linux dla konkretnej maszyny z Debianem</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/konfiguracja-interfejsow-bond-bonding/">Jak skonfigurować bonding w Debian linux (eth0&#43;wlan0)</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/konfiguracja-interfejsow-imq-w-linuxie/">Konfiguracja interfejsów IMQ w linux&#39;ie</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/modul-kernela-i-wartosci-jego-parametrow/">Moduł kernela i wartości jego parametrów</a></li>
		
		<li class="related__item"><a class="related__link" href="https://morfikov.github.io/post/jak-uruchomic-firefoxa-w-osobnej-przestrzeni-nazw-sieciowych/">Jak uruchomić Firefox&#39;a w osobnej przestrzeni nazw sieciowych</a></li>
		
	</ul>
</div>

	<div id="comments">
		<script>
  var id =  313 ;

  if (id)
  {
    let url = "https://github.com/morfikov/morfitronik-comments/issues/".concat(id);
    let api_url = "https://api.github.com/repos/morfikov/morfitronik-comments/issues/".concat(id, "/comments");

    var commentsDiv = document.getElementById("comments");

    let xhr = new XMLHttpRequest();
    xhr.responseType = "json";
    xhr.open("GET", api_url);
    xhr.setRequestHeader("Accept", "application/vnd.github.v3.html+json");
    xhr.send();

    xhr.onload = function()
    {
      if (xhr.status != 200)
      {
        let errorText = document.createElement("p");
        errorText.innerHTML = "<i>Komentarze dla tego postu nie zostały jeszcze otworzone (albo skrypty GitHub'a są wyłączone). Być może też skończył ci się przydział 60/godzinę (limit GitHub'a).</i>";
        commentsDiv.appendChild(errorText);
      }
      else
      {
        let comments = xhr.response;

        let mainHeader = document.createElement("h3");
        mainHeader.innerHTML = "Komentarze: ".concat(comments.length);
        commentsDiv.appendChild(mainHeader);

        let issueLink = document.createElement("p");
        issueLink.innerHTML = "<i>Możesz zostawić komentarz korzystając z <a href='".concat(url, "'>GitHub issue</a>.</i>");
        commentsDiv.appendChild(issueLink);

        comments.forEach(function(comment)
        {
			const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', timeZone: 'Europe/Warsaw' };
			options.timeZoneName = 'short';
            let commentContent = document.createElement("div");
            commentContent.setAttribute('class', 'gh-comment')
            commentContent.innerHTML = "".concat(
                "<div class='gh-header'>",
                  "<img src='", comment.user.avatar_url, "' />",
                  "<div style='margin:auto 0;'>",
                    "<b><a class='gh-username' href='", comment.user.html_url, "'>", comment.user.login, "</a></b>",
                    " | <em>", (new Date(comment.created_at)).toLocaleTimeString('pl-PL', options), "</em>",
                  "</div>",
                "</div>",
                "<div class='gh-body'>",
                  comment.body_html,
                "</div>"
            );
            commentsDiv.appendChild(commentContent);
        });
      }
    };

    xhr.onerror = function()
    {
      let errorText = document.createElement("p");
      errorText.innerHTML = "<i>Wystąpił jakiś błąd przy ładowaniu komentarzy.</i>";
      commentsDiv.appendChild(errorText);
    };
  }
</script>

	</div>

	</div>
	<footer class="footer">
<div class="footer__social social">
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="mailto:morfitronik@gmail.com">
			<svg class="social__icon" aria-label="Email" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M299 268l124 106c-4 4-10 7-17 7H106c-7 0-13-3-17-7l124-106 43 38 43-38zm-43 13L89 138c4-4 10-7 17-7h300c7 0 13 3 17 7L256 281zm54-23l121-105v208L310 258zM81 153l121 105L81 361V153z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/mikhailmorfikov">
			<svg class="social__icon" aria-label="Twitter" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://t.me/morfikov">
			<svg class="social__icon" aria-label="Telegram" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M199 404c-11 0-10-4-13-14l-32-105 245-144"/><path d="M199 404c7 0 11-4 16-8l45-43-56-34"/><path d="M204 319l135 99c14 9 26 4 30-14l55-258c5-22-9-32-24-25L79 245c-21 8-21 21-4 26l83 26 190-121c9-5 17-3 11 4"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/morfikov">
			<svg class="social__icon" aria-label="Github" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://gitlab.com/morfikov">
			<svg class="social__icon" aria-label="Gitlab" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M450 282l-22-67-43-133c-2-7-12-7-14 0l-43.3 133H184.3L141 82c-2-7-12-7-14 0L84 215l-22 67c-2 6 0 13 6 16l188 137 188-137c6-3 8-10 6-16z"/></svg>
		</a>
		<a class="social__link" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/users/3015317">
			<svg class="social__icon" aria-label="Stack Overflow" role="img" width="32" height="32" viewBox="0 0 512 512"><g stroke-width="30"><path fill="none" d="M125 297v105h241V297"/><path d="M170 341h150m-144-68l148 31M199 204l136 64m-95-129l115 97M293 89l90 120"/></g></svg>
		</a>
</div>
	<div class="footer__copyright">© 2021 Mikhail Morfikov.
	<span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span>
	<span class="footer__copyright-cc">
		<div class="license-icons">
			<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" title="Creative Commons Attribution 4.0 International license">
<i class="icon-cc"></i><i class="icon-cc-by"></i><i class="icon-cc-nc"></i><i class="icon-cc-sa"></i>
</a>
		</div>
		Except where otherwise noted, content on this site is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International license</a>.
	</span>
	</div>
</footer>

<script src="https://morfikov.github.io/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>

<script src="https://morfikov.github.io/js/custom.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 40,
  textColor: '#c3c3c3'
})</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
const images = Array.from(document.querySelectorAll(".entry__content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    scrollOffset: 40,  
    container: null,  
    template: null,  
    background: 'rgba(0, 0, 0, 0.8)'
  });
});
</script>
</body>
</html>
